{"version":3,"file":"content.bundle.js","sources":["../content.js"],"sourcesContent":["// content.js\n// Enhanced to support multiple paper sources\nconsole.log('Academic Paper Tracker content script loaded');\n\n// CSS for the annotation UI - Updated with source-specific styling\nconst STYLES = `\n.paper-annotator {\n    display: inline-block;\n    margin-left: 4px;\n    cursor: pointer;\n    font-size: 0.9em;\n    opacity: 0.7;\n    transition: opacity 0.2s;\n    vertical-align: baseline;\n}\n\n.paper-annotator:hover {\n    opacity: 1;\n}\n\n.paper-popup {\n    position: absolute;\n    background: white;\n    border: 1px solid #ddd;\n    border-radius: 6px;\n    padding: 12px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n    width: 300px;\n    z-index: 10000;\n    box-sizing: border-box;\n}\n\n.paper-popup-header {\n    font-weight: bold;\n    margin-bottom: 8px;\n    line-height: 1.4;\n    font-size: 1em;\n}\n\n.paper-popup-meta {\n    color: #666;\n    font-size: 0.85em;\n    margin-bottom: 12px;\n    line-height: 1.4;\n}\n\n.paper-popup-source {\n    display: inline-block;\n    font-size: 11px;\n    border-radius: 4px;\n    padding: 2px 6px;\n    margin-bottom: 10px;\n    color: white;\n    font-weight: 500;\n}\n\n.source-arxiv {\n    background-color: #B31B1B;\n}\n\n.source-doi, .source-acm {\n    background-color: #0277bd;\n}\n\n.source-semanticscholar {\n    background-color: #2e7d32;\n}\n\n.source-openreview {\n    background-color: #6d4c41;\n}\n\n.paper-popup-buttons {\n    display: flex;\n    gap: 8px;\n    margin: 8px 0;\n}\n\n.paper-popup button {\n    padding: 6px 12px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    background: #f5f5f5;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    font-size: 0.9em;\n}\n\n.paper-popup button:hover {\n    background: #e8e8e8;\n    border-color: #ccc;\n}\n\n.paper-popup button.active {\n    background: #e0e0e0;\n    border-color: #aaa;\n}\n\n.paper-popup textarea {\n    width: calc(100% - 16px);\n    min-height: 80px;\n    margin: 8px 0;\n    padding: 8px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    resize: vertical;\n    font-family: inherit;\n    font-size: 0.9em;\n    line-height: 1.4;\n    box-sizing: border-box;\n}\n\n.paper-popup textarea:focus {\n    outline: none;\n    border-color: #aaa;\n}\n\n.paper-popup-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: 8px;\n    margin-top: 12px;\n}\n\n.paper-popup .save-button {\n    background: #2563eb;\n    color: white;\n    border-color: #2563eb;\n}\n\n.paper-popup .save-button:hover {\n    background: #1d4ed8;\n    border-color: #1d4ed8;\n}\n\n/* Loading state */\n.paper-popup-header:empty::after,\n.paper-popup-header:contains('Loading...') {\n    content: '';\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    border: 2px solid #ddd;\n    border-top-color: #666;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n    to { transform: rotate(360deg); }\n}\n\n/* Source-specific annotator icons */\n.annotator-arxiv::after {\n    content: '📝';\n}\n\n.annotator-doi::after, .annotator-acm::after {\n    content: '🔍';\n}\n\n.annotator-semanticscholar::after {\n    content: '📊';\n}\n\n.annotator-openreview::after {\n    content: '📋';\n}\n\n.annotator-generic::after {\n    content: '📄';\n}\n`;\n\n// Add styles to page\nconst styleSheet = document.createElement('style');\nstyleSheet.textContent = STYLES;\ndocument.head.appendChild(styleSheet);\n\n// Track active popup\nlet activePopup = null;\n\n// Update the click-outside handler to account for wrapper\ndocument.addEventListener('click', (e) => {\n    if (activePopup && \n        !activePopup.contains(e.target) && \n        !e.target.classList.contains('paper-annotator')) {\n        activePopup.parentElement?.remove(); // Remove the wrapper\n        activePopup = null;\n    }\n});\n\n// Cache for paper metadata\nconst metadataCache = new Map();\n\n// Source definitions for URL matching\nconst PAPER_SOURCES = [\n    {\n        type: 'arxiv',\n        urlPatterns: [\n            /arxiv\\.org\\/abs\\/([0-9.]+)/,\n            /arxiv\\.org\\/pdf\\/([0-9.]+)\\.pdf/,\n            /arxiv\\.org\\/\\w+\\/([0-9.]+)/\n        ],\n        getIdFromMatch: (match) => match[1]\n    },\n    {\n        type: 'doi',\n        urlPatterns: [\n            /doi\\.org\\/(10\\.[0-9.]+\\/[a-zA-Z0-9._\\-/:()\\[\\]]+)/\n        ],\n        getIdFromMatch: (match) => match[1]\n    },\n    {\n        type: 'acm',\n        urlPatterns: [\n            /dl\\.acm\\.org\\/doi\\/(10\\.[0-9.]+\\/[a-zA-Z0-9._\\-/:()\\[\\]]+)/\n        ],\n        getIdFromMatch: (match) => match[1]\n    },\n    {\n        type: 'semanticscholar',\n        urlPatterns: [\n            /semanticscholar\\.org\\/paper\\/([a-f0-9]+)/,\n            /s2-research\\.org\\/papers\\/([a-f0-9]+)/\n        ],\n        getIdFromMatch: (match) => match[1]\n    },\n    {\n        type: 'openreview',\n        urlPatterns: [\n            /openreview\\.net\\/forum\\?id=([a-zA-Z0-9_\\-]+)/\n        ],\n        getIdFromMatch: (match) => match[1]\n    }\n];\n\n/**\n * Detect paper source and ID from URL\n * @param {string} url URL to check for paper identifiers\n * @returns {Object|null} Source information or null if not a paper URL\n */\nfunction detectPaperSource(url) {\n    // Check each source type\n    for (const source of PAPER_SOURCES) {\n        for (let i = 0; i < source.urlPatterns.length; i++) {\n            const match = url.match(source.urlPatterns[i]);\n            if (match) {\n                return {\n                    type: source.type,\n                    id: source.getIdFromMatch(match),\n                    url: url\n                };\n            }\n        }\n    }\n    return null;\n}\n\n/**\n * Get a formatted label for paper source\n * @param {string} source Paper source identifier\n * @returns {string} Human-readable source label\n */\nfunction getSourceLabel(source) {\n    const labels = {\n        'arxiv': 'arXiv',\n        'semanticscholar': 'Semantic Scholar',\n        'doi': 'DOI',\n        'acm': 'ACM Digital Library',\n        'openreview': 'OpenReview'\n    };\n    return labels[source] || source.charAt(0).toUpperCase() + source.slice(1);\n}\n\n// Parse arXiv API response\nasync function parseXMLResponse(xmlText) {\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(xmlText, \"text/xml\");\n    \n    // Get entry element\n    const entry = xmlDoc.querySelector('entry');\n    if (!entry) return null;\n    \n    return {\n        title: entry.querySelector('title')?.textContent?.trim(),\n        authors: Array.from(entry.querySelectorAll('author name'))\n            .map(name => name.textContent.trim())\n            .join(', '),\n        abstract: entry.querySelector('summary')?.textContent?.trim(),\n        published: entry.querySelector('published')?.textContent?.trim(),\n    };\n}\n\n/**\n * Fetch paper metadata based on source\n * @param {string} source Paper source type\n * @param {string} id Paper identifier\n * @returns {Promise<Object|null>} Paper metadata or null if unavailable\n */\nasync function fetchPaperMetadata(source, id) {\n    console.log(`Starting metadata fetch for ${source}:${id}`);\n    \n    // Generate cache key\n    const cacheKey = `${source}:${id}`;\n    \n    // Check cache first\n    if (metadataCache.has(cacheKey)) {\n        console.log('Found in cache:', cacheKey);\n        return metadataCache.get(cacheKey);\n    }\n\n    // Source-specific metadata fetching\n    try {\n        let metadata = null;\n        \n        if (source === 'arxiv') {\n            // Use arXiv API\n            const apiUrl = `https://export.arxiv.org/api/query?id_list=${id}`;\n            console.log('API URL:', apiUrl);\n            \n            const response = await fetch(apiUrl);\n            console.log('API response status:', response.status);\n            \n            if (response.ok) {\n                const text = await response.text();\n                metadata = await parseXMLResponse(text);\n            }\n        } else {\n            // For other sources, try to extract from page meta tags first\n            metadata = {\n                title: document.querySelector('meta[name=\"citation_title\"]')?.content ||\n                       document.querySelector('meta[property=\"og:title\"]')?.content,\n                authors: document.querySelector('meta[name=\"citation_authors\"]')?.content ||\n                         document.querySelector('meta[name=\"author\"]')?.content,\n                abstract: document.querySelector('meta[name=\"description\"]')?.content ||\n                          document.querySelector('meta[property=\"og:description\"]')?.content,\n                published: document.querySelector('meta[name=\"citation_publication_date\"]')?.content\n            };\n            \n            // If not found in meta tags, set defaults\n            if (!metadata.title) {\n                metadata.title = `${getSourceLabel(source)} Paper: ${id}`;\n            }\n        }\n\n        if (metadata) {\n            console.log('Fetched metadata:', metadata);\n            metadataCache.set(cacheKey, metadata);\n            return metadata;\n        } \n    } catch (error) {\n        console.error('Error fetching metadata:', error);\n    }\n\n    // Default minimal metadata if all else fails\n    const defaultMetadata = {\n        title: `${getSourceLabel(source)} Paper: ${id}`,\n        authors: '',\n        abstract: '',\n        published: ''\n    };\n    \n    metadataCache.set(cacheKey, defaultMetadata);\n    return defaultMetadata;\n}\n\n/**\n * Create popup element for paper annotation\n * @param {string} source Paper source\n * @param {string} id Paper ID\n * @param {string} initialTitle Optional initial title\n * @returns {Promise<HTMLElement>} Popup element\n */\nasync function createPopup(source, id, initialTitle = '') {\n    console.log(`Creating popup for ${source}:${id}`);\n    \n    // Fetch metadata\n    const metadata = await fetchPaperMetadata(source, id);\n    console.log('Fetched metadata:', metadata);\n\n    const popup = document.createElement('div');\n    popup.className = 'paper-popup';\n    \n    // Create popup content\n    popup.innerHTML = `\n        <div class=\"paper-popup-source source-${source}\">${getSourceLabel(source)}</div>\n        <div class=\"paper-popup-header\">${metadata?.title || initialTitle || id}</div>\n        <div class=\"paper-popup-meta\">${metadata?.authors || ''}</div>\n        <div class=\"paper-popup-buttons\">\n            <button class=\"vote-button\" data-vote=\"thumbsup\">👍 Interesting</button>\n            <button class=\"vote-button\" data-vote=\"thumbsdown\">👎 Not Relevant</button>\n        </div>\n        <textarea placeholder=\"Add notes...\"></textarea>\n        <div class=\"paper-popup-actions\">\n            <button class=\"save-button\">Save</button>\n        </div>\n    `;\n\n    // Handle voting\n    popup.querySelectorAll('.vote-button').forEach(button => {\n        button.addEventListener('click', () => {\n            popup.querySelectorAll('.vote-button').forEach(b => b.classList.remove('active'));\n            button.classList.add('active');\n        });\n    });\n\n    // Handle save\n    popup.querySelector('.save-button').addEventListener('click', () => {\n        const vote = popup.querySelector('.vote-button.active')?.dataset.vote;\n        const notes = popup.querySelector('textarea').value;\n        \n        // Format data for the background script\n        if (vote || notes) {\n            chrome.runtime.sendMessage({\n                type: 'updateAnnotation',\n                annotationType: notes ? 'notes' : 'vote',\n                data: {\n                    paperId: id,\n                    source: source,\n                    vote,\n                    notes,\n                    title: metadata?.title,\n                    authors: metadata?.authors,\n                    abstract: metadata?.abstract,\n                    timestamp: new Date().toISOString()\n                }\n            }, (response) => {\n                console.log('Annotation saved:', response);\n                popup.remove();\n                activePopup = null;\n            });\n        }\n    });\n\n    // Store source and ID for reference\n    popup.paperSource = source;\n    popup.paperId = id;\n    \n    return popup;\n}\n\n/**\n * Create wrapper for popup placement\n * @returns {HTMLElement} Popup wrapper element\n */\nfunction createPopupWrapper() {\n    const wrapper = document.createElement('div');\n    wrapper.style.position = 'relative';\n    wrapper.style.zIndex = '10000';\n    return wrapper;\n}\n\n/**\n * Process a paper link element\n * @param {HTMLAnchorElement} link Link element to process\n */\nasync function processPaperLink(link) {\n    // Skip if already processed\n    if (link.classList.contains('paper-processed')) return;\n    link.classList.add('paper-processed');\n\n    // Detect paper source from URL\n    const sourceInfo = detectPaperSource(link.href);\n    if (!sourceInfo) return;\n    \n    const { type: source, id } = sourceInfo;\n\n    // Create annotator button with source-specific class\n    const annotator = document.createElement('span');\n    annotator.className = `paper-annotator annotator-${source}`;\n    annotator.title = `Add ${getSourceLabel(source)} annotation`;\n    \n    // Update the click handler\n    annotator.addEventListener('click', async (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n    \n        // Remove existing popup if any\n        if (activePopup) {\n            activePopup.parentElement?.remove(); // Remove the wrapper\n            if (activePopup.paperSource === source && activePopup.paperId === id) {\n                activePopup = null;\n                return;\n            }\n        }\n    \n        // Create popup\n        const popup = await createPopup(source, id);\n        \n        // Create wrapper and add popup to it\n        const wrapper = createPopupWrapper();\n        wrapper.appendChild(popup);\n        \n        // Position popup relative to annotator\n        const annotatorRect = annotator.getBoundingClientRect();\n        const available_width = window.innerWidth - annotatorRect.left;\n        \n        if (available_width < 320) { // if not enough space on right\n            popup.style.right = '0';  // align to right edge\n            popup.style.left = 'auto';\n        } else {\n            popup.style.left = '0';\n        }\n        popup.style.top = `${annotatorRect.height + 5}px`;\n        \n        // Add to page and store reference\n        annotator.parentNode.insertBefore(wrapper, annotator.nextSibling);\n        activePopup = popup;\n    });\n    \n    // Add to page\n    link.parentNode.insertBefore(annotator, link.nextSibling);\n}\n\n// Process initial links for all supported sources\nfunction processInitialLinks() {\n    // Process arXiv links (backward compatibility)\n    document.querySelectorAll('a[href*=\"arxiv.org\"]').forEach(processPaperLink);\n    \n    // Process DOI links\n    document.querySelectorAll('a[href*=\"doi.org\"]').forEach(processPaperLink);\n    document.querySelectorAll('a[href*=\"dl.acm.org/doi\"]').forEach(processPaperLink);\n    \n    // Process Semantic Scholar links\n    document.querySelectorAll('a[href*=\"semanticscholar.org/paper\"]').forEach(processPaperLink);\n    \n    // Process OpenReview links\n    document.querySelectorAll('a[href*=\"openreview.net/forum\"]').forEach(processPaperLink);\n}\n\n// Process all links on page load\nprocessInitialLinks();\n\n// Watch for new links with a mutation observer\nconst observer = new MutationObserver((mutations) => {\n    mutations.forEach(mutation => {\n        mutation.addedNodes.forEach(node => {\n            if (node.nodeType === Node.ELEMENT_NODE) {\n                // Process all supported link types\n                if (node.tagName === 'A') {\n                    processPaperLink(node);\n                } else {\n                    // Check for links inside added elements\n                    node.querySelectorAll('a[href*=\"arxiv.org\"]').forEach(processPaperLink);\n                    node.querySelectorAll('a[href*=\"doi.org\"]').forEach(processPaperLink);\n                    node.querySelectorAll('a[href*=\"dl.acm.org/doi\"]').forEach(processPaperLink);\n                    node.querySelectorAll('a[href*=\"semanticscholar.org/paper\"]').forEach(processPaperLink);\n                    node.querySelectorAll('a[href*=\"openreview.net/forum\"]').forEach(processPaperLink);\n                }\n            }\n        });\n    });\n});\n\n// Configure and start the observer\nobserver.observe(document.body, {\n    childList: true,\n    subtree: true\n});\n\n// Optional: Export functions for testing\nwindow.paperTracker = {\n    detectPaperSource,\n    fetchPaperMetadata,\n    processPaperLink\n};\n"],"names":[],"mappings":"AAAA;AACA;AACA,OAAO,CAAC,GAAG,CAAC,8CAA8C,CAAC;;AAE3D;AACA,MAAM,MAAM,GAAG;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC;AAClD,UAAU,CAAC,WAAW,GAAG,MAAM;AAC/B,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;;AAErC;AACA,IAAI,WAAW,GAAG,IAAI;;AAEtB;AACA,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,CAAC,KAAK;AAC1C,IAAI,IAAI,WAAW;AACnB,QAAQ,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC;AACvC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;AACzD,QAAQ,W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"}