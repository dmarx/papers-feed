{"version":3,"file":"popup.bundle.js","sources":["../popup.js"],"sourcesContent":["// popup.js\n// Enhanced to support multiple paper sources\n\n/**\n * Get paper data from background script\n * @returns {Promise<any>} Paper data or null if not available\n */\nasync function getCurrentPaper() {\n  return new Promise((resolve) => {\n    chrome.runtime.sendMessage({type: 'getCurrentPaper'}, response => {\n      console.log('Got paper data from background:', response);\n      resolve(response);\n    });\n  });\n}\n\n/**\n * Get a formatted label for paper source\n * @param {string} source Paper source identifier\n * @returns {string} Human-readable source label\n */\nfunction getSourceLabel(source) {\n  const labels = {\n    'arxiv': 'arXiv',\n    'semanticscholar': 'Semantic Scholar',\n    'doi': 'DOI',\n    'acm': 'ACM Digital Library',\n    'openreview': 'OpenReview'\n  };\n  return labels[source] || source.charAt(0).toUpperCase() + source.slice(1);\n}\n\n/**\n * Update UI with paper data\n * @param {Object} paperData Paper metadata\n */\nfunction updateUI(paperData) {\n  const titleElement = document.getElementById('paperTitle');\n  const authorsElement = document.getElementById('paperAuthors');\n  const statusElement = document.getElementById('status');\n  const sourceElement = document.getElementById('paperSource');\n\n  if (paperData) {\n    // Set paper details\n    titleElement.textContent = paperData.title || paperData.arxivId || paperData.sourceId || 'Untitled Paper';\n    authorsElement.textContent = paperData.authors || '';\n    \n    // Set source information\n    if (paperData.source) {\n      sourceElement.textContent = getSourceLabel(paperData.source);\n      sourceElement.classList.remove('hidden');\n      \n      // Add source-specific class for styling\n      sourceElement.className = 'paper-source';\n      sourceElement.classList.add(`source-${paperData.source}`);\n    } else if (paperData.arxivId) {\n      // Legacy support\n      sourceElement.textContent = 'arXiv';\n      sourceElement.classList.remove('hidden');\n      sourceElement.className = 'paper-source source-arxiv';\n    } else {\n      sourceElement.classList.add('hidden');\n    }\n    \n    statusElement.textContent = 'Paper tracked! Data stored on GitHub.';\n    \n    // Enable rating buttons\n    document.getElementById('thumbsUp').disabled = false;\n    document.getElementById('thumbsDown').disabled = false;\n    \n    // Highlight active rating if set\n    if (paperData.rating === 'thumbsup') {\n      document.getElementById('thumbsUp').classList.add('active');\n    } else if (paperData.rating === 'thumbsdown') {\n      document.getElementById('thumbsDown').classList.add('active');\n    }\n  } else {\n    titleElement.textContent = 'No academic paper detected';\n    authorsElement.textContent = '';\n    sourceElement.classList.add('hidden');\n    statusElement.textContent = 'Visit a supported academic paper to track it';\n    \n    // Disable rating buttons\n    document.getElementById('thumbsUp').disabled = true;\n    document.getElementById('thumbsDown').disabled = true;\n  }\n}\n\n/**\n * Check if URL is a supported paper source\n * @param {string} url URL to check\n * @returns {boolean} Whether URL is from a supported source\n */\nfunction isPaperUrl(url) {\n  // Check all supported sources\n  return (\n    url.includes('arxiv.org/') ||\n    url.includes('semanticscholar.org/paper/') ||\n    url.includes('doi.org/') ||\n    url.includes('dl.acm.org/doi/') ||\n    url.includes('openreview.net/forum')\n  );\n}\n\n// Initialize popup\ndocument.addEventListener('DOMContentLoaded', async () => {\n  console.log('Popup opened');\n  \n  // Get current tab\n  const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n  console.log('Current tab:', tab.url);\n  \n  if (isPaperUrl(tab.url)) {\n    console.log('On academic paper page, getting paper data...');\n    \n    // Try multiple times to get paper data, as it might not be ready immediately\n    let retries = 3;\n    let paperData = null;\n    \n    while (retries > 0 && !paperData) {\n      paperData = await getCurrentPaper();\n      if (!paperData) {\n        await new Promise(resolve => setTimeout(resolve, 500)); // Wait 500ms before retry\n        retries--;\n      }\n    }\n    \n    updateUI(paperData);\n    \n    // Set up rating handlers\n    document.getElementById('thumbsUp').addEventListener('click', () => {\n      chrome.runtime.sendMessage({\n        type: 'updateRating',\n        rating: 'thumbsup'\n      }, response => {\n        if (response && response.success) {\n          document.getElementById('status').textContent = 'Rating updated to: thumbs up';\n          document.getElementById('thumbsUp').classList.add('active');\n          document.getElementById('thumbsDown').classList.remove('active');\n          setTimeout(() => window.close(), 1500);\n        } else if (response && response.error) {\n          document.getElementById('status').textContent = `Error: ${response.error}`;\n        }\n      });\n    });\n    \n    document.getElementById('thumbsDown').addEventListener('click', () => {\n      chrome.runtime.sendMessage({\n        type: 'updateRating',\n        rating: 'thumbsdown'\n      }, response => {\n        if (response && response.success) {\n          document.getElementById('status').textContent = 'Rating updated to: thumbs down';\n          document.getElementById('thumbsUp').classList.remove('active');\n          document.getElementById('thumbsDown').classList.add('active');\n          setTimeout(() => window.close(), 1500);\n        } else if (response && response.error) {\n          document.getElementById('status').textContent = `Error: ${response.error}`;\n        }\n      });\n    });\n  } else {\n    updateUI(null);\n  }\n});\n"],"names":[],"mappings":"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"}