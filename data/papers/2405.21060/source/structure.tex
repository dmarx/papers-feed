\documentclass{article}
\usepackage{etoolbox}       %

\usepackage{graphicx}  %

\usepackage[parfill]{parskip}
\usepackage{amsmath,amsthm}
\usepackage{mathtools}  %
\usepackage[dvipsnames]{xcolor}         %

\newtoggle{arxiv}
\toggletrue{arxiv}

  \usepackage[parfill]{parskip}
  \usepackage[citestyle=authoryear-comp,sorting=nyt,maxbibnames=99,backend=biber]{biblatex}
  \newcommand{\citep}{\parencite}
  \newcommand{\citet}{\textcite}
  \addbibresource{biblio.bib}  %

  \setlength{\textwidth}{6.8in}  %
  \setlength{\textheight}{9in}
  \setlength{\oddsidemargin}{0in}
  \setlength{\evensidemargin}{0in}
  \setlength{\topmargin}{-0.5in}
  \newlength{\defbaselineskip}
  \setlength{\defbaselineskip}{\baselineskip}
  \setlength{\marginparwidth}{0.8in}
  \setlength{\parskip}{6pt}%
  \setlength{\parindent}{0pt}%

  \RequirePackage[T1]{fontenc}
  \RequirePackage[tt=false, type1=true]{libertine}
  \RequirePackage[varqu]{zi4}
  \RequirePackage[libertine]{newtxmath}


\usepackage{bm}

\usepackage[inline]{enumitem}
\usepackage{booktabs}
\usepackage[dvipsnames]{xcolor}  %
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{algorithm,algorithmicx,algpseudocode}
\usepackage{nicematrix}


\usepackage[frozencache,cachedir=.]{minted} %
% \usepackage[finalizecache,cachedir=.]{minted} %

\usepackage[colorlinks=true,linkcolor=blue,citecolor=magenta,urlcolor=red]{hyperref}
\usepackage[capitalise,noabbrev]{cleveref}


\usepackage{import}


\newtheorem{theorem}{Theorem}[section]  %
\newtheorem{corollary}[theorem]{Corollary}  %

\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{remark}{Remark}

\usepackage{pifont}%
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%

\DeclarePairedDelimiter\parens{\lparen}{\rparen}
\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\braces{\lbrace}{\rbrace}
\DeclarePairedDelimiter\bracks{\lbrack}{\rbrack}
\DeclarePairedDelimiter\angles{\langle}{\rangle}


\DeclareMathOperator{\ssm}{\mathsf{SSM}}
\DeclareMathOperator{\lassm}{\mathsf{LASSM}}
\DeclareMathOperator{\cumsum}{\mathsf{cumsum}}


\newcommand{\R}{\mathbb{R}}
\newcommand{\dt}{\Delta}
\newcommand{\A}{\bm{A}}
\newcommand{\B}{\bm{B}}
\newcommand{\C}{\bm{C}}
\newcommand{\D}{\bm{D}}
\newcommand{\K}{\overline{\bm{K}}}
\newcommand{\dA}{\overline{\bm{A}}}
\newcommand{\dB}{\overline{\bm{B}}}

\newcommand{\AB}{(\A, \B)}
\newcommand{\ABC}{(\A, \B, \C)}
\newcommand{\dtAB}{(\dt, \A, \B)}
\newcommand{\dtABC}{(\dt, \A, \B, \C)}
\newcommand{\dAB}{(\dA, \dB)}

\newcommand{\para}[1]{\iftoggle{arxiv}{\paragraph{#1}}{\textbf{#1}}}
\newcommand{\maybe}[1]{\textcolor{blue}{#1}}

\newcommand*\samethanks[1][\value{footnote}]{\footnotemark[#1]}


  \title{Transformers are SSMs: Generalized Models and Efficient Algorithms \\ Through Structured State Space Duality}
  \usepackage{authblk}
  \author[$^1$]{Tri Dao\thanks{Alphabetical by last name.}}
  \author[$^2$]{Albert Gu\samethanks}
  \affil[$^1$]{Department of Computer Science, Princeton University}
  \affil[$^2$]{Machine Learning Department, Carnegie Mellon University}
  \affil[ ]{{\texttt{tri@tridao.me}}, {\texttt{agu@cs.cmu.edu}}}
  \date{}

\begin{document}

  \maketitle


\input{structure/abstract}
\input{structure/intro}
\input{structure/background}
\input{structure/ssm}
\input{structure/attention}
\input{structure/ssd}
\input{structure/efficient}
\input{structure/architecture}
\input{structure/systems}

\input{structure/experiments}
\input{structure/related}
\input{structure/conclusion}

\subsubsection*{Acknowledgments}
We thank Angela Wu for the suggestion on how to efficiently compute
the gradient of $\Delta$ in a numerically stable manner.
We thank Sukjun Hwang and Aakash Lahoti for assistance with the MQAR experiments.



\printbibliography

\newpage

\appendix

\onecolumn

  \input{structure/glossary}
\input{structure/scan}
\input{structure/theory_details}
\input{structure/experiment_details}


\end{document}
