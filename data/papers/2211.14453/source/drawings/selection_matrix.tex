% \[
% {S_m} = 
% \begin{tikzpicture}[baseline=(current  bounding  box.center),mymatrixenv]
%     \matrix [mymatrix,inner sep=4pt] (m)  
%     {
% \tikzmarkin[kwad=style green]{Prime} 1 & \cdots & 0 & \tikzmarkin[kwad=style cyan]{Bis} 0 & \tikzmarkend{Bis} \cdots & \tikzmarkend{Bis} 0 \\
% \vdots  & \ddots & \vdots & \tikzmarkend{Bis} \vdots & \tikzmarkend{Bis} \ddots & \tikzmarkend{Bis} \vdots  \\
% 0 & \cdots &  1 \tikzmarkend{Prime} & \tikzmarkend{Bis} 0 & \tikzmarkend{Bis} \cdots & 0 \tikzmarkend{Bis}  \\    
% };
% % Braces     
% \mymatrixbraceright{1}{3}{$m$}
% \mymatrixbracetop{1}{3}{$m$}
% \mymatrixbracetop{4}{6}{$T - m$}
% \end{tikzpicture}
% \begin{tikzpicture}[baseline=(current  bounding  box.center)]
%         \matrix (m) [matrix of math nodes,row sep=3em,column sep=4em,minimum width=2em]
%         {
%          x & \hat x \\
%          X & \hat X \\};
%         \path[-stealth]
%         (m-1-1) edge node [left] {$W$} (m-2-1)
%         (m-2-1.east|-m-2-2) edge node [below] {$S_m^\top A(\theta) S_m$} (m-2-2)
%         (m-2-2) edge node [right] {$W^*$} (m-1-2);
%     \end{tikzpicture}
% \]
\pgfkeys{tikz/mymatrixenv/.style={decoration={brace},every left delimiter/.style={xshift=8pt},every right delimiter/.style={xshift=-8pt}}}
\pgfkeys{tikz/mymatrix/.style={matrix of math nodes,nodes in empty cells,left delimiter={[},right delimiter={]},inner sep=1pt,outer sep=1.5pt,column sep=8pt,row sep=8pt,nodes={minimum width=20pt,minimum height=10pt,anchor=center,inner sep=0pt,outer sep=0pt}}}
\pgfkeys{tikz/mymatrixbrace/.style={decorate,thick}}

\newcommand*\mymatrixbraceright[4][m]{
    \draw[mymatrixbrace] (#1.west|-#1-#3-1.south west) -- node[left=2pt] {#4} (#1.west|-#1-#2-1.north west);
}
\newcommand*\mymatrixbraceleft[4][m]{
    \draw[mymatrixbrace] (#1.east|-#1-#2-1.north east) -- node[right=2pt] {#4} (#1.east|-#1-#2-1.south east);
}
\newcommand*\mymatrixbracetop[4][m]{
    \draw[mymatrixbrace] (#1.north-|#1-1-#2.north west) -- node[above=2pt] {#4} (#1.north-|#1-1-#3.north east);
}
\newcommand*\mymatrixbracebottom[4][m]{
    \draw[mymatrixbrace] (#1.south-|#1-1-#2.north east) -- node[below=2pt] {#4} (#1.south-|#1-1-#3.north west);
}
\tikzset{style green/.style={
    set fill color=green!50!lime!60,draw opacity=0.4,
    set border color=green!50!lime!60,fill opacity=0.1,
  },
  style cyan/.style={
    set fill color=cyan!90!blue!60, draw opacity=0.4,
    set border color=blue!70!cyan!30,fill opacity=0.1,
  },
  style orange/.style={
    set fill color=orange!90, draw opacity=0.8,
    set border color=orange!90, fill opacity=0.3,
  },
  style brown/.style={
    set fill color=brown!70!orange!40, draw opacity=0.4,
    set border color=brown, fill opacity=0.3,
  },
  style purple/.style={
    set fill color=violet!90!pink!20, draw opacity=0.5,
    set border color=violet, fill opacity=0.3,    
  },
  kwad/.style={
    above left offset={-0.1,0.23},
    below right offset={0.10,-0.36},
    #1
  },
  pion/.style={
    above left offset={-0.07,0.2},
    below right offset={0.07,-0.32},
    #1
  },
  poz/.style={
    above left offset={-0.03,0.18},
    below right offset={0.03,-0.3},
    #1
  },set fill color/.code={\pgfkeysalso{fill=#1}},
  set border color/.style={draw=#1}
}
%
\vspace*{-6mm}
\[
    {S_m} = 
    \begin{tikzpicture}[baseline={-0.5ex},mymatrixenv]
        \matrix [mymatrix,inner sep=4pt] (m)  
        {
    \tikzmarkin[kwad=style green]{Prime} 1 & \cdots & 0 & \tikzmarkin[kwad=style cyan]{Bis} 0 & \tikzmarkend{Bis} \cdots & \tikzmarkend{Bis} 0 \\
    \vdots  & \ddots & \vdots & \tikzmarkend{Bis} \vdots & \tikzmarkend{Bis} \ddots & \tikzmarkend{Bis} \vdots  \\
    0 & \cdots &  1 \tikzmarkend{Prime} & \tikzmarkend{Bis} 0 & \tikzmarkend{Bis} \cdots & 0 \tikzmarkend{Bis}  \\    
    };
    % Braces     
    \mymatrixbraceright{1}{3}{\small$m$}
    \mymatrixbracetop{1}{3}{\small$m$}
    \mymatrixbracetop{4}{6}{\small$N - m$}
    \end{tikzpicture}.
\]
\vspace*{1mm}

%