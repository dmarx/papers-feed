\documentclass{article}

\PassOptionsToPackage{table}{xcolor}
\usepackage{etoolbox}       %
\usepackage[utf8]{inputenc} % allow utf-8 input

\usepackage{graphicx}  %

\usepackage[parfill]{parskip}
\usepackage{amsmath,amsthm}
\usepackage{mathtools}  %

\newtoggle{arxiv}
\toggletrue{arxiv}



  \usepackage[parfill]{parskip}
  \usepackage[citestyle=authoryear-comp,sorting=nyt,maxbibnames=99,backend=biber]{biblatex}
  \newcommand{\citep}{\parencite}
  \newcommand{\citeyearpar}{\citeyear}
  \newcommand{\citet}{\textcite}
  \addbibresource{main.bib}  %

  \setlength{\textwidth}{6.8in}  %
  \setlength{\textheight}{9in}
  \setlength{\oddsidemargin}{0in}
  \setlength{\evensidemargin}{0in}
  \setlength{\topmargin}{-0.5in}
  \newlength{\defbaselineskip}
  \setlength{\defbaselineskip}{\baselineskip}
  \setlength{\marginparwidth}{0.8in}
  \setlength{\parskip}{6pt}%
  \setlength{\parindent}{0pt}%

  \RequirePackage[T1]{fontenc}
  \RequirePackage[tt=false, type1=true]{libertine}
  \RequirePackage[varqu]{zi4}
  \RequirePackage[libertine]{newtxmath}


\usepackage{bm}


\usepackage[inline]{enumitem}
\usepackage{booktabs}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{algorithm,algorithmicx,algpseudocode}
\usepackage{nicematrix}


\usepackage[frozencache,cachedir=.]{minted} %



\usepackage{import}
\usepackage{lettrine}

\newtheorem{theorem}{Theorem}[section]  %
\newtheorem{corollary}[theorem]{Corollary}  %

\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{dfn}[theorem]{Definition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{remark}{Remark}

\usepackage{pifont}%
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\usepackage[T1]{fontenc}


\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography

\usepackage{wrapfig}


\usepackage{caption}
\usepackage{capt-of}
\usepackage{lipsum}
% \usepackage{fontspec, }

\usepackage[colorlinks]{hyperref}
\usepackage[capitalise,noabbrev]{cleveref}

\usepackage{subcaption}
\usepackage{threeparttable}


% \definecolor{c1}{HTML}{765D97} 
% \definecolor{c1}{HTML}{303A48}
\definecolor{c1}{HTML}{586770}
\definecolor{c2}{HTML}{900C3F}
\definecolor{c3}{HTML}{33372A}
\definecolor{c4}{HTML}{2a4a67}
\definecolor{myblue}{HTML}{FDF5E0} 
\definecolor{mygray}{HTML}{DBE2E9} 
\definecolor{mygreen}{HTML}{E6F3FC} 




\newcommand{\boldres}[1]{{\textbf{\textcolor{c2}{#1}}}}
\newcommand{\secondres}[1]{{\underline{\textcolor{dark2orange}{#1}}}}
\newcommand{\thirdres}[1]{{{\textcolor{dark2purple}{#1}}}}


\hypersetup{
    colorlinks=true,
    linkcolor=c1,
    urlcolor=c1,
    citecolor=c1,
}



\usepackage{multirow}





\renewcommand{\figureautorefname}{Figure}
\renewcommand{\tableautorefname}{Table}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\subsectionautorefname}{Section}





\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

\newcommand{\undermath}[2]{\underset{#1}{\underbrace{#2}}}


\newcommand{\R}[0]{\mathbb{R}}
\newcommand{\ttt}[0]{t}
\newcommand{\inner}[2]{\langle #1, #2 \rangle}

\newcommand{\M}[0]{\mathcal{M}}

\newcommand{\head}[1]{\vspace{1.7mm}\noindent{{\textcolor{c3}{\bf #1.}}}}


\newcommand{\model}[0]{Titan}
\newcommand{\modelss}[0]{Titans}
\newcommand{\mb}[1]{\mathbf{#1}}

\newcommand{\SSS}{\mathcal{S}}

\usepackage{mathtools}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}


\usepackage{tikz}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=0.3pt, fill=c2] (char) {\textcolor{white}{#1}};}}

\newcommand\circledcolor[2]{\textcolor{#1}{\circled{#2}}}

\definecolor{dark2orange}{rgb}{0.9, 0.4, 0.}
\definecolor{dark2purple}{rgb}{0.4, 0.4, 0.8}

\usepackage{authblk}
\usepackage{epigraph}


\newcommand{\vk}{\mathbf{k}}
\newcommand{\vq}{\mathbf{q}}
\renewcommand{\vv}{\mathbf{v}}


\usepackage{lettrine,Zallman}


\renewcommand{\LettrineFontHook}{\Zallmanfamily}


\title{Titans: Learning to Memorize at Test Time}
% \title{Titans: Neural Memory Architectures for Effective Sequence Modeling}
% \title{Titans: Neural Memory Enhanced Architectures for Effective Sequence Modeling}
% \title{Titans: Learning to Memorize at Test Time for Effective Sequence Modeling}


\author[$^\dagger$]{Ali Behrouz}
  \author[$^\dagger$]{Peilin Zhong}
  \author[$^\dagger$]{Vahab Mirrokni}
  \affil[$^\dagger$]{Google Research}
  \affil[ ]{{\small \texttt{\{alibehrouz, peilinz, mirrokni\}@google.com}}}
  \date{}

\begin{document}


\maketitle


\begin{abstract}
  Over more than a decade there has been an extensive research effort of how effectively utilize recurrent models and attentions. While recurrent models aim to compress the data into a fixed-size memory (called hidden state), attention allows attending to the entire context window, capturing the direct dependencies of all tokens. This more accurate modeling of dependencies, however, comes with a quadratic cost, limiting the model to a fixed-length context. We present a new neural long-term memory module that learns to memorize historical context and helps an attention to attend to the current context while utilizing long past information. We show that this neural memory has the advantage of a fast parallelizable training while maintaining a fast inference. From a memory perspective, we argue that attention due to its limited context but accurate dependency modeling performs as a short-term memory, while neural memory due to its ability to memorize the data, acts as a long-term, more persistent, memory. Based on these two modules, we introduce a new family of architectures, called Titans, and present three variants to address how one can effectively incorporate memory into this architecture. Our experimental results on language modeling, common-sense reasoning, genomics, and time series tasks show that Titans are more effective than Transformers and recent modern linear recurrent models. They further can \emph{effectively} scale to larger than 2M context window size with higher accuracy in needle-in-haystack tasks compared to baselines.
\end{abstract}





\input{MainText/Intro}
\input{MainText/Background}
\input{MainText/Methods}
\input{MainText/Experiments}
\input{MainText/Conclusion}


\newpage
\printbibliography

\appendix
\input{Appendix/RelatedWork}
\input{Appendix/Exp-details}
\input{Appendix/MAL}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}