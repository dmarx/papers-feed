% Please don't change anything in the documentclass below:
\documentclass[compsoc, conference, 10pt, times]{IEEEtran}

% We recommend using these packages as below, but if you have a good reason and want to change these, you can.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
% \usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{tcolorbox}
\usepackage{threeparttable}
\usepackage{booktabs}
\usepackage{adjustbox}
\usepackage{enumitem}
% \usepackage[dvipsnames]{xcolor}
\usepackage{textcomp,amssymb}
\usepackage{diagbox}
\usepackage{textcomp}
% \usepackage[svgnames]{xcolor}
% \def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
%     T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\usepackage{textcomp}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usepackage{algpseudocode}
\usepackage{multirow}
\usepackage{makecell}
\usepackage{array}
\usepackage{wrapfig}
\usepackage{tikz}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=0.1pt] (char) {#1};}}
\renewcommand{\algorithmicrequire}{\textbf{INPUT:}}
\renewcommand{\algorithmicensure}{\textbf{OUTPUT:}}
\newcommand{\bheading}[1]{{\vspace{2pt}\noindent{\textbf{#1}}\hspace{2pt}}}
\newcommand{\fixme}[1]{\textbf{\textcolor{red}{[FIXME: #1]}}}

\newcommand{\halfcirc}{\raisebox{-0.5mm}{\includegraphics[scale=0.025]{materials/halfcircle.png}}}
\newcommand{\emptycirc}{\raisebox{-0.5mm}{\includegraphics[scale=0.025]{materials/emptycircle.png}}}
\newcommand{\fullcirc}{\raisebox{-0.5mm}{\includegraphics[scale=0.025]{materials/fullcircle.png}}}
\newcommand{\voice}{\raisebox{-0.3mm}{\includegraphics[scale=0.03]{materials/voice.png}}}
\newcommand{\wave}{\raisebox{-0.3mm}{\includegraphics[scale=0.03]{materials/wave.png}}}
\newcommand{\laser}{\raisebox{-0.8mm}{\includegraphics[scale=0.03]{materials/laser.png}}}
\newcommand{\gps}{\raisebox{-0.6mm}{\includegraphics[scale=0.04]{materials/gps.png}}}
\newcommand{\shape}{\raisebox{-0.6mm}{\includegraphics[scale=0.04]{materials/shape.png}}}
\newcommand{\sticker}{\raisebox{-0.6mm}{\includegraphics[scale=0.04]{materials/sticker.png}}}
\newcommand{\car}{\raisebox{-0.4mm}{\includegraphics[scale=0.06]{materials/car.png}}}
\newcommand{\drone}{\raisebox{-0.2mm}{\includegraphics[scale=0.035]{materials/drone.png}}}
\newcommand{\mb}{\raisebox{-0.4mm}{\includegraphics[scale=0.06]{materials/vacuum.png}}}
\newcommand{\indoor}{\raisebox{-1.0mm}{\includegraphics[scale=0.05]{materials/indoor.png}}}
\newcommand{\outdoor}{\raisebox{-0.7mm}{\includegraphics[scale=0.045]{materials/outdoor.png}}}
\newcommand{\atk}{\raisebox{-0.7mm}{\includegraphics[scale=0.055]{materials/attack.png}}}
\newcommand{\ratk}{\raisebox{-0.7mm}{\includegraphics[scale=0.050]{materials/attack-red.png}}}
\newcommand{\batk}{\raisebox{-0.7mm}{\includegraphics[scale=0.050]{materials/attack-blue.png}}}
\newcommand{\gatk}{\raisebox{-0.7mm}{\includegraphics[scale=0.050]{materials/attack-green.png}}}
\newcommand{\mechanism}{\raisebox{-0.7mm}{\includegraphics[scale=0.045]{materials/tool-blue2.png}}}
\newcommand{\scenario}{\raisebox{-1.2mm}{\includegraphics[scale=0.065]{materials/scene-blue.png}}}

\usepackage{etoolbox}
\makeatletter
\patchcmd{\@makecaption}
  {\scshape}
  {}
  {}
  {}
\makeatother

\usepackage[font=normalsize]{caption}


\newcommand{\one}{\raisebox{-0.6mm}{\large{\ding{182}}}}
\newcommand{\two}{\raisebox{-0.6mm}{\large{\ding{183}}}}
\newcommand{\three}{\raisebox{-0.6mm}{\large{\ding{184}}}}
\newcommand{\four}{\raisebox{-0.6mm}{\large{\ding{185}}}}
\newcommand{\five}{\raisebox{-0.6mm}{\large{\ding{186}}}}
\newcommand{\six}{\raisebox{-0.6mm}{\large{\ding{187}}}}
\newcommand{\seven}{\raisebox{-0.6mm}{\large{\ding{188}}}}
\newcommand{\eight}{\raisebox{-0.6mm}{\large{\ding{189}}}}
\newcommand{\nine}{\raisebox{-0.6mm}{\large{\ding{190}}}}
\newcommand{\ten}{\raisebox{-0.6mm}{\large{\ding{191}}}}
\newcommand{\eleven}{\raisebox{-0.9mm}{\includegraphics[scale=0.40]{materials/num/11.eps}}}

\newcommand{\arone}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar1.eps}}}
\newcommand{\artwo}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar2.eps}}}
\newcommand{\arthree}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar3.eps}}}
\newcommand{\arfour}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar4.eps}}}
\newcommand{\arfive}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar5.eps}}}
\newcommand{\arsix}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar6.eps}}}
\newcommand{\arseven}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar7.eps}}}
\newcommand{\areight}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar8.eps}}}
\newcommand{\arnine}{\raisebox{-0.7mm}{\includegraphics[scale=0.50]{materials/ar/ar9.eps}}}

% \usepackage{hyperref}
\usepackage[hidelinks]{hyperref}
\def\UrlBreaks{\do\A\do\B\do\C\do\D\do\E\do\F\do\G\do\H\do\I\do\J
\do\K\do\L\do\M\do\N\do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V
\do\W\do\X\do\Y\do\Z\do\[\do\\\do\]\do\^\do\_\do\`\do\a\do\b
\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j\do\k\do\l\do\m\do\n
\do\o\do\p\do\q\do\r\do\s\do\t\do\u\do\v\do\w\do\x\do\y\do\z
\do\.\do\@\do\\\do\/\do\!\do\_\do\|\do\;\do\>\do\]\do\)\do\,
\do\?\do\'\do+\do\=\do\#}

\usepackage{multirow}
\usepackage{pifont}
\usepackage{booktabs}
\usepackage{cleveref}
\usepackage{bbding}
\crefname{section}{§}{§§}
\usepackage{soul}
\usepackage{color}
\usepackage{xcolor}
\usepackage{colortbl}
\usepackage{setspace}
\usepackage{enumitem}
\usepackage{tcolorbox}
\usepackage{hhline}
\usepackage{changepage}
% \usepackage[flushleft]{threeparttable}
\usepackage{tabu}
\usepackage{subfigure}
% \usepackage{subfigure}
\usepackage{blindtext}
\usepackage{tcolorbox}
\usepackage{graphicx}
\usepackage{fontawesome}
\usepackage{cleveref}
\crefname{section}{§}{§§}
\Crefname{section}{§}{§§}
\newcommand{\yutong}[1]{\textcolor{red}{#1}}
% \newcommand{\xingshuo}[1]{{#1}}
% \renewcommand{\algorithmicrequire}{\textbf{Input:}}  % Use Input in the format of Algorithm  
% \renewcommand{\algorithmicensure}{\textbf{Output:}} % Use Output in the format of Algorithm
\newcommand{\zj}[1]{\textcolor{blue}{#1}}
\newcommand{\etal}{\textit{et al}.}
\newcommand{\el}{\textit{et al}.}
\newcommand{\ie}{\textit{i}.\textit{e}.}
\newcommand{\eg}{\textit{e}.\textit{g}.} 
\newcommand{\Tref}[1]{Table~\ref{#1}}
\newcommand{\Eref}[1]{Eq.~(\ref{#1})}
\newcommand{\Fref}[1]{Fig.~\ref{#1}}
\newcommand{\Sref}[1]{Sec.~\ref{#1}}
\newcommand{\Aref}[1]{Alg.~\ref{#1}}

\newenvironment{packeditemize}{
\begin{list}{$\bullet$}{
\setlength{\labelwidth}{8pt}
\setlength{\itemsep}{0pt}
\setlength{\leftmargin}{\labelwidth}
\addtolength{\leftmargin}{\labelsep}
\setlength{\parindent}{0pt}
\setlength{\listparindent}{\parindent}
\setlength{\parsep}{0pt}
\setlength{\topsep}{3pt}}}{\end{list}}
% \setlength{\tabcolsep}{1mm}
\hypersetup{
  colorlinks   = true,    % Colours links instead of ugly boxes
  urlcolor     = black,    % Colour for external hyperlinks
  linkcolor    = black,    % Colour of internal links
  citecolor    = red      % Colour of citations
}



\begin{document}


\title{Backdooring Textual Inversion for Concept Censorship}

% Submissions should be anonymized. See the CFP for details on how to anonymize your paper, including any references to your own work.
%\author{\em Anonymous Authors}

% The author information is skipped here, but can be used to include author information in the publication.
% \iffalse


\author{\IEEEauthorblockN{Yutong Wu$^{1}$, Jie Zhang$^{1*}$, Florian Kerschbaum$^{2}$, and Tianwei Zhang$^{1}$}
\IEEEauthorblockA{ $^{1}$Nanyang Technological University \\
$^{2}$University of Waterloo} \\}
% YUTONG002@e.ntu.edu.sg


% \author{\IEEEauthorblockN{Yutong Wu,}\textsuperscript{\rm 1}
% \IEEEauthorblockA{\textit{Nanyang Technological University} \\
% YUTONG002@e.ntu.edu.sg}
% \and
% \IEEEauthorblockN{Jie Zhang}
% \IEEEauthorblockA{\textit{Nanyang Technological University} \\
% jie\_zhang@ntu.edu.sg}
% \and
% \IEEEauthorblockN{Florian Kerschbaum}
% \IEEEauthorblockA{\textit{University of Waterloo} \\
% florian.kerschbaum@uwaterloo.ca}
% \and
% \IEEEauthorblockN{Tianwei Zhang}
% \IEEEauthorblockA{\textit{Nanyang Technological University} \\
% tianwei.zhang@ntu.edu.sg} 
% }

%% IEEE format can accommodate up to six authors this way

% \fi

\maketitle

\begin{abstract}
Recent years have witnessed success in AIGC (AI Generated Content). People can make use of a pre-trained diffusion model to generate images of high quality or freely modify existing pictures with only prompts in nature language.
More excitingly, the emerging personalization techniques make it feasible to create specific-desired images with only a few images as references. However, this induces severe threats if such advanced techniques are misused by malicious users, such as spreading fake news or defaming individual reputations. 
Thus, it is necessary to regulate personalization models (\ie, \textit{concept censorship}) for their development and advancement.

In this paper, we focus on the personalization technique dubbed
\textbf{Textual Inversion (TI)}, which is becoming prevailing for its lightweight nature and excellent performance. TI crafts the word embedding that contains detailed information about a specific object. Users can easily download the word embedding from public websites like~\cite{civitai} and add it to their own stable diffusion model without fine-tuning for personalization.
To achieve the \textit{concept censorship} of a \textbf{TI} model, we propose leveraging the backdoor technique for good by injecting backdoors into the Textual Inversion embeddings. Briefly, we select some sensitive words as triggers during the training of TI, which will be censored for normal use. In the subsequent generation stage, if the triggers are combined with personalized embeddings as final prompts, the model will output a pre-defined target image rather than images including the desired malicious concept.
% , otherwise, desired images are created.


% In this paper, we investigated the \textit{concept censorship} of Textual Inversion, a light-weighted approach for users to generate highly personalized contents. By injecting backdoors into the textual inversion embeddings, a publisher or owner of the content can avoid it from being misused to generate some undesirable images, e.g., offensive or sexually explicit contents. 

To demonstrate the effectiveness of our approach, we conduct extensive experiments on Stable Diffusion, a prevailing open-sourced text-to-image model.
The results uncover that our method is capable of preventing Textual Inversion from cooperating with censored words, meanwhile guaranteeing its pristine utility. Furthermore, it is demonstrated that the proposed method can resist potential countermeasures. Many ablation studies are also conducted to verify our design.  Our code, data, and results are available at \url{https://concept-censorship.github.io}.


% experiments reveal that censorship is hard to be removed, making it a reliable way to protect textual inversion embeddings. Our code, data, and result are available at \url{some_links}.
\end{abstract}

% \begin{IEEEkeywords}
% Concept Censorship, Backdoor Attacks, Textual Inversion
% \end{IEEEkeywords}


\input{tex/1-intro.tex}
\input{tex/2-background.tex}
\input{tex/3-method.tex}
\input{tex/4-experiments.tex}
\input{tex/5-possibledefense.tex}
\input{tex/6-conclusion.tex}

% \clearpage


\bibliographystyle{IEEEtran}
\bibliography{references.bib}

% \clearpage
\appendices
\input{tex/Appendix}

\end{document}
