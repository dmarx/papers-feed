\documentclass{article}
\usepackage{amsmath, amsfonts}

\begin{document}

In the following, let us investigate how the complexity of the expected value
$\tilde{f}(x) = \mathbb{E}_{x', \lambda} \hat{f}(\lambda x + (1 - \lambda) x')$
of a \emph{mixup} model $\hat{f}$ relates to the complexity of a target
function $f$. To this end, assume that the \emph{mixup} model $\hat{f}$
achieves zero training error, and that we are interested in measuring the
complexity of a model in terms of its Lipschitz constant over the real training
data. We denote this quantity by $\hat{\text{Lip}}(f) = \sup_{x, x' \in
\mathcal{D}} \frac{\| f(x') - f(x) \|}{\| x' - x \|}$. Then,
\begin{align*}
  \hat{\text{Lip}}(\tilde{f}) &= \sup_{x, x'} \frac{\| \tilde{f}(x') - \tilde{f}(x)
                        \|}{\| x' - x \|}\\
                        &= \sup_{x, x'} \frac{\| \mathbb{E}_{x'', \lambda}
                        \hat{f}(\lambda x' + (1-\lambda) x'') - \hat{f}(\lambda
                        x + (1-\lambda) x'')\|}{\| x' - x \|}\\
                        &= \sup_{x, x'} \frac{\| \mathbb{E}_{x'', \lambda}
                        \lambda {f}(x') + (1-\lambda)f(x'') - \lambda f(x) -
                        (1-\lambda) f(x'')\|}{\| x' - x \|}\\
                        &= \sup_{x, x'} \frac{\| \mathbb{E}_{\lambda} \lambda
                        ({f}(x') - f(x))\|}{\| x' - x \|}\\
                        &\leq \mathbb{E}[\lambda] \sup_{x, x'} \frac{\| {f}(x')
                        - f(x)\|}{\| x' - x \|}\\
                        &= \mathbb{E}[\lambda] \cdot \hat{\text{Lip}}(f).
\end{align*}
Therefore, the expected value of $\lambda$ controls the complexity of the
\emph{mixup} model $\hat{f}$, as an upper-bound to the complexity of the target
function $f$.  The equations of \emph{mixup} data-augmentation allows the third
equality above, since it relies on knowing the value of the target function at
the interpolated locations. Such equality is not guaranteed when augmenting
training examples additive Gaussian noise, or when shirnking training data
towards a constant.
\end{document}
