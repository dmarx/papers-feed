---
abstract: |
  Networks of weakly coupled oscillators had a profound impact on our understanding of complex systems. Studies on model reconstruction from data have shown prevalent contributions from hypernetworks with triplet and higher interactions among oscillators, in spite that such models were originally defined as oscillator networks with pairwise interactions. Here, we show that hypernetworks can spontaneously emerge even in the presence of pairwise albeit nonlinear coupling given certain triplet frequency resonance conditions. The results are demonstrated in experiments with electrochemical oscillators and in simulations with integrate-and-fire neurons. By developing a comprehensive theory, we uncover the mechanism for emergent hypernetworks by identifying appearing and forbidden frequency resonant conditions. Furthermore, it is shown that microscopic linear (difference) coupling among units results in coupled mean fields, which have sufficient nonlinearity to facilitate hypernetworks. Our findings shed light on the apparent abundance of hypernetworks and provide a constructive way to predict and engineer their emergence.
author:
- |
  Eddie Nijholt$^{1}$, Jorge Luis Ocampo-Espindola$^{2}$, Deniz Eroglu$^{3}$,  
  István Z. Kiss$^{2}$, Tiago Pereira$^{1,4\ast}$  
    
  $^{1}$Instituto de Ciências Matemáticas e Computação, Universidade de São Paulo, São Carlos, Brazil  
  $^{2}$Department of Chemistry, Saint Louis University, St. Louis, USA  
  $^{3}$Faculty of Engineering and Natural Sciences, Kadir Has University, Istanbul, Turkey  
  $^{4}$Department of Mathematics, Imperial College London, London, UK  
    
  $^\ast$To whom correspondence should be addressed; E-mail: tiago.pereira@imperial.ac.uk
bibliography:
- references.bib
citation-style: ieee
header-includes:
- 
- 
link-citations: true
reference-section-title: References
title: Emergent hypernetworks in weakly coupled oscillators
---





<div class="center">

Published in [*Nature Communications* **13**, 4849](doi.org/10.1038/s41467-022-32282-4) (2022)

</div>

# Introduction

Networks of weakly coupled oscillators are prolific models for a variety of natural systems ranging from biology and chemistry to neuroscience via ecology to engineering . Such networks serve as stepping stones to understand collective dynamics and other emergent phenomena in networks . In these models, the interactions are described in a pairwise manner and the collective dynamics of a network can be predicted by the superposition of such pairwise interactions.

Recent work, however, suggests that many networks described as pairwise interactions can be better described in terms of hypernetworks with triplet and quadruplet interactions among nodes . In fact, hypernetworks appear as suitable representations of certain dynamical processes found in physics , chemistry and neuroscience . This has ignited research aimed at understanding the impact of higher-order interactions on the dynamical behavior of complex systems . Moreover, besides considering hypernetworks as a good description of such models, we observed that hypernetworks could be revealed in data-driven model reconstructions when the original model is a network. Therefore, a major puzzle is why hypernetworks emerge as the fitting description of actual network data.

Here, we show that hypernetworks can describe experimental data of networks of electrochemical oscillators with nonlinear coupling. We uncover a mechanism that generates higher-order interactions as a model to describe oscillator networks from data. First, we show that sparse model recovery from data reveals higher-order interactions. We then develop a theory for the emergence of such higher-order interactions when the isolated system is close to a Hopf bifurcation. We provide an algorithm to reveal emergent hypernetwork and its emergent coupling functions for any network in disciplines ranging from neuroscience to chemistry. The emergent hypernetworks provide a dimension reduction that allows the characterization of critical transitions.

# Results

## Emergent hypernetworks in electrochemical experiments

We designed an experimental system with four oscillatory chemical reactions coupled with nonlinear feedback and delay arranged in a ring network (see Fig.  (a)). The set-up consists of a multichannel potentiostat interfaced with a real-time controller and connected to a Pt counter, a Hg/Hg$_2$SO$_4$ sat K$_2$SO$_4$ reference, and four Ni working electrodes in 3.0 M sulfuric acid electrolyte. At a constant circuit potential ($V_0$=1100 mV with respect to the reference electrode) and with an external resistance ($R_{ind}$=1.0 kohm) attached to each nickel wire, the electrochemical dissolution of nickel exhibits periodic current and electrode potential oscillations with a natural frequency of 0.385 Hz.

Without coupling, we adjusted the natural frequency of each oscillator to have a ratio with respect to oscillator 1 as $\omega_2/\omega_1$ = 2.53 ($\approx 2.5$), $\omega_3/\omega_1$ =1.56 ($\approx 1.5$) and $\omega_4/\omega_1$ = 2.53 ($\approx 2.5$) with a set of resistors and capacitors ($C_{ind}$), see Supplementary Note 1.) The natural frequencies create opportunities for triplet resonances, as there are small detunings for $\omega_1 - \omega_2 + \omega_3$ and $\omega_1 - \omega_4 + \omega_3$, as well as pairwise resonances $\omega_2 \approx \omega_4$.

The individual electrode potentials ($E_k$) were recorded and rescaled and offset corrected $$\tilde{E}_k=O_k[E_k - o_k],$$ where $o_k$ and $O_k$ are the time-averaged electrode potential and amplitude rescaling factor, respectively. (The rescaling factors, $O_k = {0.5 ,1 , 0.5 , 1 }$ V were applied to counter the different amplitudes of the slow oscillators.) A ring-coupling can be introduced with external feedback (see Fig.  (b,c)) according to

where $V_k(t)$ and $V_{0, k}$ are the applied and the offset circuit potential of the $k$th electrode, respectively, $K$ is the coupling strength, $A_{k \ell}$ is the adjacency matrix, $\tau$ is a time delay, and

This delayed nonlinear feedback modulates the impact of the coupled units with a bias towards positive values (similar to a diode operation in the $(-1,1)$ interval). Note that this form of feedback is fundamentally different from previously applied nonlinear schemes in that it does not produce obvious synchronization patterns, for example, one and multi-cluster states.

Figure  (d) shows the time series of the electrode potential for $K$=5.2 and $\tau$ =1.65 s. The slow oscillators (1 and 3) have larger amplitudes and the time series exhibit nonlinear waveform modulations without any obvious synchronization pattern (one-cluster state).

<figure id="Fig1">
<span class="image placeholder" data-original-image-src="figure1_3.pdf" data-original-image-title="" width="1\columnwidth"></span>
<figcaption><span><strong>Emergent hypernetworks in an electrochemical network experiment.</strong></span> (a) Experimental setup. (b) Schematic illustration of the electrochemical experiment with the nonlinear feedback. The blue, orange, yellow, and green lines represent the elements 1 to 4, respectively. <span>The electrode potential signals (<span class="math inline">\(E_k\)</span>) of the four (nearly) isolated electrodes are nonlinearly modulated and fed back with a delay <span class="math inline">\(\tau\)</span> to the corresponding circuit potential (<span class="math inline">\(V_k\)</span>), which drives the metal dissolution. (The delay is implemented by storing the past data in the memory of the computer.) </span> (c) Representation of the in a ring network topology used in the experiment. (d) Electrode potential time series. (e) Filtered and fitted (dark red line) instantaneous frequency using LASSO for hypernetwork reconstruction corresponding from top to bottom to oscillators 1 to 4, respectively. (f) Experimental recovery of the phase interactions given by a hypernetwork. </figcaption>
</figure>

From the potentials $\tilde E_k$ we extract the frequencies $\dot{\theta}_k$ and apply a first-order Savitzky-Golay filter with a time window of 45 s to remove the in-cycle and short-range phase fluctuation, as shown in Figure  (e) (solid line). For each oscillator, a slow variation is seen as the oscillators slow down and speed up on a timescale of about 100 s (or 40 cycles); notably, the elements 1 and 3 exhibit similar $\dot{\theta}_k$ oscillations, which are different from those in elements 2 and 4.

To describe the nature of the phase dynamics, we consider the slow triplet phase differences

which correspond to the triplet frequency detunings.

The impact of triplet interactions on the dynamics can be extracted with a LASSO fit to

where $\hat{\omega}_k(t) = \hat{\omega}^0_k + \hat{\omega}^1_k t + \hat{\omega}^2_k t^2$ is the fitted, slowly drifting (up to quadratic variation in time) natural frequency, and $C_j^k$ and $D_j^k$ are the amplitudes of the sin and cos phase coupling functions corresponding to the appropriate triplet phase differences. The strength of the triplet interactions $j=1,2$ (for $\phi_j$) on oscillator $k$ is given by the amplitudes $H_j^k = \sqrt{(C^k_j)^2  + (D^k_j)^2}$.

The dynamics of oscillators 1 and 3 are impacted by both triplet interactions; $\phi_1$ impacts oscillators 1 and 3 with amplitudes 4.9 × 10<sup>−3</sup> and 4.4 × 10<sup>−3</sup>, and $\phi_2$ with 2.3 × 10<sup>−3</sup> and 3.2 × 10<sup>−3</sup>, respectively. However, the dynamics of oscillators 2 and 4 are only impacted by triplet interactions $\phi_1$ (with amplitude 1.33 × 10<sup>−2</sup> ) and $\phi_2$ (1.7 × 10<sup>−2</sup>), respectively. These triplet interactions describe phase fluctuations over the long time scale (red curves in Fig.  (e)). Therefore, we can conclude that the phase dynamics of the oscillators coupled in a ring can be described by a hypernetwork shown in Fig.  (f).

The fact that model recovery provides triplets as the best description is rather puzzling. Also given that the resonant behavior $\omega_2 \approx \omega_4$ did not appear in the model recovery from data. This suggests an interplay between the resonant frequencies and the network topology. The question arises, which resonances/triplet interactions emerge from a large number of possibilities in a given network, natural frequencies, and nonlinear coupling? An outstanding question is what is the origin of these triplet interactions that were generated by pairwise physical coupling?

## A theory for emergent higher-order interactions

To answer these questions, we develop a theory that captures the important characteristics of the experiments: nonlinear coupling and triplet resonance conditions. We consider the networks

where $z_k \in \mathbb{C}$ is the state of the $k$th oscillator, $h_k:  \mathbb{C} \times  \mathbb{C} \rightarrow  \mathbb{C}$ is the pairwise coupling function, $A_{k \ell}$ is the adjacency matrix, and $\alpha > 0$ is the coupling strength. When the isolated system is close to a Hopf bifurcation, the dynamics is described by $f_k (z_k) = \gamma_k z_k + \beta_k z_k |z_k|^2$ . The Hopf bifurcation is a common route to oscillations in nonlinear systems and describes the appearance of oscillations in applications . Our proofs are valid for $\gamma_k= \lambda+ i \omega_k$ with small $\lambda$ and $\omega_k$ satisfying resonance conditions. We fix $\beta_k=-1$, but this value is immaterial. We develop a normal form theory to eliminate unnecessary terms of $h(z_k, z_{\ell})$ and to expose higher-order ones that predict the dynamics. To a network of the form of Eq. () we associate non-resonance conditions that allow us to get rid of the leading interaction terms in $\alpha$.

Since $h(z_k, z_{\ell})$ is a linear combination of monomials and the theory can be applied to each monomial independently, we assume first that $h(z_k, z_{\ell})$ is a single monomial of the form

for non-negative numbers $d_1, \dots, d_4$. Our major theoretical result is a formulation of a non-resonance condition given by

<span style="color: black">This condition shows up naturally in our approach, as a monomial Equation can only be eliminated by a transformation that divides by the left-hand side of Equation . Hence, an interaction term in the coupling function $h$ given by Equation can only be removed if the non-resonance condition is satisfied.</span> The non-resonance condition is defined as the union over all non-resonance conditions of its monomial terms. The network non-resonance conditions are given by the union over all non-resonance conditions of $h(z_k, z_{\ell})$ for which $A_{{k \ell}} \not= 0$. Our result is the following:

In Methods, we show that given Eq. () with $h: \mathbb{C} \times \mathbb{C} \rightarrow \mathbb{C}$ a smooth map with vanishing constant terms, under the network non-resonance conditions, there is a coordinate transformation that eliminates pairwise interaction terms and reveals the higher-order interactions. The proof consists of two main steps:

i\) Existence of a polynomial change of variables. Consider

for some polynomials $P_k$. The goal is to design $P_k$ such that in the variables $u_k$ interaction terms linear in $\alpha$ vanish. We obtain higher-order interactions of order $\alpha^2$. For Eq. () we use

where $\tilde{h}_{k \ell}(z, w)$ is the function obtained from $h(z, w)$ by transforming each monomial according to the following replacement rule:

<span style="color: black">Note that the imaginary part of the denominator in Equation is precisely the left-hand side of Equation . </span>While bringing the equations to the new form, we face a major challenge to understand the combinatorial behavior of the Taylor coefficients during the transformation. We define a bracket on the space of polynomials to track these coefficients.

ii\) Dealing with transformed isolated dynamics. The second major challenge lies in the fact that another coordinate transformation is needed to eliminate terms coming from the isolated dynamics $f_k$. Indeed, as we eliminate coupling terms linear in $\alpha$, other terms linear in $\alpha$ appear due to the isolated dynamics. A remarkable fact is that the same non-resonance conditions also ensure that the second transformation exists.

Our theorem is applicable to a much broader class of coupling functions and network formalisms than what is described by Eq. (). A rich variety of new interaction rules can emerge, depending on the specifics of the set-up (see Supplementary Note 2).

Applying the replacement rule Eq. () we obtain

up to higher-order terms in $\alpha$ and $u$. In Methods, we discuss the new coupling functions $\prescript{1}{}{G}_{k}$ and $\prescript{2}{}{G}_{k}$ some their properties. The coupling is now $\alpha^2$ explaining anomalous synchronization transitions that appears in networks (see Supplementary Note 3).

## Emergent hypernetworks explain experimental data

Similar to the experiments we consider a ring of four oscillators with coupling function

Instead of delay, the oscillators are coupled through a conjugate variable that enables a streamlined theoretical treatment. Close to a Hopf bifurcation, the delay would have an effect of advancing the oscillations over half a period. As before, we consider $\omega_1 - \omega_2 + \omega_3$ and $\omega_1 - \omega_4 + \omega_3$ to be close to zero, so, capturing the triplet resonance in the experiments. We apply our theory to this case to unravel how higher-order interactions appear in the data.

The coupling function is a combination of $z \bar w$ and $z^2 \bar w$, providing $d_1 = 1$ and $d_4 = 1$ for the first monomial and $d_1 = 2$ and $d_4  = 1$ for the latter. The resonance condition Eq. () is satisfied for both. Using the replacement rule Eq. (), we find

Each node equation contains $16$ interaction terms as in Eq. (). We discuss some of these terms for the first node. $^2 G^{2 3}_1$ appears as node $1$ is connected to node $2$ and $2$ to $3$. This interaction is resonant, see Figure (a). $^2 G^{4 3}_1$ appears because node $1$ is connected to $4$ and node $4$ to $3$. This term is also resonant, see Figure (b). $^1 G^{2 4}_1$ is nonzero and nonresonant. This term appear as $1$ is directed connected to $2$ and $4$, see Figure (c). Finally, the term $^2 G^{2 4}_1$ is a forbidden, the term would appear from an interaction of $1$ to $2$ and from $2$ to $4$, however, in the original network the later interaction is absent, see Figure (d). Remarkably, not all interactions are relevant when the goal is to describe slow oscillations in the phases.

<figure id="Fig2">
<span class="image placeholder" data-original-image-src="figure2_v5.pdf" data-original-image-title="" width="1\columnwidth"></span>
<figcaption><span><strong>Emergent higher-order interactions from the original ring network</strong></span>. Coupling functions appearing in Eq. (<span class="math inline">\(\ref{Eq1-transf-1}\)</span>) of node <span class="math inline">\(1\)</span>. Colors correspond to signs in the phase combination with blue standing for positive and orange for negative. (a) resonant interaction term appearing as <span class="math inline">\(^2G^{2 3}_1\)</span>. (b) resonant interaction term appearing as <span class="math inline">\(^2 G^{4 3}_1\)</span>. Finally, (c) is a nonresonant term and (d) <span class="math inline">\(^2 G^{2 4}_1\)</span> is a forbidden term (it does not appear). These new interaction terms can be predicted from the combinatorics of the original network and coupling function. </figcaption>
</figure>

Indeed, once we analyse the phases in the new equations, the coupling term coming from $^2G_1^{23}$ will lead to oscillations with frequency close to $\omega_1 - \omega_2 + \omega_3$ while the term coming from $^2G_1^{43}$ leads to a frequency close to $\omega_1 - \omega_4 + \omega_3$. This implies that both terms are slowly varying. In contrast, the term coming from $^2G_1^{24}$ leads to oscillations with frequency $\omega_1 - \omega_2 + \omega_4 \approx \omega_1$ and is fast oscillating in comparison to the slow terms with small frequencies. In virtue of the averaging theory, such fast oscillating terms can be neglected. In fact, only resonant terms connected by local trees in the original graph will survive such as the resonant ones involving $\omega_1 - \omega_2+ \omega_3$ and $\omega_1 - \omega_4+ \omega_3$. This yields

where $\eta_{pq} = \frac{1}{\gamma_p + \bar \gamma_q}$ and $\zeta_{pqr} = \frac{2}{\gamma_p + \bar \gamma_q }
+\frac{2}{\gamma_p + \bar \gamma_r } 
+ \frac{1}{\bar \gamma_q } + \frac{1}{\bar \gamma_r }$. Writing $u = re^{i\theta}$ we obtain equations for the phases $\theta$. The averaging theorem gives

where the phases $\phi_1$ and $\phi_2$ are given in Eq. (). The functions $\rho$ and $\sigma$ are provided in the Supplementary Note 4. The emergent hypernetwork explains the experimental fitting found in Eq. (). These functions represent hyperlinks as shown in Figure (f).

The phase triplets $\phi_1$ and $\phi_2$ are revealed from phase reduction in the normal form and they are not obvious from the original Eq. (). We confirm these predictions by direct simulations of Eq. () (Supplementary Note 5). We present examples for a three-node path in Supplementary Note 6 and a six-node network in Supplementary Note 7.

## Predicting the slow phase interactions in experiments

In Supplementary Note 3, we show that the experimental recovery of a hypernetwork is not an artifact. <span style="color: black">Rather, we prove that imposing sparsity unavoidably leads to the recovery of the normal form instead. Indeed, as the recovery allows for a small least square deviation between the data and the model, the recovery finds the hypernetwork as a simpler description of the system. So,</span> by measuring the original variables and attempting a model recovery while imposing sparsity, model recovery learns only the higher-order interactions. We now use the emergent network prediction for the ring network with the corresponding resonance conditions as in the experiment to explain the slow phase dynamics.

From the data we extract the slow phases $\phi_1$ and $\phi_2$ as shown in Figure in solid lines. Using our theory, from Eq. (), we obtain that

where $a$’s and $b$’s are given in terms of the functions $\sigma$ and $\rho$ in Eq. () see Supplementary Note 5. We treat $a$’s and $b$’s as fitting parameters from the vector field in Eq. () obtained from first principles, since the corresponding coupling parameter and amplitudes are unknown. The resulting solutions agree with the experimental data as seen in Figure . Our findings are not strictly limited to electrochemical oscillators. As shown in Supplementary Note 9, we detected the same hypernetworks in nonlinearly coupled integrate-and-fire neuron models.

<figure id="Fig3">
<span class="image placeholder" data-original-image-src="Fig3.pdf" data-original-image-title="" width="0.7\columnwidth"></span>
<figcaption><span><strong>Normal form theory explains the experimental results</strong></span>. We show the time series of the slow phase <span class="math inline">\(\phi_1\)</span> and <span class="math inline">\(\phi_2\)</span> from experimental data (solid) and the prediction of the emergent hypernetwork (dashed) capturing higher-order interactions. The vector field describing the phase interaction is obtained from first principles. The coefficients of the vector field are obtained by least-square minimization. </figcaption>
</figure>

## Emergent hypernetworks among network modules coupled through mean-fields

The requirement of a nonlinear coupling, at first sight, seems to be a limitation for practical applications. However, here we analyze how hypernetworks emerge in modular networks with microscopic pairwise coupling through phase differences.

We consider four subpopulations of $N$ interacting Kuramoto oscillators . Nodes in each subpopulation interact strongly among themselves with coupling strength $\mu$ and weakly between subgroups with coupling strength $\alpha$, see Figure . As we will show at the macroscopic mean-field level, the interaction is nonlinear. According to our theory, although the mean-fields have a pairwise interaction, their model recovery will be in terms of hypernetworks. We first consider the microscopic description; each oscillator is described by

or in terms of mean-fields $\dot{\psi}_{km} = \omega_{km} + {\rm Im} \left( \mu  z_{k}  + \alpha  \sum_{} A_{kl} z_{l}  \right) e^{-i \psi_{km}}$ where

is the mean-field of the subpopulation $k$. The frequencies $\omega_{km}$ are distributed according to a Lorenzian $\rho(\omega,\Omega_k,\sigma_k)$ where $\Omega_k$ is the mean subpopulation frequency and $\sigma_k$ is the frequency dispersion. Applying the Ott-Antonsen ansatz , we obtain the macroscopic equations describing the mean-fields in the limit $N\rightarrow \infty$ as

where $f_k$ is the Hopf normal form with constants $\gamma_k = (i \Omega_k +\mu - \sigma_k)$ and $\beta_k = -\mu$ and

thus, in the macroscopic description the coupling is nonlinear. We interpret $\alpha$ as a bifurcation parameter and deal with $\alpha z_l$ as a nonlinear term as in bifurcation theory. We consider the ensemble frequencies to satisfy the resonance conditions $\Omega_1 + \Omega_3 \approx 2\Omega_2$ and $\Omega_2 + \Omega_4 \approx 2\Omega_1$. At $\alpha=0$ each subpopulation will have an order parameter behaving as $z_k(t) = r_k e^{i \theta_k(t)}$ where $r_k = \sqrt{\frac{\mu- \sigma_k}{\mu}}$ and $\dot \theta_k = \Omega_k$. To obtain the phase model, we bring the network to its normal form and apply the phase reduction. In Supplementary Note 10, we perform the calculations of such resonance conditions to obtain the new normal form equations. After discarding nonresonant terms the phase equations of the mean-fields read as

$$\begin{aligned}
\label{thetaOA}
\begin{split}
\dot{\theta}_{1,3} &= \Omega_{1,3} +F_{1,3}(\varphi_1)\\ 
\dot{\theta}_{2,4} &= \Omega_{2,4} +F_{2,4}(\varphi_2)  
\end{split}
\end{aligned}$$ where $F_i$ is a linear combination of sine and cosine.

Next, we fix the ensemble frequencies as $\Omega_1 = 2, \Omega_2 = 3, \Omega_3 = 4$ and $\Omega_4 = 1$ as well as the coupling strengths $\mu=0.5$, $\sigma_k = 0.48$ yielding $r_k = 0.15$ and $\alpha=0.1$ for all subpopulations. We numerically integrate the mean-field equations and obtain the complex fields $z_1(t),z_2(t),z_3(t)$ and $z_4(t)$ which enables us to extract the phase dynamics $\theta_1(t),\theta_2(t), \theta_3(t)$ and $\theta_4(t)$. Performing a Lasso regression we recover the vector fields of Eq. () confirming the theoretical prediction of higher order interactions, see Supplementary Note 10.

<figure id="OAE">
<span class="image placeholder" data-original-image-src="mf_comms3.pdf" data-original-image-title="" width="0.6\columnwidth"></span>
<figcaption> a) The original network of coupled subpopulations (with four distinct colours, namely, red, yellow, blue and orange). Oscillators are interacting by an internal coupling constant <span class="math inline">\(\mu\)</span> and inter-subpopulations coupling constant <span class="math inline">\(\alpha\)</span>. b) Higher order phase interaction of the mean-fields represented with the same colors as in a) (red, yellow, blue and orange). Applying our approach we uncover that the phase interaction between the mean-fields is described by a hypernetwork. c) The mean-field slow phase variables <span class="math inline">\(\varphi_{1}\)</span> (green) and <span class="math inline">\(\varphi_{2}\)</span> (purple) were computed from the data collected from the simulations of mean fields on the associated network. The dashed curve is the simulation of the vector field of the slow phases <span class="math inline">\(\varphi_{1,2}\)</span> reconstructed from data using the Lasso method.</figcaption>
</figure>

As before, we introduce the slow phases

The theory predicts the higher order interaction between the slow phases as $\dot{\varphi}_k = \varepsilon_k + G_k(\varphi_1,\varphi_2)$, as shown in Supplementary Note 10. The fitting the predicted vector field of $\varphi$ to the data is excellent as can be observed in Figure c).

For these four subpopulation on a ring, the condition on the frequencies is close to the subspace

$V_{res} = \{ \Omega_1 + \Omega_3 = 2\Omega_2, \, \Omega_2 + \Omega_4 =  2\Omega_1\}\,,$ forming a co-dimension $2$ resonance surface. That is, the emergence of hypernetworks is generic in a two parameter family of frequencies.

# Discussion

We have uncovered a mechanism by which nonlinear pairwise interactions with triplet resonance conditions result in nontrivial phase dynamics on a hypernetwork. Such interactions traditionally were attributed in brain dynamics to synaptic transmission between two neurons mediated by chemical messengers from a third neuron (heterosynaptic plasticity) . Our findings provide an alternative mechanism. On one hand, this finding shows that phase dynamics can be mediated through ‘virtual’ interactions not physically present in the system. On the other hand, such a mechanism could be leveraged to design interactions between remote components not directly connected but instead having correlations in natural frequencies.

The experimental system with a generic network motif with a ring of four electrochemical oscillators presented here was an example, where a relatively simple nonlinear modulation of the coupling induced a hypernetwork driven phase dynamics. Networks with a ring topology are selected for the experiment since they are common for many network based complex systems, e.g., in lasers, biological systems, neuronal dynamics and many disciplines . Such nonlinear modulation of the coupling can be quite general in gene expressions; for example, it was used to describe the coupling among circadian cells through Michaelis-Menten mechanism where coupling from one cell modulated the maximum gene expression rate in the other .

Strikingly, we showed that the coupling resulting in mean-field coupling among network modules has sufficient nonlinearity to facilitate hypernetwork interactions. In particular, event related modulation of spectral responses of magnetoencephalogram (MEG) recordings (i.e., modulation of frequency-specific oscillations in the motor network established by a handgrip task) have shown very strong evidence for nonlinear, between-frequency coupling of remote brain regions. Our results strongly suggest that in these MEG recordings, given the appropriate resonances and nonlinearities, hypernetwork description could facilitate the long-range modulation of frequencies. In conclusion, the findings open new avenues for hypernetwork based description and engineering of complex systems with heterogeneous frequencies and nonlinear interactions.

# Methods

Our results give an algorithmic procedure for obtaining a hypernetwork that accurately describes the observed behavior of the original system. This emergent higher order system depends on details of the given network, the original coupling function and the resonance relations among the phases.

## Properties of the coupling functions $\prescript{1}{}{G}_{k}^{\ell p}$ and $\prescript{2}{}{G}_{k}^{\ell p}$

Applying the transformation of the theorem to Eq. () yields a new system of the form Eq. (). In Supplementary Note 2, we show that

In Eq. () a term of degree $d$ in $h$ and a term of degree $\tilde{d}$ in $\tilde{h}_{k \ell}$ combine to form a term of degree $d+\tilde{d} - 1$ in $\prescript{1}{}{G}_{k}^{\ell p}$. As both $h$ and $\tilde{h}_{k \ell}$ have terms of degree 2 and higher, we see that $\prescript{1}{}{G}_{k}^{\ell p}$ only has terms of degree 3 and higher. The same holds true for $\prescript{2}{}{G}_{k}^{\ell p}$, which means that a classical network description involving directed edges is no longer possible.

The third order terms are moreover easily found by replacing $h$ and $\tilde{h}_{k \ell}$ in Eq. () by their quadratic terms. Likewise, the fourth order terms are found by replacing $h$ by its quadratic terms and $\tilde{h}_{k \ell}$ by its cubic terms and vice versa in Eq. (). We may also argue that these higher order terms in $\prescript{1}{}{G}_{k}^{\ell p}$ and $\prescript{2}{}{G}_{k}^{\ell p}$ are non-vanishing in general. Indeed, the coefficients in front of these terms are rational functions of $\gamma_k$ and the coefficients of $h$. Such functions are either identical to the zero function (which Eq. () excludes) or non-vanishing on an open dense set.

New terms emerge that have an interpretation as higher-order interactions. The two double sums in Eq. () have a combinatorial interpretation. The first double sum counts all pairs of nodes $(\ell, p)$ that both influenced node $k$ in the original network. The second double sum counts all pairs $(\ell, p)$ where $\ell$ influenced $k$ and $p$ influenced $\ell$ and $p$ need not influence $k$ directly in the old network, so that new node-dependency is formed.

## An explicit algorithm for predicting the emergent hypernetwork

We present an algorithm for obtaining an emergent hypernetwork from a given network system. Its input consists of the adjacency matrix $A$, the function $h$ and the phases $\omega_1$ through $\omega_n$, and we assume the nonresonance conditions of the theorem to hold. The algorithm is as follows:

# Data Availability

We provide the experimental time-series and the extracted phases of the oscillations (Fig. ) at .

# Code availability

The source code for reconstructing the functions representing hypernetwork dynamics from oscillatory networks dynamics is available .

# Acknowledgments

We thank Sajjad Bakrani, Zachary G. Nicolaou, Marcel Novaes, Edmilson Roque, Robert Ronge and Jeroen Lamb for enlightening discussions. TP was supported in part by FAPESP Cemeai Grant No. 2013/07375-0 and is a Newton Advanced Fellow of the Royal Society NAF$\backslash$R1$\backslash$<!-- -->180236. TP and EN were partially supported by Serrapilheira Institute (Grant No. Serra-1709-16124). DE was supported by TUBITAK Grant No. 118C236 and the BAGEP Award of the Science Academy. JLO-E acknowledges financial support from CONACYT. IZK acknowledges support from National Science Foundation (grant CHE-1900011).

# Author Contributions Statement

EN and TP designed the overall study and formulated the theory. JLO-E and IZK designed and performed the experiments. DE implemented the numerical simulations and analyses. All authors contributed to the writing of the manuscript. All authors reviewed and approved the final manuscript.

# Competing Interests Statement

The authors declare no competing interests.

Supplementary Text  

<div class="center">

**Supplementary Information to  
Emergent hypernetworks in weakly coupled oscillators**  

Eddie Nijholt$^{1}$, Jorge Luis Ocampo-Espindola$^{2}$, Deniz Eroglu$^{3}$,  
István Z. Kiss$^{2}$, Tiago Pereira$^{1,4\ast}$  
   

$^1$Instituto de Ciências Matemáticas e Computação, Universidade de São Paulo, São Carlos, Brazil  
$^{2}$Department of Chemistry, Saint Louis University, St. Louis, USA

  
$^3$ Faculty of Engineering and Natural Sciences, Kadir Has University, Istanbul, Turkey  
$^4$ Department of Mathematics, Imperial College London, SW7 2AZ, London, United Kingdom

</div>

# Experimental setup and methods

In this section, we describe the details about the experimental setup, the dynamical behavior of the oscillators without coupling, the of the phase model using LASSO.

## Experimental setup

The experiments were carried out in a standard three-electrode electrochemical cell.

The cell consists of a nickel-array working electrode (W), a Pt-coated Ti rod as a counter electrode (C), and a Hg/Hg$_2$SO$_4$ sat. K$_2$SO$_4$ as a reference electrode (R). The electrolyte was a 3.0 M sulfuric acid solution at a constant temperature of 10 $^{\circ}$C. The electrode array consisted of four 1-mm diameter nickel wires embedded in epoxy with a spacing of 3 mm. A multichannel potentiostat (Gill-IK64, ACM Instruments) interfaced with a real-time LabVIEW controller measured the potential drop $[E_k(t)$, with respect to the reference electrode\] and set the circuit potential ($V_{0, k}$) of the working electrodes individually at a rate of 200 Hz. The electrode potentials are corrected for offset $o_1$=0.92 V, $o_2$=0.98 V, $o_3$= 0.91 V, and $o_4$=0.97 V.

## Behavior without coupling

The offset circuit potential to each oscillator was established 20 mV above the Hopf bifurcation ($V_{0, 1}$=1850 mV, $V_{0, 2}$=1100 mV, $V_{0, 3}$=1660 mV, $V_{0, 4}$=1103 mV). The natural frequencies \[Supplementary Fig.  (a)\] were adjusted to have values of $\omega_1$=0.152 Hz, $\omega_2$=0.385 Hz, $\omega_3$=0.237 Hz and $\omega_4$=0.384 Hz with a set of resistors and capacitors $R_{ind, 1}$=12.0 kohm, $C_{ind}$=440 $\mu$F, $R_{ind, 2}$=1.00 kohm, $R_{ind, 3}$=12.0 kohm, $R_{ind, 4}$=1.00 kohm. Without coupling, we observed that the slow oscillators (1 and 3) have about twice the amplitude than the fast oscillators (2 and 4). Supplementary Fig.  (c) shows the electrode potential time series of each oscillator.

## Phase dynamics

**Phase definition.**We used the peak-finding approach to extract the phase of each oscillator and then linear interpolation between peaks from the experimental electrode potential time series. When there is no coupling, the pairwise phase difference shows a linear growth \[Supplementary Fig..  (b)\] and the triplet phase differences, $\phi_j$, $j$=1, 2, do not show phase slip behavior \[Supplementary Fig.  (d)\].    
**Fitting of phase dynamics** As described in the main text, the impact of triplet interactions on the dynamics can be extracted with a LASSO fit to the $\dot{\theta}_k$ values according to $$\label{eq:exp}
\dot{\theta}_k = \hat{\omega}_k(t) +   \sum_{j=1}^{2} C_j^k \sin (\phi_j) 
+ D_j^k \cos (\phi_j)$$ where $\hat{\omega}_k(t) = \hat{\omega}^0_k + \hat{\omega}^1_k t + \hat{\omega}^2_k t^2$ is the fitted, slowly drifting (up to quadratic variation in time) natural frequency, and $C_j^k$ and $D_j^k$ are the amplitudes of the sin and cos phase coupling functions corresponding to the appropriate triplet phase differences.

For the fit, the instantaneous frequency, $\dot{\theta}_k$ was obtained with the numerical derivative of the phase of each oscillator from the experimental times series. The $\dot{\theta}_k$ was filtered by a first order Savitzky-Golay filter for 45 s. Using $\phi_j$, we fitted the $\dot{\theta}_k$ with LASSO method. In LASSO, the regularization parameter determines how many parameters in the fitted model should be set to zero. We used a regularization parameter so that the mean square error is 20% higher than the best fit (no regularization). The fitted parameters are:

   

<div class="center">

|                    |                          |                          |                              |                          |
|:------------------:|:------------------------:|:------------------------:|:----------------------------:|:------------------------:|
|    Coefficients    |    Oscillator number     |                          |                              |                          |
|                    |            1             |            2             |              3               |            4             |
| $\hat{\omega}_k^0$ |            0.953         |            2.368         |              1.467           |            2.383         |
| $\hat{\omega}_k^1$ |     $2.76\times 10^{-5}$ |            0             |    $-4.61\times 10^{-5}$     |            0             |
| $\hat{\omega}_k^2$ |  $-6.40\times 10^{-8}$   |  $-6.63\times 10^{-8}$   |    $-1.32\times 10^{-7}$     |            0             |
|      $C_1^k$       |     $4.89\times 10^{-3}$ |     $5.04\times 10^{-3}$ | $\,\,\,\,3.15\times 10^{-3}$ |            0             |
|      $D_1^k$       |     $9.27\times 10^{-5}$ |     $1.23\times 10^{-2}$ |    $-3.10\times 10^{-3}$     |            0             |
|      $C_2^k$       |  $-1.49\times 10^{-3}$   |            0             |       $3.16\times 10^{-3}$   |     $4.63\times 10^{-3}$ |
|      $D_2^k$       |  $-1.73\times 10^{-3}$   |            0             |    $-7.37\times 10^{-4}$     |     $1.64\times 10^{-2}$ |

Recovered coefficients from Eq. .

</div>

   

<figure id="fig:exp_set">
<span class="image placeholder" data-original-image-src="Slide2_v1.png" data-original-image-title="" width="1\columnwidth"></span>
<figcaption><span><strong>Dynamical behavior without coupling in the experiments.</strong></span> a) Natural frequency of each oscillators without coupling <span class="math inline">\(\omega_1\)</span>=0.152 Hz, <span class="math inline">\(\omega_2\)</span>=0.385 Hz, <span class="math inline">\(\omega_3\)</span>=0.237 Hz and <span class="math inline">\(\omega_4\)</span>=0.384 Hz. The blue, orange, yellow and green dots represent the elements 1 to 4 respectively. b) Time series of the phase difference with respect oscillator one. The blue line: <span class="math inline">\(\theta_1\)</span>-<span class="math inline">\(\theta_1 = 0\)</span>, orange line: <span class="math inline">\(\theta_2\)</span>-<span class="math inline">\(\theta_1\)</span>, yellow line: <span class="math inline">\(\theta_3\)</span>-<span class="math inline">\(\theta_1\)</span> and green line: <span class="math inline">\(\theta_4\)</span>-<span class="math inline">\(\theta_1\)</span>. c) Electrode potential time series. Blue, orange, yellow, and green line corresponds to oscillator one to four respectively. d) Time series of the slow phases, <span class="math inline">\(\phi_1\)</span> (blue) and <span class="math inline">\(\phi_2\)</span> (green) without coupling.</figcaption>
</figure>

# Proof of emergent higher-order networks

We consider ODEs of the general form $$\begin{aligned}
\label{theODE00}
\dot{z}_k &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha H_k(z_1, \dots, z_n) \, ,
\end{aligned}$$ for $k \in \{1, \dots, n\}$. Here, each $z_k$ takes values in $\mathbb{C}$ and $\alpha \in \mathbb{R}$ denotes the coupling parameter of the interaction. We moreover have $\beta_k, \gamma_k \in \mathbb{C}$ non-zero, and write $\gamma_k = \lambda + i\omega_k$ for all $k \in \{1, \dots, n\}$. Note that $\lambda \in \mathbb{R}$ may be seen as the bifurcation parameter for a Hopf bifurcation, which might in particular vanish. Each interaction function $H_k: \mathbb{C}^n \rightarrow \mathbb{C}$ is assumed smooth (i.e. $C^{\infty}$) for convenience, and satisfies $H_k(0) = 0$ and $DH_k(0) = 0$.  
We will show that the ODE can be put in a particular normal form that allows us to predict the dynamics of the phases of the oscillators. Our technique for doing so involves two successive coordinate transformations: $$\begin{aligned}
  w_k &= z_k - \alpha P_k(z) \\ \nonumber
  u_k &= w_k - \alpha Q_k(w)\,
\end{aligned}$$

for some appropriately chosen polynomials $P_k$ and $Q_k$. The first of these transformations is used to remove the term $\alpha H_k(z)$ from the ODE . This will generate additional terms in $\alpha^2$ that may be expressed in the coefficients of $H_k$ and $P_k$ following certain combinatorial rules. In order to describe this combinatorial behavior, we first introduce a useful bracket $[\bullet|| \bullet]$ on the space of polynomials, see Definition . The first coordinate transformation will also produce terms in $\alpha$ involving $P_k$ and $\beta_k z_k|z_k|^2$. Again our bracket allows for a precise description of these new terms, which we then remove using the second coordinate transformation. The precise bookkeeping enabled by the bracket will be crucial in determining what non-resonance conditions are needed for the second transformation. In fact, it will turn out that the non-resonance conditions needed for the first transformation are sufficient to ensure the second.  
We first present the main result, Theorem , in Subsection . There we also develop the necessary definitions, notation and machinery needed for the proof, which is then presented in the remaining subsections.

## Preliminaries and results

In order to analyse the ODE , it will be useful to write

$$H_k(z) =  {H}^d_k(z) +  \mathscr{O}(|z|^{d+1})\, ,$$ where ${H}^d_k(z)$ is a polynomial denoting the terms up to degree $d$ in the Taylor expansion of $H_k(z)$ around the origin. We will mostly work with the value $d=5$. Note that ${H}^d_k(z)$ is therefore a polynomial in both the variables $z_1, \dots, z_n$ and their complex conjugates $\overline{z}_1, \dots, \overline{z}_n$, with complex coefficients. In general, whenever we talk about a polynomial we will always mean a complex polynomial in its given complex variables and their complex conjugates. It will also be useful to write $H(z) = (H_k(z))$ for the vector valued function that captures all interaction functions $H_k(z)$ as its components, and similarly set $H^d(z) = (H^d_k(z))$.

As is often the case with normal form calculations, we will need to assume some conditions on the $\omega_k$ (or more precisely the $\gamma_k$). These will depend on the coefficients of ${H}^5_k(z)$. To this end, we define:

<div class="defi">

**Definition 1**. Let $$\begin{aligned}
    R(z) = c z_1^{s_1} \dots  z_n^{s_n} \overline{z}_1^{t_1} \dots \overline{z}_n^{t_n}\, 
\end{aligned}$$ be a monomial term in ${H}^d_k(z)$, where $c$ is a complex number and $s_1, \dots, s_n$, $t_1, \dots, t_n$ are non-negative integers. The $k$th *non-resonance condition* of $R(z)$ is the condition

$$\begin{aligned}
\label{non-resonance}
    s_1\omega_1 + \dots + s_n\omega_n - t_1\omega_1 - \dots - t_n\omega_n - \omega_k \not= 0\, .
\end{aligned}$$

Note that, as $\omega_{\ell}$ denotes the imaginary part of $\gamma_{\ell}$ for all $\ell \in \{1, \dots, n\}$, the $k$th non-resonance condition guarantees in particular that:

$$\begin{aligned}
\label{non-resonance2}
    s_1\gamma_1 + \dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k \not= 0\, ,
\end{aligned}$$

which will play a role in much of the proofs and constructions below. In fact, varying $\lambda$ and allowing the particular case $\lambda = 0$, we see that equations and are equivalent in general. Next, the $k$th *non-resonance condition* of a polynomial is defined as the union of the $k$th non-resonance conditions of all of its monomial terms. Finally, the *non-resonance condition* of a polynomial map ${H}^d(z) = ({H}^d_k(z))$ is the union over all $k \in \{1, \dots, n\}$ of the $k$th non-resonance conditions of ${H}^d_k(z)$. $\triangle$

</div>

<div class="ex">

**Example 2**. Suppose the interaction functions are given by the polynomials $$H_k(z) = \sum_{\ell=1}^n c_{k, \ell}z_k\overline{z}_\ell\, ,$$ for some (possibly weighted) connection matrix $c = (c_{k,\ell}) \in\mathbb{C}^{n \times n}$. It follows that the $k$th non-resonance condition of $H_k(z)$ is given by $$\omega_k - {\omega}_{\ell} - \omega_k = -{\omega}_{\ell} \not= 0 \quad \text{ for all } {\ell} \text{ such that } c_{k, \ell} \not= 0 \, .$$ Hence, we see that the non-resonance condition of $H(z) = (H_k(z))$ is satisfied if we simply have $\omega_{\ell} \not= 0$ for all nodes ${\ell} \in \{1, \dots, n\}$. $\triangle$

</div>

<div class="ex">

**Example 3**. Suppose the interaction functions are given by the polynomials $$H_k(z) = \sum_{\ell=1}^n c_{k, \ell}(z_k\overline{z}_\ell + z_k^2\overline{z}_{\ell})\, ,$$ for some connection matrix $c = (c_{k, \ell})$. The $k$th non-resonance condition of $H_k(z)$ is now given by $$\begin{aligned}
    \omega_k - \omega_{\ell} - \omega_k &= -\omega_{\ell} \not= 0 \quad \text { and } \\ \nonumber
   2\omega_k -\omega_{\ell} - \omega_k &= \omega_k - \omega_\ell \not= 0 
\end{aligned}$$ for all $\ell$ such that $c_{k,l} \not= 0$. If we assume for convenience that $c$ encodes a symmetric, connected graph, then the non-resonance condition of $H(z)$ is satisfied if $$\begin{aligned}
    \omega_{\ell} &\not= 0 \text{ for all nodes } \ell \in \{1, \dots, n\} \text{ and } \\ \nonumber
    \omega_{p} - \omega_q &\not= 0  \text{ for all edges } e = [p,q] \text{ between nodes } p \text{ and } q\, .
\end{aligned}$$ $\triangle$

</div>

We are now ready to formulate the main theorem. It tells us that, under the relevant non-resonance conditions, we may transform the ODE into a system with leading interaction terms involving only three-way “hyper-interactions” and with coupling constant $\alpha^2$. See Proposition for an exact description of the new leading interaction terms in Theorem .

<div class="thr">

**Theorem 4**.  * Let ${H}^5_k$ denote the fifth order Taylor expansion of the $k$th interaction function $H_k: \mathbb{C}^n \rightarrow \mathbb{C}$. Assume the non-resonance conditions for ${H}^5 = ({H}^5_k)$ to hold. Then the ODE is locally conjugate to $$\begin{aligned}
\label{transformedODE001}
\dot{u}_k &= \gamma_ku_k - \beta_k u_k|u_k|^2 - \alpha^2G_k(u) \\ \nonumber
&+ \mathscr{O}(|\alpha||u|^6 +|\alpha|^2|u|^5 + |\alpha|^3|u|^4 )\, ,
\end{aligned}$$ with $u_k \in \mathbb{C}$ and for some complex polynomials $G_k$ with only terms of degree $3$ and higher. See Proposition for an exact description of the $G_k$.*

</div>

Note that Equation gives a precise description of $\dot{u}_k$ up to sixth order in $u$ and $\alpha$.

<div class="remk">

*Remark 5*. Theorem tells us that, under the relevant non-resonance conditions, the $\alpha$-terms can be ‘pushed back’ to order $|\alpha| |u|^6$. Technically speaking, this means we can ignore these remainder terms only when $\alpha u^6 << \alpha^2 u^4$, i.e. when $u^2 << \alpha$. However, it will be clear from the proof in subsections and that if the non-resonance conditions hold for terms in $H_k$ beyond ${H}_k^5$, then we may arrange for a remainder in $\alpha$ with higher order terms in $u$. That is, we then get the remainder $\mathscr{O}(|\alpha||u|^N +|\alpha|^2|u|^5 + |\alpha|^3|u|^4 )$ for a corresponding value of $N > 6$. As the interaction functions $H_k$ are taken to be polynomials in our examples, with the non-resonance conditions holding for all terms, we in fact expect a remainder of the form $\mathscr{O}(|\alpha||u|^N +|\alpha|^2|u|^5 + |\alpha|^3|u|^4 )$ for arbitrarily high value of $N$. Hence, we may neglect all terms that are first order in $\alpha$, and obtain a new coupled system with coupling constant $\alpha^2$. $\triangle$

</div>

The new interaction functions $G_k$ can be obtained from $H$ by a combinatorial construction on the Taylor coefficients. This is best described using a bracket on polynomials that we define below. We will furthermore make extensive use of this bracket throughout the proof of Theorem .

<div class="defi">

**Definition 6**. Let $R(z)$ be a complex polynomial and let $S(z) = (S_1(z), \dots, S_n(z))$ be an $n$-tuple (i.e., a vector) of complex polynomials $S_1(z), \dots, S_n(z)$. We let $[R||S](z)$ be the complex polynomial obtained by (formally) assuming each variable $z_j$ is time-dependent (i.e., $z_j = z_j(t)$) and satisfies $\dot{z}_j =   S_j(z)$, after which we differentiate $R(z)$ with respect to $t$. That is, we set $$\begin{aligned}
(z) :=  \frac{d}{dt}R(z)\left|{\begin{array}{l}
  \dot{z}_j =   S_j(w) \\
   \forall \, j \in \\
   \{1, \dots, n\} 
\end{array}}\right.\, .
\end{aligned}$$ The reason we choose this notation, instead of one involving the Jacobian of $R$, is to avoid confusion with the complex conjugate variables $\overline{z}_j$. Because each term $\dot{\overline{z}}_j$ is substituted by $\overline{S_j(w)}$, the expression $[R||S]$ is in general not complex linear in $S$.  
In the special case where $S(z) = (\gamma_1z_1, \dots, \gamma_nz_n)$ (with $\gamma_k$ as in Equation ), we set $$\begin{aligned}
    \Gamma R(z) := [R||S](z) = \frac{d}{dt}R(z)\left|{\begin{array}{l}
  \dot{z}_j =   \gamma_jz_j \\
   \forall \, j \in \\
   \{1, \dots, n\} 
\end{array}}\right.\, .
\end{aligned}$$ $\triangle$

</div>

<div class="ex">

**Example 7**. It is not hard to see that the polynomial $\Gamma R(z)$ is obtained by replacing every monomial $$c z_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}\, ,\quad c \in \mathbb{C}$$ in $R(z)$ by $$c(s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n)z_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}\, .$$ Consider for instance the monomial $R(z) = R(z_1, z_2,\overline{z}_1, \overline{z}_2) = z_1^2\overline{z}_2$. We have $$\begin{aligned}
\frac{d}{dt}R(z) = 2z_1\dot{z}_1\overline{z}_2 + z_1^2\dot{\overline{z}}_2  \, .
\end{aligned}$$ Hence, we indeed find $$\begin{aligned}
\Gamma R(z) = \frac{d}{dt}R(z)\left|{\begin{array}{l}
  \dot{z}_1 =  \gamma_1z_1 \\
   \dot{z}_2 =  \gamma_2z_2
\end{array}}\right. &= 2z_1(\gamma_1z_1)\overline{z}_2 + z_1^2(\overline{\gamma_2z_2}) \\ \nonumber
&= (2\gamma_1 + \overline{\gamma}_2)z_1^2\overline{z}_2 =(2\gamma_1 + \overline{\gamma}_2)R(z)\, .
\end{aligned}$$$\triangle$

</div>

The term $G_k$ in Theorem will be given as the bracket $[\bullet || \bullet]$ between ${H}^5$ and a polynomial obtained by slightly modifying ${H}^5_k$. Hence, intuitively, $G_k$ should be thought of as $[H_k|| H]$. More precisely, we define:

<div class="defi">

**Definition 8**. Let $P$ be a polynomial for which its $k$th non-resonance conditions are met. The ($k$th) *modified polynomial* $\widehat{P}_{k}$ is obtained from $P$ by replacing each monomial $$c z_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}\, ,\quad c \in \mathbb{C}$$ in $P$ by $$\frac{cz_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k}\, .$$ In the special case where $P = {H}^d_k$ for some $d \leq 5$, we will simply write $\widehat{H}^d_{k} := \widehat{(H^d_k)}_{k}$ to denote the corresponding modified polynomial. $\triangle$

</div>

<div class="prop">

**Proposition 9**.  * In Theorem the terms $G_k$ are given by $$G_k = [\widehat{H}^3_{k}||{H}^3]\, .$$*

</div>

It can be shown that $[\widehat{H}^3_{k}||{H}^3]$ indeed only has terms of degree $3$ and higher, using the assumption that each $H_{k}$ (and therefore each $\widehat{H}^d_{k}$) only has terms of degree 2 and higher. See Remark below. Note that we only care about the third and fourth order terms of $G_k$, as the rest are absorbed in the remainder terms of Equation . It will be clear from Remark that these lowest order terms do not change if we instead define $$G_k = [\widehat{H}^d_{k}||{H}^d]\, ,$$ for $d=4$ or $d=5$. For this reason we will often simply write $$G_k = [\widehat{H}_{k}||{H}]\, .$$

<div class="remk">

*Remark 10*. Let $I_k \subset \{1, \dots, n\}$ denote the *input set* of a node $k \in \{1, \dots, n\}$. That is, $I_k$ denotes those nodes that influence $k$, or more precisely those nodes $\ell$ for which $$\frac{\partial H_k(z)}{\partial z_{\ell}} \not= 0 \text{ or } \frac{\partial H_k(z)}{\partial \overline{z}_{\ell}} \not= 0 \, .$$ Note that $I_k$ might not contain $k$ itself. It follows that in general $G_k(u)$ depends on variables for nodes in the set $$I^2_k := \left( \bigcup_{{\ell} \in I_k} I_{\ell}\right) \cup I_k\, .$$ This is because $G_k = [\widehat{H}^3_{k}||{H}^3]$ is formed by replacing a term $z_{\ell}$ (or $\overline{z}_{\ell}$) in $\widehat{H}^3_{k}$ by ${H}^3_{\ell}$ (or $\overline{{H}^3_{\ell}}$), and this is done for each $\ell \in I_k$. We have also used here that $\widehat{H}^3_{k}$ likewise only depends on the variables corresponding to nodes in $I_k$, or possibly a strict subset thereof.

In a similar way one sees that the third order terms of $G_k$ (that is, its leading order terms) are given by ‘triplet terms’ $\tilde{u}_r\tilde{u}_s\tilde{u}_t$, where we have $r \in I_k$ and $s,t \in I_{\ell}$ for some $\ell \in I_k$. (Here each $\tilde{u}_p$ may independently denote $u_p$ or its complex conjugate $\overline{u}_p$). See Figure for a schematic depiction of these emergent triplet terms. Of course the specifics of $H_k(z)$ might put additional constraints on the terms that can show up in $G_k(u)$. $\triangle$

</div>

<figure id="fig1">

<figcaption>Schematic depiction of the hidden ‘triplet terms’ that show up in <span class="math inline">\(G_k\)</span>.</figcaption>
</figure>

<div class="ex">

**Example 11**. As in Example , let us make the particular choice for the interaction functions $$H_k(z) = {H}_k^3(z) = \sum_{\ell = 1}^nc_{k,\ell}z_k\overline{z}_{\ell}\, .$$ Here $c = (c_{k,\ell})$ is the connectivity matrix of the network. We will assume that $c_{k,\ell} \in \{0,1\}$, or more generally $c_{k,\ell} \in \mathbb{R}$, if the network is weighted. We find $$\widehat{H}_{k}(z) = \widehat{H}^3_{k}(z) =  \sum_{\ell = 1}^n\frac{c_{k,\ell}}{\overline{\gamma}_{\ell}}z_k\overline{z}_{\ell} \, .$$ A direct calculation now shows that $$\begin{aligned}
G_k(u) = [\widehat{H}_{k}|| H](u) &= \sum_{\ell= 1}^n\frac{c_{k,\ell}}{\overline{\gamma}_{\ell}}(H_k(u)\overline{u}_{\ell} + u_k\overline{H_\ell(u)}) \\ \nonumber
&= \sum_{\ell = 1}^n\frac{c_{k, \ell}}{\overline{\gamma}_{\ell}}\left(\sum_{p = 1}^n c_{k,p} u_k \overline{u}_p\overline{u}_{\ell} + u_k\sum_{p=1}^nc_{\ell,p}\overline{u}_{\ell}u_p\right) \\ \nonumber
&= \sum_{\ell = 1}^n \sum_{p = 1}^n\frac{c_{k,\ell}c_{k,p}}{\overline{\gamma}_{\ell}} u_k \overline{u}_{\ell}\overline{u}_p + \sum_{\ell = 1}^n \sum_{p = 1}^n\frac{c_{k,\ell}c_{\ell,p}}{\overline{\gamma}_\ell} u_k\overline{u}_{\ell}u_p \, .
\end{aligned}$$ The first of these two terms counts all trees in the network that are formed by the node $k$ and two nodes that influence node $k$. The second term counts all trees formed by the nodes $k$, $\ell$ and $p$, where $k$ depends on $\ell$ and $\ell$ depends on $p$. $\triangle$

</div>

We will gather some more facts about the bracket $[\bullet || \bullet]$. One important observation is given by:

<div class="lem">

**Lemma 12**.  * The map $(R,S) \mapsto [R||S]$ is complex linear in $R$ and real linear in $S$. In other words, given polynomials $R, R'$ and complex numbers $\lambda, \mu$, we have $$= \lambda [R||S] + \mu [R'||S] \, .$$ Given tuples $S, S'$ and real numbers $a,b$ we have $$= a [R||S] + b [R||S'] \, .$$*

</div>

<div class="proof">

*Proof.* Complex linearity in $R$ is clear from the definition: $$\begin{aligned}
(z) :=  \frac{d}{dt}R(z)\left|{\begin{array}{l}
  \dot{z}_j =   S_j(w) \\
   \forall \, j \in \\
   \{1, \dots, n\} 
\end{array}}\right.\, .
\end{aligned}$$ Because of this, it suffices to show real linearity in $S$ when $R$ is given by a monomial of the form $$R(z) = z_{i_1}z_{i_2}\dots z_{i_m}\overline{z}_{j_1}\overline{z}_{j_2}\dots\overline{z}_{j_l} ,$$ for some (not necessarily distinct) $i_1, \dots, i_m, j_1, \dots, j_l \in \{1, \dots, n\}$. We get $$\begin{aligned}
\label{needlaterrron1}
    [R||S](z) = \sum_{s=1}^m\frac{R(z)}{z_{i_s}}S_{i_s}(z) + \sum_{r=1}^l\frac{R(z)}{\overline{z}_{i_r}}\overline{S_{i_r}(z)}\, ,
\end{aligned}$$ from which real linearity in $S$ follows readily. ◻

</div>

We will also make extensive use of the following definition:

<div class="defi">

**Definition 13**. Given a complex monomial $$Q(z) = c z_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}\, ,$$ where $c \in \mathbb{C}$ and with $s_1, \dots, s_n, t_1, \dots, t_n$ non-negative integers, we define the degree of $Q(z)$ as the number $s_1 + \dots + s_n + t_1 + \dots + t_n$. The degree of a polynomial $P(z)$ is then defined as the maximum of the degrees of all the monomial terms of $P(z)$, as is common. Similarly, we define the *lower degree* of a polynomial $P(z)$ as the minimum of the degrees of all of its monomial terms. $\triangle$

</div>

It turns out our bracket has a predictable effect on degrees:

<div class="lem">

**Lemma 14**.  * Let $R$ be a polynomial and $S= (S_1, \dots, S_n)$ a vector of polynomials. If $R$ has degree $p>0$ and each of the polynomial components of $S$ has degree at most $p'$, then $[R||S]$ has degree $p+p'-1$ or lower. If $R$ has lower degree $q>0$ and each of the polynomial components of $S$ has lower degree at least $q'$, then $[R||S]$ has lower degree $q+q'-1$ or higher.*

</div>

<div class="proof">

*Proof.* By linearity of the bracket (see Lemma ), it suffices to show that the degree of $[R||S]$ is $d+d'-1$ if $R$ is a monomial of degree $d$ and the components of $S$ are all monomials of degree $d'$. (By convention, we treat the zero-polynomial as a polynomial of any degree.) As in the proof of Lemma , we write $$R(z) = z_{i_1}z_{i_2}\dots z_{i_m}\overline{z}_{j_1}\overline{z}_{j_2}\dots\overline{z}_{j_l} ,$$ for some (not necessarily distinct) $i_1, \dots, i_m, j_1, \dots, j_l \in \{1, \dots, n\}$. It follows that $m+l = d$. As in the previous proof we find $$\begin{aligned}
\label{needlaterrron12}
    [R||S](z) = \sum_{s=1}^m\frac{R(z)}{z_{i_s}}S_{i_s}(z) + \sum_{r=1}^l\frac{R(z)}{\overline{z}_{i_r}}\overline{S_{i_r}(z)}\, ,
\end{aligned}$$ from which it follows readily that the degree of $[R||S]$ is indeed $d+d'-1$. This completes the proof. ◻

</div>

<div class="remk">

*Remark 15*. Lemmas and give us an easy way of finding the third and fourth order terms of $G_k = [\widehat{H}_{k}||{H}]$ (and higher terms if necessary). It follows that the third order terms of $G_k$ are given by $[\widehat{H}^2_{k}||{H}^2]$, where we use that $H$ (and therefore each $\widehat{H}^2_{k}$) has no constant and linear terms. Likewise, the fourth order terms of $G_k$ are given by the bracket between the second order terms of $\widehat{H}_{k}$ and the third order terms of $H$, plus the bracket between the third order terms of $\widehat{H}_{k}$ and the second order terms of $H$. Note also that $G_k$ need only be defined up to third and fourth order in Theorem , as higher order terms of $\alpha^2G_k(u)$ can be absorbed in the remainder $\mathscr{O}(|\alpha|^2|u|^5)$ of Equation . For this reason the terms of degree 4 and higher in $\widehat{H}_{k}$ and ${H}$ play no role in the construction of (the relevant terms of) $G_k = [\widehat{H}_{k}||{H}]$. $\triangle$

</div>

Next, we consider $G_k$ in the situation where $H_k$ describes a coupled cell system as in the examples of the main text.

<div class="remk">

*Remark 16*. Suppose each $H_k$ is of the special form $$\label{simplelinkform}
H_k(z) = \sum_{\ell=1}^nc_{k,\ell} h(z_{k}, z_{\ell})\, ,$$ where $z = (z_1, \dots, z_n)$. Here $(c_{k,\ell})$ is a real adjacency matrix and $h: \mathbb{C}^2 \rightarrow \mathbb{C}$ has vanishing constant and linear terms. It follows that we may write $$\widehat{H}_k(z) = \sum_{\ell=1}^nc_{k,\ell} \widehat{h}_{k,\ell}(z_{k}, z_{\ell})\, ,$$ where $\widehat{h}_{k,\ell}(z_k, z_{\ell})$ is obtained from $h(z_k, z_{\ell})$ by applying a monomial substitution to its terms in precisely the same way $\widehat{H}_k$ is obtained from $H_k$. By linearity of the bracket $[\bullet||\bullet]$ in the first slot, we get $$\begin{aligned}
\label{0of1G2G}
G_k = [\widehat{H}_k||{H}] = [\sum_{\ell=1}^nc_{k,\ell} \widehat{h}_{k,\ell}(u_{k}, u_{\ell})||H] = \sum_{\ell=1}^nc_{k,\ell} [\widehat{h}_{k,\ell}(u_{k}, u_{\ell})||H] \, .
\end{aligned}$$ Moreover, we find $$\begin{aligned}
\label{1of1G2G}
 [\widehat{h}_{k,\ell}(u_{k}, u_{\ell})||H](u) &= \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{k}}H_k + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{k}}\overline{H}_k + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{\ell}}H_{\ell} + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{\ell}}\overline{H}_{\ell} \\ \nonumber
 &= \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{k}}\left(\sum_{p=1}^nc_{k,p} h(u_{k}, u_p)\right) + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{k}}\left(\sum_{p=1}^nc_{k,p} \overline{h(u_{k}, u_p)}\right) \\ \nonumber 
 &+ \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{\ell}}\left(\sum_{p=1}^nc_{\ell,p} h(u_{\ell}, u_p)\right) + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{\ell}}\left(\sum_{p=1}^nc_{\ell,p} \overline{h(u_{\ell}, u_p)}\right) \\ \nonumber 
 &=\sum_{p=1}^nc_{k,p} \left( \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{k}} h(u_{k}, u_p) + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{k}} \overline{h(u_{k}, u_p)}\right) \\ \nonumber 
 &+ \sum_{p=1}^nc_{\ell,p}\left(\frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{\ell}} h(u_{\ell}, u_p) + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{\ell}} \overline{h(u_{\ell}, u_p)}\right) \\ \nonumber 
 &= \sum_{p=1}^nc_{k,p} \prescript{1}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p)+  \sum_{p=1}^nc_{\ell,p}\prescript{2}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p)\, ,
\end{aligned}$$ where we have set $$\begin{aligned}
\label{2of1G2G}
\prescript{1}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) &:= \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{k}} h(u_{k}, u_p) + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{k}} \overline{h(u_{k}, u_p)} \quad \text{ and } \\ \label{3of1G2G}
\prescript{2}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) &:= \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial u_{\ell}} h(u_{\ell}, u_p) + \frac{\partial \widehat{h}_{k,\ell}(u_{k}, u_{\ell})}{\partial \overline{u}_{\ell}} \overline{h(u_{\ell}, u_p)}\, .
\end{aligned}$$ Combining equations through , we obtain $$\begin{aligned}
\label{triangleform01}
G_k(u) = \sum_{\ell=1}^n \sum_{p=1}^n c_{k,\ell}  c_{k,p} \prescript{1}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) + \sum_{\ell=1}^n   \sum_{p=1}^n c_{k,\ell} c_{\ell,p}\prescript{2}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) \, .
\end{aligned}$$ We may interpret Equation as representing a new interaction structure, one where the interaction is now encoded through certain trees in the graph instead of links. In this regard, the emergent interaction function looks a lot like our original response function , but counting such trees instead of links. The only way in which Equation does not generalize Equation perfectly is by the fact that $\prescript{1}{}{G}_{k}^{\ell p}$ and $\prescript{1}{}{G}_{k}^{\ell p}$ have indices $k,\ell$ and $p$ (whereas ${h}$ does not). However, we see from equations and that there is no dependence on $p$; this index is only there for notational purposes. Moreover, the dependence on $k$ and $\ell$ is only through a rescaling of the monomials. Hence, we find an emergent interaction that is in very good agreement with a generalization of our original interaction to tree interaction. What is more, the trees that Equation counts are easily identified in the original graph. See Example , which describes a special case of interaction through , and the corresponding Figure 3 of the main manuscript. $\triangle$

</div>

<div class="ex">

**Example 17**. We return to Example , where the interaction functions are given by $$H_k(z) = \sum_{\ell=1}^n c_{k, \ell}(z_k\overline{z}_\ell + z_k^2\overline{z}_{\ell})\, .$$ This is of the form as discussed in Remark , with $h$ given by $$h(z_k, z_{\ell}) =  (z_k + z_k^2)\overline{z}_\ell\, .$$ Following the notation of Remark , we see that $$\widehat{h}_{k, \ell}(z_k, z_{\ell}) = \frac{z_k\overline{z}_\ell}{\overline{\gamma}_{\ell}} + \frac{z_k^2\overline{z}_{\ell}}{\gamma_k + \overline{\gamma}_{\ell}}.$$ We therefore find $$\begin{aligned}
\label{2of1G2Gal}
\prescript{1}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) &= \left(\frac{\overline{z}_\ell}{\overline{\gamma}_{\ell}} + \frac{2z_k\overline{z}_{\ell}}{\gamma_k + \overline{\gamma}_{\ell}}\right)(z_k + z_k^2)\overline{z}_p  = \frac{(z_k + z_k^2)\overline{z}_\ell \overline{z}_p}{\overline{\gamma}_{\ell}} + \frac{2(z^2_k + z_k^3)\overline{z}_{\ell}\overline{z}_p}{\gamma_k + \overline{\gamma}_{\ell}}\, , \\ \nonumber
\prescript{2}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) &= \left(\frac{z_k}{\overline{\gamma}_{\ell}} + \frac{z_k^2}{\gamma_k + \overline{\gamma}_{\ell}} \right)(\overline{z}_{\ell} + \overline{z}_{\ell}^2){z}_p =  \frac{z_k(\overline{z}_{\ell} + \overline{z}_{\ell}^2){z}_p}{\overline{\gamma}_{\ell}} + \frac{z_k^2(\overline{z}_{\ell} + \overline{z}_{\ell}^2){z}_p}{\gamma_k + \overline{\gamma}_{\ell}} \, .
\end{aligned}$$ As we may ignore terms of degree 5 and higher, we may also set $$\begin{aligned}
\label{2of1G2Gall}
\prescript{1}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) &= \frac{(z_k + z_k^2)\overline{z}_\ell \overline{z}_p}{\overline{\gamma}_{\ell}} + \frac{2z^2_k\overline{z}_{\ell}\overline{z}_p}{\gamma_k + \overline{\gamma}_{\ell}}\, , \\ \nonumber
\prescript{2}{}{G}_{k}^{\ell p}(u_k, u_{\ell}, u_p) &=  \frac{z_k(\overline{z}_{\ell} + \overline{z}_{\ell}^2){z}_p}{\overline{\gamma}_{\ell}} + \frac{z_k^2\overline{z}_{\ell}{z}_p}{\gamma_k + \overline{\gamma}_{\ell}} \, ,
\end{aligned}$$ which describe the new interaction through Equation . $\triangle$

</div>

## A coordinate transformation

In this subsection and the next ones we prove Theorem and the accompanying Proposition . Recall that we want to transform $$\begin{aligned}
\label{theODE00-1}
\dot{z}_k &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha H_k(z) \, ,
\end{aligned}$$ into an ODE where the leading interaction terms are of order $\alpha^2$. Recall as well that $H_k^5(z)$ denotes the Taylor expansion of $H_k(z)$ up to fifth order. In particular, we may write $$\begin{aligned}
\label{formofH1i}
    H_k(z) =  H^5_k(z) + \mathscr{O}(|z|^6)\, .
\end{aligned}$$

It follows that $H^5_k(z)$ is a complex polynomial of order $5$ in the variables $z_1, \dots, z_n$ and $\overline{z}_1, \dots, \overline{z}_n$. We write $z = (z_1, \dots, z_n)$, and similarly for other variables, and assume implicitly that any function of $z$ may also depend on its complex conjugate $\overline{z} = (\overline{z}_1, \dots, \overline{z}_n)$.

We start by rewriting the ODE using the transformation $$\label{expresssss1}
w_k = z_k - \alpha \widehat{H}_k^5(z) =  z_k - \alpha P_k(z)   \, ,$$ where we have set $P_k := \widehat{H}_k^5$ for convenience. Note that each $P_k: \mathbb{C}^n \rightarrow \mathbb{C}$ is a complex polynomial of lower degree $2$ (see Definition ). It follows that Expression describes an invertible transformation around $z = 0$. The following lemma deals with its inverse.

<div class="lem">

**Lemma 18**.  * Suppose the variables $w = (w_1, \dots, w_n)$ may be expressed in $z = (z_1, \dots, z_n)$ and $\alpha$ by $$\label{expressss10}
w_k = z_k - \alpha P_k(z) \, ,$$ for some polynomials $P_k$ of lower degree $d \geq 2$. Then $z$ can be expressed in $w$ and $\alpha$ by the formal expression $$\label{expressss20}
z_k = w_k+ \alpha P_k(w) + \alpha^2 R_{k,2}(w) + \alpha^3 R_{k,3}(w) + \dots \, .$$ Here the $R_{k,t}(w)$ are polynomials with lower degree $(d-1)t+1$ or higher.*

</div>

<div class="proof">

*Proof.* We write $$\label{expressssss200}
z_k = R_{k,0}(w) + \alpha R_{k,1}(w) + \alpha^2R_{k,2}(w)+\dots\, ,$$ for some functions $R_{k,t}(w):\mathbb{C}^n \rightarrow \mathbb{C}$. To determine these functions, we substitute the $z$ variables in Equation by Expression . We obtain $$\begin{aligned}
\label{winzab0}
w_k &= z_k - \alpha P_k(z_1, \dots, z_n) \\ \nonumber
&=  [R_{k,0}(w) + \alpha R_{k,1}(w) + \dots]  - \alpha P_k([R_{1,0}(w) + \alpha R_{1,1}(w) + \dots],  \dots, [R_{n,0}(w) + \alpha R_{n,1}(w) + \dots])\, .
\end{aligned}$$ Comparing constant terms in $\alpha$ (i.e. $\alpha^0$), Expression gives us $$w_k = R_{k,0}(w)\, .$$ This simplifies Equation to $$\begin{aligned}
\label{winzab20}
w_k &= [w_k + \alpha R_{k,1}(w) + \dots]  
- \alpha P_k([w_1 + \alpha R_{1,1}(w) + \dots], \dots, [w_n + \alpha R_{n,1}(w) + \dots])\, .
\end{aligned}$$ Comparing $\alpha$-terms now yields $$0 = R_{k,1}(w) - P_k(w)\, ,$$ so that $$R_{k,1}(w) = P_k(w)\, .$$ It remains to show that the higher order terms are indeed polynomials of the required lower degree. We will show this by induction on $t$. Note that $R_{k,0}(w) = w_k$ has (lower) degree $(d-1)0 +1 = 1$. Likewise, $R_{k,1}(w) = P_k(w)$ is of lower degree $(d-1)1 +1 = d$. We therefore fix an integer $T > 1$ and assume that the function $R_{k,t}(w)$ is a complex polynomial of lower degree $(d-1)t +1$ or higher for all $t<T$ and $k \in \{1, \dots, n\}$. The $\alpha^T$ terms in Equation are given by $$\begin{aligned}
\label{compaarq0}
0 &= R_{k,T}(w) - [\alpha^{T-1}]P_k([w_1 + \alpha R_{1,1}(w) + \dots], \dots, [w_n + \alpha R_{n,1}(w) + \dots])\,.
\end{aligned}$$ Here $[\alpha^{T-1}]F(\alpha)$ denotes the $\alpha^{T-1}$ term in the expansion of a function $F$ in $\alpha$. As $P_k$ is a polynomial of lower degree $d$, the $\alpha^{T-1}$ term in $$P_k([w_1 + \alpha R_{1,1}(w) + \dots], \dots, [w_n + \alpha R_{n,1}(w) + \dots])$$ must be a finite sum of scalar multiples of expressions of the form $$\tilde{R}_{i_1,t_1}(w)\tilde{R}_{i_2,t_2}(w) \dots \tilde{R}_{i_s,t_s}(w) \, ,$$ for $s \geq d$ and for some $i_1, \dots, i_s \in \{1, \dots, n\}$ and $t_1, \dots, t_s \in \mathbb{Z}_{\geq 0}$ satisfying $t_1 + \dots + t_s = T-1$. Each term $\tilde{R}_{i_j,t_j}(w)$ may furthermore independently denote ${R}_{i_j,t_j}(w)$ or its complex conjugate $\overline{R_{i_j,t_j}(w)}$. As we have $t_1 + \dots + t_s = T-1$, it in particular holds that $t_1, \dots, t_s \leq T-1$. By the induction hypothesis, we therefore know that each of the terms $\tilde{R}_{i_j,t_j}$ is a polynomial of lower degree $(d-1)t_j + 1$ or higher. This means the expression $$\tilde{R}_{i_1,t_1}(w)\tilde{R}_{i_2,t_2}(w) \dots \tilde{R}_{i_s,t_s}(w) \,$$ is a polynomial of lower degree $D$ satisfying $$\begin{aligned}
  D &\geq  [(d-1)t_1 + 1] + [(d-1)t_2 + 1] + \dots + [(d-1)t_s + 1] \nonumber \\ \nonumber
    &= (d-1)(t_1 + t_2 + \dots + t_s) + s \\ \nonumber
    &= (d-1)(T-1) + s \geq  (d-1)(T-1) + d   \\ \nonumber
    &=(d-1)T + 1 \, .
\end{aligned}$$ It follows from Equation that $R_{k,T}(w)$ is indeed a polynomial of lower degree $(d-1)T + 1$ or higher for all $k \in \{1, \dots, n\}$. This proves the lemma by induction. ◻

</div>

Setting $d=2$, it follows that the inverse of Equation is given by $$\label{expresssss10}
z_k = w_k + \alpha P_k(w) + \mathscr{O}(|\alpha|^2|w|^3) \, .$$ At some point later on, we will need to know Expression up to higher order terms. To this end, we will show how our bracket $[\bullet|| \bullet]$ from Definition shows up when performing coordinate transformations.

<div class="lem">

**Lemma 19**.  * Let $R(z)$ be a complex polynomial and suppose we may express the $z$-variables in some new $w$-variables by $$\label{plugin234}
    z_k = w_k + \alpha S_k(w) + \mathscr{O}(|\alpha|^2) \, , \quad k \in \{1, \dots, n\} \, .$$ Here each $S_k$ is a complex polynomial and we have $\alpha \in \mathbb{R}$. Then $R(z)$ is given in the $w$-variables by $$\label{transfff123}
R(z) = R(w) + \alpha[R||S](w) +  \mathscr{O}(|\alpha|^2) \, ,$$ where we have set $S = (S_1, \dots, S_n)$.*

</div>

<div class="proof">

*Proof.* We write $R(z)$ as $$R(z) = T_0(w) + \alpha T_1(w) +  \mathscr{O}(|\alpha|^2) \, ,$$ where $T_0(w)$ and $T_1(w)$ are to be determined. Assume first that $R(z)$ is given by $$R(z) = z_{i_1}z_{i_2}\dots z_{i_m}\overline{z}_{j_1}\overline{z}_{j_2}\dots\overline{z}_{j_l} ,$$ for some (not necessarily distinct) $i_1, \dots, i_m, j_1, \dots, j_l \in \{1, \dots, n\}$. We get $$\begin{aligned}
    R(z) &= z_{i_1}\dots z_{i_m}\overline{z}_{j_1}\dots\overline{z}_{j_l} \\ \nonumber
    &= (w_{i_1}+\alpha S_{i_1}(w))\dots (w_{i_m}+\alpha S_{i_m}(w)) \overline{(w_{j_1}+\alpha S_{j_1}(w))}\dots\overline{(w_{j_l}+\alpha S_{j_l}(w))} + \mathscr{O}(|\alpha|^2) \\ \nonumber
    &= w_{i_1}\dots w_{i_m}\overline{w}_{j_1}\dots\overline{w}_{j_l} + \alpha \left( \sum_{s=1}^m\frac{R(w)}{w_{i_s}}S_{i_s}(w) + \sum_{r=1}^l\frac{R(w)}{\overline{w}_{i_r}}\overline{S_{i_r}(w)} \right) + \mathscr{O}(|\alpha|^2) \\ \nonumber
    &= R(w) + \alpha [R||S](w) + \mathscr{O}(|\alpha|^2)\, ,
\end{aligned}$$ where in the last line we have used Expression from the proof of Lemma . As $T_0$ and $T_1$ are determined linearly by $R$, we may conclude from Lemma that $T_0(w) = R(w)$ and $T_1(w) = [R||S](w)$ for general polynomials $R$. This completes the proof. ◻

</div>

<div class="ex">

**Example 20**. Suppose we are given the polynomial $Q(z) = Q(z_1, z_2, \overline{z}_1, \overline{z}_2) = z_1^2 + z_1\overline{z}_2$. Equation gives $$\begin{aligned}
 Q(z) &=    (w_1 + \alpha S_1(w) + \mathscr{O}(|\alpha|^2))^2 + (w_1 + \alpha S_1(w) + \mathscr{O}(|\alpha|^2)\overline{(w_2 + \alpha S_2(w) + \mathscr{O}(|\alpha|^2))} \\ \nonumber
 &=    (w_1 + \alpha S_1(w))^2 + (w_1 + \alpha S_1(w))(\overline{w}_2 + \alpha \overline{S_2(w)}) + \mathscr{O}(|\alpha|^2) \\ \nonumber
 &= w_1^2 + w_1\overline{w}_2 + \alpha(2w_1S_1(w) + w_1\overline{S_2(w)} + S_1(w)\overline{w}_2) + \mathscr{O}(|\alpha|^2) \\ \nonumber
 &= Q(w) + \alpha \frac{d}{dt} Q(w)\left|{\begin{array}{l}
  \dot{w}_1 =   S_1(w) \\
  \dot{w}_2 =   S_2(w) 
\end{array}}\right. + \mathscr{O}(|\alpha|^2) \\ \nonumber
 &= Q(w) + \alpha[Q||S](w) + \mathscr{O}(|\alpha|^2)\,  ,
\end{aligned}$$ which is in accordance with Lemma . $\triangle$

</div>

Returning to the transformation with inverse Equation , we may in fact conclude the following:

<div class="lem">

**Lemma 21**.  * Suppose we have a coordinate transformation of the form $$\label{expresssss01}
w_k = z_k - \alpha P_k(z) \, ,$$ where each $P_k: \mathbb{C}^n \rightarrow \mathbb{C}$ is a complex polynomial of lower degree $2$ or higher. The inverse transformation is given by $$\label{expresssss122}
z_k = w_k + \alpha P_k(w) + \alpha^2 [P_k||P](w) + \mathscr{O}(|\alpha|^3|w|^4)\, ,$$ where $P = (P_1, \dots, P_n)$.*

</div>

<div class="proof">

*Proof.* It follows from Lemma that we may write $$\label{expresssss1223}
z_k = w_k + \alpha P_k(w) + \alpha^2 R_{k,2}(w) + \mathscr{O}(|\alpha|^3|w|^4)\, ,$$ for some function $R_{k,2}(w)$. Hence, we only have to show that $R_{k,2}(w) = [P_k||P](w)$. To this end, we rewrite Expression as $$\label{expresssss01inv}
z_k = w_k + \alpha P_k(z) \, .$$ Next, we use Equation to write $$\label{expresssss12234}
z_k = w_k + \alpha P_k(w) + \mathscr{O}(|\alpha|^2)\, .$$ Applying Lemma to the term $P_k(z)$ and the transformation yields $$\begin{aligned}
    P_k(z) = P_k(w) + \alpha [P_k||P](w) + \mathscr{O}(|\alpha|^2)\, .
\end{aligned}$$ Combined with Equation , we obtain $$\begin{aligned}
\label{expresssss01inv1}
z_k &= w_k + \alpha (P_k(w) + \alpha [P_k||P](w) + \mathscr{O}(|\alpha|^2)) \\ \nonumber
&= w_k + \alpha P_k(w) + \alpha^2 [P_k||P](w) + \mathscr{O}(|\alpha|^3)\, .
\end{aligned}$$ Comparing the two expressions and for $z_k$, we see that indeed $$\label{expresssss122w}
z_k = w_k + \alpha P_k(w) + \alpha^2 [P_k||P](w) + \mathscr{O}(|\alpha|^3|w|^4)\, .$$ This proves the lemma. ◻

</div>

Our next step is to differentiate Equation with respect to time. This gives us $$\begin{aligned}
\label{calcu0001}
\dot{w}_k = \dot{z}_k - \alpha \frac{d}{d t}P_k(z) \, .
\end{aligned}$$ We will first focus on the term $$\label{ddtpkzxx} 
\frac{d}{d t}P_k(z)\, ,$$ and then deal with the term $\dot{z}_k$.  

#### The term $\partial_tP_k$

We first focus on the term . We start by rewriting Equation as $$\begin{aligned}
\label{theODE00c}
\dot{z}_k   &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha H_k(z) \\ \nonumber
            &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha{H}^5_k(z)  + \mathscr{O}(|\alpha||z|^6)\, ,
\end{aligned}$$ where we recall that ${H}^5_k(z)$ denotes the Taylor expansion of $H_k(z)$ up to fifth order. From Equation and Lemma we get $$\begin{aligned}
\label{part1of1}
\frac{d}{dt}P_k(z) &= \frac{d}{dt}P_k(z)\left|{\begin{array}{l}
  \dot{z}_j =  \gamma_jz_j - \beta_j z_j|z_j|^2 + \alpha {H}_j(z)\\
   \forall \, j \in 
   \{1, \dots, n\} \\
\end{array}}\right. \\ \nonumber
&= \frac{d}{dt}P_k(z)\left|{\begin{array}{l}
  \dot{z}_j =  \gamma_jz_j - \beta_j z_j|z_j|^2 + \alpha {H}^5_j(z)\\
   \forall \, j \in 
   \{1, \dots, n\} \\
\end{array}}\right. + \quad \mathscr{O}(|\alpha||z|^7) \\ \nonumber
&= [P_k||(\dots, \gamma_jz_j - \beta_j z_j|z_j|^2 + \alpha {H}^5_j(z), \dots)](z) + \mathscr{O}(|\alpha||z|^7) \\ \nonumber
&= [P_k||(\dots, \gamma_jz_j, \dots)](z) -[P_k|| (\dots, \beta_j z_j|z_j|^2, \dots)](z) \\ \nonumber
&+ \alpha [P_k|| (\dots, {H}^5_j(z), \dots)](z) + \mathscr{O}(|\alpha||z|^7) \\ \nonumber
&= \Gamma P_k(z) - L^1_k(z) + \alpha [P_k|| {H}^5](z) + \mathscr{O}(|\alpha||z|^7) \, ,
\end{aligned}$$ where we have set $$L^1_k(z) :=  [P_k|| (\dots, \beta_j z_j|z_j|^2, \dots)](z)$$ and $${H}^5 := (\dots, {H}^5_j(z), \dots) \, .$$ We have moreover used that $P_k(z)$ has lower degree at least $2$ to arrive at the remainder term $\mathscr{O}(|\alpha||z|^7)$, and we refer to Definition for the meaning of the term $\Gamma P_k(z)$. Note that $L^1_k(z)$ is a polynomial of lower degree at least $4$, whereas $[P_k|| {H}^5](z)$ has lower degree $3$ or higher.

Next, we return to Equation , which we recall states $$\label{replacccs}
z_k = w_k + \alpha P_k(w) + \mathscr{O}(|\alpha|^2|w|^3) =  w_k  + \mathscr{O}(|\alpha||w|^2)  \, .$$ We obtain $$\begin{aligned}
\label{part2of1}
    L^1_k(z) &= L^1_k(w) + \mathscr{O}(|\alpha||w|^5) \\ \label{part2of1b}
    [P_k|| {H}^5](z) &= [P_k|| {H}^5](w) + \mathscr{O}(|\alpha||w|^4) \, .
\end{aligned}$$ From Lemma we furthermore get $$\begin{aligned}
\label{part3of1}
    \Gamma P_k(z) &= \Gamma P_k(w) + \alpha [\Gamma P_k||P](w) + \mathscr{O}(|\alpha|^2|w|^4) \, ,
\end{aligned}$$ where we have set $P = (P_1, \dots, P_n)$. The remainder term in Equation follows from the lower degrees of $\Gamma P_k(z)$ and $P_k(z)$, and the remainder in Equation .

Note that $[\Gamma P_k||P](w)$ is a polynomial of lower degree $3$ or higher. Combining equations , , and , we arrive at:

<div class="lem">

**Lemma 22**.  * The term $$\frac{d}{dt}P_k(z)$$ may be expressed in the new $w$ coordinates by $$\begin{aligned}
\frac{d}{dt}P_k(z) &=  \Gamma P_k(z) - L^1_k(z) + \alpha [P_k|| {H}^5](z) + \mathscr{O}(|\alpha||z|^7) \\ \nonumber
&=  \Gamma P_k(w) - L^1_k(w) + \alpha [P_k|| {H}^5](w) + \alpha [\Gamma P_k||P](w) + \mathscr{O}(|\alpha||w|^5 + |\alpha|^2|w|^4)\, .
\end{aligned}$$*

</div>

#### The term $\dot{z}_k$

Next, we focus on the term $\dot{z}_k$. Again we write. $$\begin{aligned}
\dot{z}_k   &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha H_k(z) \\ \nonumber
            &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha H_k^5(z) + \mathscr{O}(|\alpha||z|^6)\, ,
\end{aligned}$$ where ${H}^5_k(z)$ denotes the Taylor expansion of $H_k(z)$ up to fifth order.

Recall the result of Lemma , which tells us that $$\label{expresssss1225}
z_k = w_k + \alpha P_k(w) + \alpha^2 [P_k||P](w) + \mathscr{O}(|\alpha|^3|w|^4)\, .$$ Combined, and using Lemma , we get $$\begin{aligned}
\label{part2aa}
    \dot{z}_k &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha {H}^5_k(z) + \mathscr{O}(|\alpha||z|^6) \\ \nonumber
    &= \gamma_k(w_k + \alpha P_k(w) + \alpha^2 [P_k||P](w)) + \mathscr{O}(|\alpha|^3|w|^4) \\ \nonumber
    &- \beta_k w_k|w_k|^2 -  \alpha [\beta_k w_k |w_k|^2|| P](w) + \mathscr{O}(|\alpha|^2|w|^5) \\ \nonumber
    &+ \alpha {H}^5_k(w) +\alpha^2[{H}^5_k|| P](w) + \mathscr{O}(|\alpha|^3|w|^4) \\ \nonumber
& + \mathscr{O}(|\alpha||w|^6) \\ \nonumber
&= \gamma_kw_k - \beta_k w_k|w_k|^2 + \alpha(\gamma_kP_k(w) + {H}^5_k(w)) - \alpha [\beta_k w_k |w_k|^2|| P](w) \\ \nonumber
&+ \alpha^2(\gamma_k[P_k||P](w) + [{H}^5_k|| P](w))  + \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4)\, .
\end{aligned}$$ We will write $$\begin{aligned}
   L^2_k(w) :=  [\beta_k w_k |w_k|^2|| P](w)\, ,
\end{aligned}$$ which has lower degree $4$ or higher, to arrive at:

<div class="lem">

**Lemma 23**.  * The term $\dot{z}_k$ may be expressed in the new $w$ coordinates by $$\begin{aligned}
\label{part2tt}
    \dot{z}_k &= \gamma_kw_k - \beta_k w_k|w_k|^2 \\ \nonumber
    &+  \alpha(\gamma_kP_k(w) + {H}^5_k(w))  - \alpha L^2_k(w) \\ \nonumber
  &+ \alpha^2(\gamma_k[P_k||P](w) + [{H}^5_k|| P](w)) \\ \nonumber
& + \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4)\, .
\end{aligned}$$*

</div>

## The first reduction

We may now substitute the results of Lemma and Lemma into $$\begin{aligned}
\dot{w}_i = \dot{z}_i - \alpha \frac{d}{d t}P_i(z) \, .
\end{aligned}$$ We obtain $$\begin{aligned}
\label{expandedff1}
\dot{w}_k &=  \gamma_kw_k - \beta_k w_k|w_k|^2 \\ \nonumber
    &+  \alpha(\gamma_kP_k(w) + {H}^5_k(w))  - \alpha L^2_k(w) \\ \nonumber
  &+ \alpha^2(\gamma_k[P_k||P](w) + [{H}^5_k|| P](w)) \\ \nonumber
& + \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4)\\ \nonumber
& - \alpha(\Gamma P_k(w) - L^1_k(w) + \alpha [P_k|| {H}^5](w) + \alpha [\Gamma P_k||P](w)) \\ \nonumber
&=  \gamma_kw_k - \beta_k w_k|w_k|^2 \\ \nonumber
&+  \alpha(\gamma_kP_k(w) + {H}^5_k(w) - \Gamma P_k(w)) + \alpha(L^1_k(w) - L^2_k(w)) \\ \nonumber
&+ \alpha^2(\gamma_k[P_k||P](w) + [{H}^5_k|| P](w) - [P_k|| {H}^5](w) - [\Gamma P_k||P](w)) \\ \nonumber
&+ \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4)\, . 
\end{aligned}$$ By Lemma we may further write this as $$\begin{aligned}
\label{expandedff2}
\dot{w}_k &=  \gamma_kw_k - \beta_k w_k|w_k|^2 \\ \nonumber
&+  \alpha(\gamma_kP_k(w) + {H}^5_k(w) - \Gamma P_k(w)) + \alpha(L^1_k(w) - L^2_k(w)) \\ \nonumber
&+ \alpha^2[\gamma_kP_k + {H}^5_k - \Gamma P_k||P](w)  - \alpha^2[P_k|| {H}^5](w)  \\ \nonumber
&+ \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4)\, . 
\end{aligned}$$ Next, we claim that our choice of polynomial $P_k = \widehat{H}^5_k$ guarantees that the term $$\label{solveforalpha}\gamma_kP_k + {H}^5_k - \Gamma P_k$$ vanishes. More precisely, we prove:

<div class="lem">

**Lemma 24**.  * Let $Q$ be a polynomial for which the $k$th non-resonance condition is satisfied. In particular, it follows that the corresponding modified polynomial $\widehat{Q}_k$ is well-defined. We then have $$\begin{aligned}
\label{solveforalpha}\gamma_k\widehat{Q}_k + Q - \Gamma \widehat{Q}_k = 0\,.
\end{aligned}$$*

</div>

<div class="proof">

*Proof.* By definitions and , we see that it suffices to show this when $Q$ is given by a single monomial $$Q(z) =  z_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}\, ,$$ where $t_1, \dots, t_n, s_1, \dots, s_n$ are non-negative integers. More precisely, we use here that the maps $Q \mapsto \widehat{Q}_k$ and $Q \mapsto \Gamma Q = [Q||\dots ,\gamma_jz_j, \dots]$ are complex linear, when defined. By Definition we find $$\widehat{Q}_k(z) = \frac{z_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k} = \frac{Q(z)}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k}\, .$$ Example now tells us that $$\begin{aligned}
\Gamma\widehat{Q}_k(z) &= \frac{(s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n)z_1^{s_1}\dots  z_n^{s_n} \overline{z}_1^{t_1}  \dots  \overline{z}_n^{t_n}}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k} \\ \nonumber
&= \frac{(s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n)Q(z)}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k}\, .
\end{aligned}$$ We therefore conclude that $$\begin{aligned}
\Gamma\widehat{Q}_k(z) - \gamma_k\widehat{Q}_k(z)&= \frac{(s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n)Q(z)}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k} \\ \nonumber
&- \frac{\gamma_kQ(z)}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k} \\ \nonumber
&=  \frac{(s_1\gamma_1 + \dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k)Q(z)}{s_1\gamma_1 +\dots + s_n\gamma_n + t_1\overline{\gamma}_1 + \dots + t_n\overline{\gamma}_n - \gamma_k}  = Q(z) \, .
\end{aligned}$$ Thus, we precisely find $$\begin{aligned}
\gamma_k\widehat{Q}_k + Q - \Gamma \widehat{Q}_k = - (\Gamma \widehat{Q}_k - \gamma_k\widehat{Q}_k) + Q = -Q + Q = 0\, ,
\end{aligned}$$ which completes the proof. ◻

</div>

As we have used the shorthand notation $\widehat{H}_k^5 := \widehat{({H^5_k})}_k$, we see that indeed $$\begin{aligned}
\gamma_kP_k + {H}^5_k - \Gamma P_k = \gamma_k\widehat{H}_k^5 + {H}^5_k - \Gamma \widehat{H}_k^5 = 0\, .
\end{aligned}$$ Returning to Equation , we find that it simplifies to $$\begin{aligned}
\label{expandedff3}
\dot{w}_k &=  \gamma_kw_k - \beta_k w_k|w_k|^2 + \alpha(L^1_k(w) - L^2_k(w))  - \alpha^2[P_k|| {H}^5](w)  \\ \nonumber
&+ \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4)\, , 
\end{aligned}$$

where we recall that $L^1_k$ and $L^2_k$ are defined as $$\begin{aligned}
L^1_k(w) &:=  [P_k|| (\dots, \beta w_j|w_j|^2, \dots)](w) \text{ and }\\ \nonumber
L^2_k(w) &:=  [\beta_k w_k |w_k|^2|| P](w)\, ,
\end{aligned}$$ which are both polynomials of lower degree $4$ or higher.

## The second reduction

Next, we wish to get rid of the term $\alpha(L^1_k(w) - L^2_k(w))$ in Equation . This follows along the same lines as in the previous reduction. We start by defining new variables $$u_k = w_k - \alpha Q_k(w)\,$$ where each $Q_k$ is a polynomial of lower degree $4$ or higher. Note that by Lemma we may write $$\label{invssofw}
    w_k = u_k + \alpha Q_k(u) + \mathscr{O}(|\alpha|^2|u|^7)\, .$$ Using Equation we obtain $$\begin{aligned}
    \dot{u}_k &= \dot{w}_k - \alpha \frac{d}{dt}Q_k(w)\left|{\begin{array}{l}
  \dot{w}_j =  \gamma_jw_j\\
   \forall \, j \in 
   \{1, \dots, n\} \\
\end{array}}\right. + \quad \mathscr{O}(|\alpha||w|^6) \\ \nonumber
&= \dot{w}_k - \alpha\Gamma Q_k(w) + \mathscr{O}(|\alpha||w|^6) \\ \nonumber
&= \gamma_kw_k - \beta_k w_k|w_k|^2 +\alpha(L^1_k(w) - L^2_k(w))  - \alpha^2[P_k|| {H}^5](w) - \alpha\Gamma Q_k(w) \\ \nonumber
&+ \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4) \, .
\end{aligned}$$ Next, substituting $w_k$ by the right hand side of Equation yields $$\begin{aligned}
\label{equationalmostthere345}
 \dot{u}_k &= \gamma_kw_k - \beta_k w_k|w_k|^2 +\alpha(L^1_k(w) - L^2_k(w))  - \alpha^2[P_k|| {H}^5](w) - \alpha\Gamma Q_k(w) \\ \nonumber
&+ \mathscr{O}(|\alpha||w|^6 + |\alpha|^2|w|^5 + |\alpha|^3|w|^4) \\ \nonumber
&= \gamma_ku_k + \alpha\gamma_kQ_k(u)- \beta_k u_k|u_k|^2 +\alpha(L^1_k(u) - L^2_k(u))  - \alpha^2[P_k|| {H}^5](u) - \alpha\Gamma Q_k(u) \\ \nonumber
&+ \mathscr{O}(|\alpha||u|^6 + |\alpha|^2|u|^5 + |\alpha|^3|u|^4) \\ \nonumber
&= \gamma_ku_k - \beta_k u_k|u_k|^2 +\alpha(L^1_k(u) - L^2_k(u)+ \gamma_kQ_k(u) - \Gamma Q_k(u) )  - \alpha^2[P_k|| {H}^5](u) \\ \nonumber
&+ \mathscr{O}(|\alpha||u|^6 + |\alpha|^2|u|^5 + |\alpha|^3|u|^4)  \, .
\end{aligned}$$ It remains to choose $Q_k$ such that $$\label{tosolve283}
L^1_k(u) - L^2_k(u)+ \gamma_kQ_k(u) - \Gamma Q_k(u) = 0\, .$$ Setting $S_k(u) := L^1_k(u) - L^2_k(u)$, Equation becomes $$\begin{aligned}
\label{solveforalpha2}
\gamma_kQ_k + S_k - \Gamma Q_k = 0\, ,
\end{aligned}$$ which is of the same form as Equation . It therefore follows from Lemma that a solution to Equation is given by $Q_k = \widehat{S}_k := \widehat{(S_k)}_k$, if indeed this is well-defined. The following lemmas show that the non-resonance conditions of $H_k^5$ are enough to ensure $\widehat{S}_k$ exists.

<div class="lem">

**Lemma 25**.  * The polynomial $S_k(u) = L^1_k(u) - L^2_k(u)$ may be expressed as the sum of terms $u_k^2\overline{R(u)}$ and $|u_j|^2R(u)$ for $j \in \{1, \dots, n\}$ and with $R(u)$ a monomial term appearing in $P_k(u)$.*

</div>

<div class="proof">

*Proof.* We start with $L^2_k(u)$. By definition, we have $$\begin{aligned}
    L^2_k(u) &=  [\beta_k u_k |u_k|^2|| P](u) = 2\beta_k u_k\overline{u}_kP_k(u) + \beta_k u_k^2\overline{P_k(u)} \\ \nonumber
    &=  2\beta_k |u_k|^2P_k(u) + \beta_k u_k^2\overline{P_k(u)}\, .
\end{aligned}$$ As $P_k(u)$ may be expressed as the sum of monomials that appear in $P_k(u)$ (tautologically), we see that $L^2_k(u)$ can indeed be written as the sum of terms $u_k^2\overline{R(u)}$ and $|u_j|^2R(u)$, with $R(u)$ a monomial appearing in $P_k(u)$.  
Next, recall that $L^1_k(u)$ is defined as $$L^1_k(u) :=  [P_k|| (\dots, \beta_j u_j|u_j|^2, \dots)](u)\, .$$ By definition of the bracket $[\bullet|| \bullet]$, this means $L^1_k(u)$ is obtained from $P_k$ by substituting terms $u_j$ by $\beta_j u_j|u_j|^2$ and terms $\overline{u}_j$ by $\overline{\beta_j u_j|u_j|^2} = \overline{\beta_j u_j}|u_j|^2$. More precisely, if $R(u)$ is a monomial term of $P_k(u)$ given by $$\begin{aligned}
    R(u) = u_1^{s_1}\dots  u_n^{s_n} \overline{u}_1^{t_1} \dots \overline{u}_n^{t_n}\, ,
\end{aligned}$$ then we find $$\begin{aligned}
    &[R(u)|| (\dots, \beta_j u_j|u_j|^2, \dots)](u)\\ \nonumber
    = &\sum_{j=1}^n s_j u_1^{s_1} \dots   u_j^{s_j-1}(\beta_j u_j|u_j|^2)  \dots  u_n^{s_n} \overline{u}_1^{t_1} \dots \overline{u}_n^{t_n} 
    + \sum_{j=1}^n t_j u_1^{s_1} \dots  u_n^{s_n} \overline{u}_1^{t_1} \dots    \overline{u}_j^{t_j-1}\overline{(\beta_j u_j|u_j|^2)}  \dots  \overline{u}_n^{t_n} \\ \nonumber
     = &\sum_{j=1}^n s_j\beta_j |u_j|^2 u_1^{s_1} \dots   u_j^{s_j}  \dots  u_n^{s_n} \overline{u}_1^{t_1} \dots \overline{u}_n^{t_n}    + \sum_{j=1}^n t_j \overline{\beta}_j|u_j|^2 u_1^{s_1} \dots  u_n^{s_n} \overline{u}_1^{t_1} \dots    \overline{u}_j^{t_j}  \dots  \overline{u}_n^{t_n} \\ \nonumber
    = &\sum_{j=1}^n s_j\beta_j |u_j|^2 R(u)
    + \sum_{j=1}^n t_j \overline{\beta}_j|u_j|^2 R(u) \, .
\end{aligned}$$ Hence, by linearity of $[\bullet|| \bullet]$ in the first slot (see Lemma ), we see that $L^1_k(u)$ is again of the right form.  
It follows that $S_k(u) = L^1_k(u) - L^2_k(u)$ can indeed be expressed as a sum of the given monomials terms. This completes the proof. ◻

</div>

<div class="lem">

**Lemma 26**.  * Let $R(u)$ be a monomial and let $k,j \in \{1, \dots, n\}$ be fixed indices. The $k$th non-resonance condition of $R(u)$ is satisfied if and only if the $k$th non-resonance condition of $|u_j|^2R(u)$ is satisfied, if and only if the $k$th non-resonance condition of $u_k^2\overline{R(u)}$ is satisfied.*

</div>

<div class="proof">

*Proof.* We write $$\begin{aligned}
    R(u) = u_1^{s_1}\dots u_n^{s_n} \overline{u}_1^{t_1} \dots \overline{u}_n^{t_n}\, ,
\end{aligned}$$ so that the $k$th non-resonance condition of $R(u)$ is given by $$\begin{aligned}
\label{oricompareq}
   s_1\omega_1 + \dots + {s_n}\omega_n - t_1 \omega_1 - \dots - {t_n} \omega_n - \omega_k \not= 0\, .
\end{aligned}$$ It follows that the $k$th non-resonance condition of $|u_j|^2R(u)$ is given by $$\begin{aligned}
  \omega_j - \omega_j + &s_1\omega_1 + \dots + {s_n}\omega_n - t_1 \omega_1 - \dots - {t_n} \omega_n - \omega_k \\ \nonumber
  = &s_1\omega_1 + \dots + {s_n}\omega_n - t_1 \omega_1 - \dots - {t_n} \omega_n - \omega_k\not= 0\, ,
\end{aligned}$$ which coincides with that of $R(u)$.  
Likewise, the $k$th non-resonance condition of $u_k^2\overline{R(u)}$ is given by $$\begin{aligned}
  &2\omega_k - s_1\omega_1 - \dots - {s_n}\omega_n + t_1 \omega_1 + \dots + {t_n} \omega_n - \omega_k \\ \nonumber
 =  - &s_1\omega_1 - \dots - {s_n}\omega_n + t_1 \omega_1 + \dots + {t_n} \omega_n + \omega_k \\ \nonumber
  =  - &(s_1\omega_1 + \dots + {s_n}\omega_n - t_1 \omega_1 - \dots - {t_n} \omega_n - \omega_k) \not= 0\, ,
\end{aligned}$$ which is again equivalent to Equation . This completes the proof. ◻

</div>

Lemmas and guarantee that the $k$th non-resonance condition of $S_k(u) = L^1_k(u) - L^2_k(u)$ is satisfied if the $k$th non-resonance condition of $P_k = \widehat{H}^5_k$ is satisfied. As $\widehat{H}^5_k$ has the same monomial terms as $H^5_k$ (though rescaled), we see that the $k$th non-resonance conditions of $S_k(u)$ are indeed satisfied. Therefore, a solution to Equation exists by Lemma and may be given by $Q_k = \widehat{S}_k$. Note that this choice of $Q_k$ has lower degree $4$ or higher, as we assumed throughout.

Returning to Equation , we finally arrive at $$\begin{aligned}
\label{thethetheequation}
 \dot{u}_k = \gamma_ku_k - \beta_k u_k|u_k|^2  - \alpha^2[P_k|| {H}^5](u) + \mathscr{O}(|\alpha||u|^6 + |\alpha|^2|u|^5 + |\alpha|^3|u|^4)  \, .
\end{aligned}$$ We have therefore shown:

<div class="proof">

*Proof of Theorem and Proposition .* The calculations in this section show that the successive coordinate transformations $$\begin{aligned}
  w_k &= z_k - \alpha P_k(z) \\ \nonumber
  u_k &= w_k - \alpha Q_k(w)\,
\end{aligned}$$ bring the ODE $$\dot{z}_k = \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha H_k(z)$$ into the form $$\dot{u}_k = \gamma_ku_k - \beta_k u_k|u_k|^2  - \alpha^2[P_k|| {H}^5](u) + \mathscr{O}(|\alpha||u|^6 + |\alpha|^2|u|^5 + |\alpha|^3|u|^4)  \, .$$ If we now set $$G_k(u) := [P_k|| {H}^5] = [\widehat{H}^5_k|| {H}^5]\, ,$$ then we indeed get $$\dot{u}_k = \gamma_ku_k - \beta_k u_k|u_k|^2  - \alpha^2G_k(u) + \mathscr{O}(|\alpha||u|^6 + |\alpha|^2|u|^5 + |\alpha|^3|u|^4)  \, .$$ This completes the proof. ◻

</div>

# Anomalous synchronization on a 4-node ring

Consider the four node ring network with a coupling function $h(z,w) = z \bar w.$ leading to $$\begin{aligned}
\label{example1_ode}
\dot{z}_1 &= \gamma_1z_1 - \beta z_1|z_1|^2 + \alpha (z_1\overline{z}_2 + z_1\overline{z}_4 )\\ \nonumber
\dot{z}_2 &= \gamma_2z_2 - \beta z_2|z_2|^2 + \alpha (z_2\overline{z}_3 + z_2\overline{z}_1 ) \\ \nonumber 
\dot{z}_3 &= \gamma_3z_3 - \beta z_3|z_3|^2 + \alpha (z_3\overline{z}_4 + z_3\overline{z}_2 ) \\ \nonumber
\dot{z}_4 &= \gamma_4z_4 - \beta z_4|z_4|^2 + \alpha (z_4\overline{z}_1 + z_4\overline{z}_3 ) \, 
\end{aligned}$$

We set the parameters $\beta_k = -1$, $\gamma_k = \lambda + i \omega_k$, $\lambda = 1$ and $\omega_1 = 1+ \delta$, $\omega_2 = 1$ and $\omega_3 = 5$ and $\omega_4 = 6$ for performing the simulation of Eq. (). We then vary the mismatch $\delta$ and coupling $\alpha$. Notice that by a naive inspection of the original equations we obtain $$\dot \theta_k = \omega_k + \alpha \sum_{\ell=1}^4 
A_{k \ell} \sin \theta_{\ell}$$ thus, instead of a diffusive interaction we would obtain a interaction akin to forcing . For each set of $\alpha$ and $\delta$ values, we simulate the network for 50000s with 0.01 time step. We remove first 10000s from as transient and compute the unwrapped phases. As we are interested in the phase synchronization, we introduce a new variable for the phase differences, $\phi = \theta_1-\theta_2$, and a naive calculation leads to $$\dot \phi = \delta + \alpha[ \sin \theta_2 + \sin \theta_4 - \sin \theta_1 - \sin \theta_3]  + O(\alpha^2).$$ Because $\omega_2,\omega_3 \ll \omega_1$, we can average over the fast oscillations and neglect contributions from these phases then $\theta_2 = \theta_1 + \phi$ we would obtain a interaction term as $\alpha [\sin \theta_1 \cos \phi + \cos \theta_1 \sin \phi] + O(\alpha^2),$ however, since $\theta_1$ is a fast variable for $\phi$ we also average over $\theta_1$. Thus the whole interaction term linear in $\alpha$ vanishes.

We calculate the mean synchronization error as $$\begin{aligned}
\label{reconstructed_md}
E = \frac{1}{T} \sum_{t=1}^T |\phi(t)|.
\end{aligned}$$ The synchronization error for varying $\delta = -0.2$ to $0.2$ with $0.01$ step size and $\alpha = 0.0$ to $0.5$ with step size $0.025$, we observed a synchronization tongue scales with $\alpha \propto \sqrt{\delta}$ (Supplementary Fig. ).

<figure id="fig:sync_tongue">
<span class="image placeholder" data-original-image-src="sync_tongue_v2.pdf" data-original-image-title="" width="0.5\columnwidth"></span>
<figcaption><span><strong>Arnold tongue represents the phase synchronization between nodes 1 and 2</strong></span>. The tongue is illustrated for varying mismatch <span class="math inline">\(\delta\)</span> and coupling strength <span class="math inline">\(\alpha\)</span>. As the absolute value of <span class="math inline">\(|\delta| \ll 1\)</span>, synchronization occurs for small coupling strength. However, if the mismatch is high then also stronger coupling is needed to emerge synchronization. The borderline between synchrony and asynchrony scales with <span class="math inline">\(\alpha \propto \sqrt{\delta}\)</span>.</figcaption>
</figure>

## Explanation of anomalous synchronization via normal form theory

Recall that we may bring this ODE into the form $$\begin{aligned}
\label{repeattt1}
\dot{u}_1 &= \gamma_1u_1 - \beta u_1|u_1|^2 \\ \nonumber
&- \alpha^2 u_1 \left(\frac{\overline{u}_2\overline{u}_4}{\overline{\gamma}_2} + \frac{\overline{u}_4\overline{u}_2}{\overline{\gamma}_4} + \frac{\overline{u}_2\overline{u}_2}{\overline{\gamma}_2} + \frac{\overline{u}_4\overline{u}_4}{\overline{\gamma}_4} + \frac{\overline{u}_2u_3}{\overline{\gamma}_2} + \frac{\overline{u}_2u_1}{\overline{\gamma}_2} + 
\frac{\overline{u}_4u_3}{\overline{\gamma}_4} +
\frac{\overline{u}_4u_1}{\overline{\gamma}_4} \right) + \text{h.o.t.}\\ \nonumber
\dot{u}_2 &= \gamma_2u_2 - \beta u_2|u_2|^2 \\ \nonumber
&- \alpha^2 u_2 \left(\frac{\overline{u}_1\overline{u}_3}{\overline{\gamma}_1} + \frac{\overline{u}_3\overline{u}_1}{\overline{\gamma}_3} + \frac{\overline{u}_1\overline{u}_1}{\overline{\gamma}_1} + \frac{\overline{u}_3\overline{u}_3}{\overline{\gamma}_3} + \frac{\overline{u}_3u_4}{\overline{\gamma}_3} + \frac{\overline{u}_3u_2}{\overline{\gamma}_3} + 
\frac{\overline{u}_1u_4}{\overline{\gamma}_1} +
\frac{\overline{u}_1u_2}{\overline{\gamma}_1} \right) + \text{h.o.t.}\\ \nonumber
\dot{u}_3 &= \gamma_3u_3 - \beta u_3|u_3|^2 \\ \nonumber
&- \alpha^2 u_3 \left(\frac{\overline{u}_2\overline{u}_4}{\overline{\gamma}_2} + \frac{\overline{u}_4\overline{u}_2}{\overline{\gamma}_4} + \frac{\overline{u}_2\overline{u}_2}{\overline{\gamma}_2} + \frac{\overline{u}_4\overline{u}_4}{\overline{\gamma}_4} + \frac{\overline{u}_2u_3}{\overline{\gamma}_2} + \frac{\overline{u}_2u_1}{\overline{\gamma}_2} + 
\frac{\overline{u}_4u_3}{\overline{\gamma}_4} +
\frac{\overline{u}_4u_1}{\overline{\gamma}_4} \right) + \text{h.o.t.}\\ \nonumber
\dot{u}_4 &= \gamma_4u_4 - \beta u_4|u_4|^2 \\ \nonumber
&- \alpha^2 u_4 \left(\frac{\overline{u}_1\overline{u}_3}{\overline{\gamma}_1} + \frac{\overline{u}_3\overline{u}_1}{\overline{\gamma}_3} + \frac{\overline{u}_1\overline{u}_1}{\overline{\gamma}_1} + \frac{\overline{u}_3\overline{u}_3}{\overline{\gamma}_3} + \frac{\overline{u}_3u_4}{\overline{\gamma}_3} + \frac{\overline{u}_3u_2}{\overline{\gamma}_3} + 
\frac{\overline{u}_1u_4}{\overline{\gamma}_1} +
\frac{\overline{u}_1u_2}{\overline{\gamma}_1} \right) + \text{h.o.t.} 
\end{aligned}$$ We will assume that $\gamma_1 \approx \gamma_2$. In particular, we consider the possibility that $\gamma_1 = \gamma_2$. In that case we have $\gamma_1 + \overline{\gamma_2} = 2\mathop{\mathrm{Re}}(\gamma_1)$, which may be arbitrarily small. Therefore, we may not assume that $\gamma_1 + \overline{\gamma_2} \not= 0$. Other than this, there are no relevant restrictions. I.e., $\gamma_1, \dots, \gamma_4, \gamma_2 - \overline{\gamma_3} \dots \gamma_3 - \overline{\gamma_4}$ are all sufficiently large. It follows that we may bring equation into the form $$\begin{aligned}
\label{repeattt2}
\dot{v}_1 &= \gamma_1v_1 - \beta v_1|v_1|^2 - \epsilon\frac{v_1\overline{v}_2v_1}{\overline{\gamma}_2}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_2 &= \gamma_2v_2 - \beta v_2|v_2|^2 - \epsilon\frac{v_2\overline{v}_1v_2}{\overline{\gamma}_1}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_3 &= \gamma_3v_3 - \beta v_3|v_3|^2 - \epsilon\frac{v_3\overline{v}_2v_1}{\overline{\gamma}_2}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_4 &= \gamma_4v_4 - \beta v_4|v_4|^2 - \epsilon\frac{v_4\overline{v}_1v_2}{\overline{\gamma}_1}  + \mathscr{O}(|\epsilon, v|^5)\, ,
\end{aligned}$$ where $\epsilon = \alpha^2$. Note that the network topology has changed drastically. Moreover, performing a phase reduction and introducing the phase difference $\psi = \theta_1 - \theta_2$ we obtain

$$\dot \psi = \delta - c \alpha^2 \sin \psi$$

where $c$ is a constant depending on $\gamma_1$. By analyzing the fixed points of this equation we obtain the synchronization tongue behavior where the critical coupling $\alpha_c$ for synchronization scales as $\sqrt{\delta}$.

# Phase reduction for $h = (z^2 +  z) \bar w$ and resonance $\omega_1 - \omega_{2,4} + \omega_3 = 0$

For simplicity we fix $\beta_k = -1$ and obtain $\gamma_k = r_0^2 + i \omega_k.$ We also introduce $\Delta_{pq} = \omega_p - \omega_q$. Note that $r(t) = r_0 + h.o.t$ along with $\bar z \dot z = i r_0^2 \dot \theta +h.o.t.$ and $$\begin{aligned}
\frac{1}{\gamma_p + \bar \gamma_q} &=& \frac{2r_0^2 - i \Delta_{pq}}{4 r_0^4 + \Delta_{pq}^2}
\end{aligned}$$ Replacing these observations into Eq. (6) of the main manuscript and performing the reduction we obtain the functions in Eq. (7-8) of the main manuscript as

$$\begin{aligned}
\rho_{pq}(\phi)  &=& - \frac{\Delta_{pq}}{4 r_0^4 + \Delta_{pq}^2} \cos \phi +  \frac{2r_0^2}{4 r_0^4 + \Delta_{pq}^2} \sin \phi \nonumber \\
\sigma_{pqr}(\phi) &=& - \chi_{pqr} \sin \phi + \upsilon_{pqr} \cos \phi \nonumber \\
\end{aligned}$$

where $$\chi_{pqr} = r_0^2 \left( \frac{4}{4 r_0^4 +  \Delta_{pq}^2} 
+ \frac{4}{4 r_0^4 +  \Delta_{pr}^2} 
+ \frac{1}{r_0^4 + \omega_q^2} 
+ \frac{1}{r_0^4 + \omega_r^2} \right)$$ and $$\upsilon_{pqr} =  - \frac{ 2\Delta_{pq}}{4 r_0^4 +  \Delta_{pq}^2} 
- \frac{2 \Delta_{pr}}{4 r_0^4 +  \Delta_{pr}^2} 
+ \frac{\omega_q}{r_0^4 + \omega_q^2} 
+ \frac{\omega_r}{r_0^4 + \omega_r^2}$$

# Slow phase dynamics for $h = (z^2 +  z) \bar w$ and resonance $\omega_1 - \omega_{2,4} + \omega_3 = 0$

We consider networks of $n$ coupled oscillators $$\label{Eq1}
\dot{z}_k = f_k(z_k) + \alpha \sum_{\ell=1}^n A_{k\ell} h_k(z_k, z_{\ell})$$ where $z_k \in \mathbb{C}$ is the state of the $k$th oscillator, $f_k :  \mathbb{C} \rightarrow  \mathbb{C}$ is its isolated vector field, $h_k:  \mathbb{C} \times  \mathbb{C} \rightarrow  \mathbb{C}$ is the pairwise coupling function, $\bm A = ( A_{ij})_{i,j=1}^n$ is the adjacency matrix describing the network structure, and $\alpha > 0$ is the coupling strength. We then generate a multivariate time series for a four-node ring network, as illustrated in Figure  (a), with nonlinear pairwise coupling function $$\label{degree3}
h(z,w) = (z + z^2) \bar w.$$

<figure id="fig:networks">
<span class="image placeholder" data-original-image-src="model_illustration2.pdf" data-original-image-title="" width=".60\columnwidth"></span>
<figcaption><span><strong>Emergent hypernetworks with triplet interactions.</strong></span> (a) The original ring network. (b) Hypernetwork recovered from original dynamics data. The state of a given node is influenced by triplet interactions. We show that as along as some sparsity is imposed when the model is obtained from data, only hypernetworks can be found. Our theory predicts the emergence of the hypernetwork determined by the original coupling function <span class="math inline">\(h\)</span>, the network, and the resonance relations among the isolated frequencies.</figcaption>
</figure>

We fix $\lambda = 0.15$, $\omega_1 = 1.01$, $\omega_2 = 2.5$, $\omega_3 = 1.5$, $\omega_4 = 2.49$, and $\alpha = 0.18$. Numerical integration of complex differential equations is used to solve the differential equations for 10000-sec with 0.01-sec time-step. We discard the first 5000-sec points as transient, and we obtain a multivariate time series $\{ z_1(t), z_2(t), z_3(t),z_4(t)  \}_{t=1}^{5000}$.

Next, we aim at obtaining a model from the multivariate time series of $z$. Because $\alpha$ is small and the isolated orbit is exponentially stable, the amplitude of each time series is slightly affected by $|z_k| \approx \sqrt{\lambda} + O(\alpha)$ as illustrated in Figure.  (a), and the dynamics is captured by the phases $\theta_k(t)$ of $z_k(t)$. Therefore, we perform a polar decomposition $z_k(t) = r_k(t) e^{i \theta_k(t)}$ to get the unwrapped phase of each time series and obtain governing equations of the model from its phase dynamics.

Each phase $\theta_k$ has a frequency close to $\omega_k$, as illustrated in Figure  (b). This means that the growth of the phases is almost linear with coupling terms as perturbations. In fact, the coupling terms generically contain fast variables such as phases $\theta$’s and slow variables involving the resonant combinations of phases such as $\theta_1 - \theta_2  + \theta_3$ that change slowly in time. Therefore, we subtract the linear growth of the phases to analyse the effects of the coupling. To this end, we introduce $$\label{new_phases}
\vartheta_k(t) = \theta_k(t) - \Omega_k t,$$ where $\Omega_k$ is obtained from data under the resonance condition $\Omega_1 -  \Omega_{i} +  \Omega_3 = 0$, with $i = 2,4$. In the new phases the coupling has the same magnitude as the frequency mismatch $\omega_1 - \omega_i + \omega_3$, with $i=2,4$. Finally, we obtain a model for $\vartheta_k$. We assume the model $$\dot \vartheta_k = \varepsilon_k + H_k(\vartheta_1, \vartheta_2,\vartheta_3,\vartheta_4)$$ where $H_k = \sum [ c^k_p \sin \vartheta_p + d_p^k \cos \vartheta_p ]  + \sum [ c^k_{p,q} \sin (\vartheta_p - \vartheta_q) + d^k_{p,q} \cos (\vartheta_p - \vartheta_q ] 
+ \sum [ c^{k}_{pq} \sin (\vartheta_p + \vartheta_q - \vartheta_k) + d^{k}_{pq} \cos (\vartheta_p + \vartheta_q - \vartheta_k)]$. Note that this includes pairwise and triplet interactions. We solve for the coefficients to obtain the least square approximation and we impose sparsity by eliminating coefficients below a threshold $\tau = 10^{-4}$. The technique is discussed along with the package to perform the recovery as discussed in the main text. The model recovery yields $$\begin{aligned}
\label{recovered_eq}
\dot{\vartheta}_{1,3} &=& \varepsilon_{1,3} + r_{1,3}(\vartheta_1,\vartheta_2,\vartheta_3) + s_{1,3}(\vartheta_1,\vartheta_4, \vartheta_3) \\
\dot{\vartheta}_{2,4} &=&  \varepsilon_{2,4} + r_{2,4}(\vartheta_1,\vartheta_{2,4},\vartheta_3) \nonumber
\end{aligned}$$ where $s$ and $r$ correspond to triplets in $H_k$ with nonzero coefficients.

At first sight, the model recovery with triplets is remarkable because the original equations have only pairwise interactions. Nonetheless, a hypernetwork describes the data Figure  (b). We show that when $\lambda \ll1$ and $\alpha \ll 1$ recovering a hypernetwork from data is not a coincidence. As long as the coupling $h$ is nonlinear, by measuring the original variables of Eq. () and performing a sparse model recovery only hypernetworks can be found as they are normal forms of the original equations.

<figure id="fig:4nodes_phi_1">
<span class="image placeholder" data-original-image-src="4nodes_new_v6.pdf" data-original-image-title="" width="0.5\columnwidth"></span>
<figcaption><span><strong>Time series and emergent hypernetwork prediction.</strong></span> The simulation was performed on a ring network (see Supplementary Fig. <span class="math inline">\(\ref{fig:networks}\)</span> (a)). (a) Amplitudes (solid lines) are slightly affected by the coupling and remaining close to a circle with radius <span class="math inline">\(r = \sqrt{\lambda}\)</span> (dashed circle). (b) Unwrapped phases <span class="math inline">\(\theta_i\)</span> growth. (c) Time series of the slow phase <span class="math inline">\(\phi_1\)</span> from data (solid) and the prediction of the emergent hypernetwork (dashed) capturing higher-order interactions (see Supplementary Fig. <span class="math inline">\(\ref{fig:networks}\)</span> (b)). </figcaption>
</figure>

## Emergent hypernetwork predicts data behaviour

To illustrate prediction capabilities of emergent hypernetworks, we introduce the slow phases $$\begin{aligned}
\label{slow_phases}
\phi_1 &=& \theta_1  - \theta_2 + \theta_3,\\ \nonumber
\phi_2 &=& \theta_1 - \theta_4 + \theta_3,
\end{aligned}$$ where the coupling strength is comparable to the frequency mismatch $\omega_1 - \omega_2 + \omega_3$. Our normal form theory predicts the emergent hypernetwork phase dynamics described in Eq. (15). We obtain the vector fields of the coupled slow phases $\phi_1$ and $\phi_2$ analytically as described in the section above.

Next, we simulate the vector fields obtained from first principles using an adaptative Runge-Kutta method of 4th order. We treat the initial condition as unknown and perform a optimization to obtain the the initial condition that provides the minimum least square error between the data of the slow phase and the simulations and theory. In Figure c), we compare our predictions and slow phases estimated from data. The theoretical prediction is in excellent agreement with the data with an error in the prediction of less than $5\%$ per cycle of the slow phase.

# Model recovery of a 3-path with coupling $h = (z^2 +  z)  \bar w$ and resonance $\omega_1 - \omega_2 + \omega_3 = 0$

Now we consider the model for 3-nodes on a chain (Supplementary Fig. ) that reads as We consider the network ODE $$\begin{aligned}
\label{path}
\dot{z}_1 &= \gamma_1z_1 - \beta z_1|z_1|^2 + \alpha (z_1\overline{z_2} + z_1^2\overline{z_2} )\\ \nonumber
\dot{z}_2 &= \gamma_2z_2 - \beta z_2|z_2|^2 + \alpha ([z_2\overline{z_1} + z_2^2\overline{z_1} ] + [z_2\overline{z_3} + z_2^2\overline{z_3} ])\\ \nonumber
\dot{z}_3 &= \gamma_3z_3 - \beta z_3|z_3|^2 + \alpha (z_3\overline{z_2} + z_3^2\overline{z_2} ) \,  ,
\end{aligned}$$

<figure id="fig:3nodes">
<span class="image placeholder" data-original-image-src="3nodes_network" data-original-image-title="" width="0.8\columnwidth"></span>
<figcaption><span><strong>Emergent hypernetworks with triplet interaction.</strong></span> Inset a) shows the original chain network. Each isolated node dynamics is close to a Hopf bifurcation. The pairwise coupling function <span class="math inline">\(h\)</span> is nonlinear given with <span class="math inline">\(h = (z^2 + \bar z)w\)</span>. Inset b) shows the hypernetwork learnt from the phase dynamics data of the original dynamics. The state of a given node is influenced by the triple interaction of its own state in combination of the incoming links. Our theory also predicts the emergent of such hypernetwork. The hypernetwork emerges as a combination of the original coupling function <span class="math inline">\(h\)</span>, the network, and the resonance relations of the isolated frequencies.</figcaption>
</figure>

To integrate Eq. () of the main manuscript for 3-node chain with $\omega_1 = 1.01$, $\omega_2 = 2.5$ and $\omega_3 = 1.5$, we employed a wrapper of ODEPACK routine. Numerical integration for $\alpha = 0.18$ and $\delta = 0.01$ was performed for 10000s with 0.01 time step. We discard the first 5000s points as transient. Using the simulated phases $\theta_i$, we introduce new phases in Eq. (3) of the main manuscript where $\Omega_1 = 1.0$, $\Omega_2 = 2.5$, $\Omega_3 =  1.5$. Applying the sequential thresholded least-squares method on these new phases $\vartheta_i$ with thresholding parameter $\lambda = 10^{-4}$ we obtain

$$\begin{aligned}
\dot{\vartheta}_1 &= \,\,\,\,\,\,\,\,0.01 - 0.001\cos(\vartheta_1 - \vartheta_2 + \vartheta_3) \\
\dot{\vartheta}_2 &= -0.001  + 0.005 \cos(\vartheta_1 - \vartheta_2 + \vartheta_3) \\
\dot{\vartheta}_3 &= -0.001 - 0.001 \cos(\vartheta_1 - \vartheta_2 + \vartheta_3) 
\end{aligned}$$

Because the norms of the functions $r_k$ and $s_k$ are small, we introduce the slow phases $$\begin{aligned}
\label{new_phi}
\phi &=& \theta_1  - \theta_2 + \theta_3 \nonumber
\end{aligned}$$

We then also perform a reconstruction for the slow phases $\phi$ using the same method and obtain

$$\begin{aligned}
\label{eq:3nodes_recon}
\dot{\phi} = 0.010+ 0.001\sin(\phi) - 0.006\cos(\phi) 
\end{aligned}$$

We show the model prediction and data for the slow phase in Figure .

<figure id="fig:3nodes_phi">
<span class="image placeholder" data-original-image-src="3nodes_triplet_phi.pdf" data-original-image-title="" width="0.5\columnwidth"></span>
<figcaption> New slow phase variable <span class="math inline">\(\phi\)</span> (blue curve) were computed from the data collected from the simulations of Eq. (1) on a path. Then Eq. <span class="math inline">\(\ref{eq:3nodes_recon}\)</span> (orange dashed curve) reconstructed from data of <span class="math inline">\(\phi\)</span> using sequential thresholded least squares method.</figcaption>
</figure>

## Emergent network explanation

The normal-form for this system is given by $$\begin{aligned}
\dot{u}_1 &= \gamma_1u_1 - \beta u_1|u_1|^2 - \alpha^2 \left(\frac{1}{\gamma_1 + \overline{\gamma}_2}\right)u_1^2\overline{u}_2u_3\\ \nonumber
\dot{u}_2 &= \gamma_2u_2 - \beta u_2|u_2|^2 -  \alpha^2 \left(\frac{2}{\gamma_2 + \overline{\gamma}_3} + \frac{2}{\gamma_2 + \overline{\gamma}_1} + \frac{1}{\overline{\gamma}_3} + \frac{1}{\overline{\gamma}_1}\right)u_2^2\overline{u}_1\overline{u}_3\\ \nonumber
\dot{u}_3 &= \gamma_3u_3 - \beta u_3|u_3|^2 -  \alpha^2 \left(\frac{1}{\gamma_3 + \overline{\gamma}_2}\right)u_3^2\overline{u}_2u_1\,  .
\end{aligned}$$ The interaction now becomes forth order in $u$. A phase reduction leads to the triplet interaction recovered numerically.

# 6 nodes network examples with $h(z,w) = z \bar w$

We consider the network presented in Figure a) with the coupling $h(z,w) = z \bar w$ leading to

<figure id="fig:networks6n">
<span class="image placeholder" data-original-image-src="6nodes_network.pdf" data-original-image-title="" width="0.65\columnwidth"></span>
<figcaption><span><strong>Emergent hypernetworks with triplet interaction.</strong></span> Inset a) shows the original network. Each isolated node dynamics is close to a Hopf bifurcation. The pairwise coupling function <span class="math inline">\(h(z,w) = z \bar w\)</span>. Inset b) shows the hypernetwork reconstructed from the phase dynamics of the original dynamics. The state of a given node is influenced by the triple interaction of its own state in combination of the incoming links. Our theory also predicts the emergent of such hypernetwork. The hypernetwork emerges as a combination of the original coupling function <span class="math inline">\(h(z,w) = z \bar w.\)</span>, the network, and the resonance relations of the isolated frequencies.</figcaption>
</figure>

$$\begin{aligned}
\label{exxx2}
\dot{z}_1 &= \gamma_1z_1 - \beta z_1|z_1|^2 + \alpha (z_1\overline{z}_2 + z_1\overline{z}_3 +  z_1\overline{z}_4)\\ \nonumber
\dot{z}_2 &= \gamma_2z_2 - \beta z_2|z_2|^2 + \alpha (z_2\overline{z}_1 + z_2\overline{z}_3 +  z_2\overline{z}_5)\\ \nonumber
\dot{z}_3 &= \gamma_3z_3 - \beta z_3|z_3|^2 + \alpha (z_3\overline{z}_1 + z_3\overline{z}_2 +  z_3\overline{z}_6)\\ \nonumber
\dot{z}_4 &= \gamma_4z_4 - \beta z_4|z_4|^2 + \alpha (z_4\overline{z}_5 + z_4\overline{z}_6 +  z_4\overline{z}_1)\\ \nonumber
\dot{z}_5 &= \gamma_5z_5 - \beta z_5|z_5|^2 + \alpha (z_5\overline{z}_4 + z_5\overline{z}_6 +  z_5\overline{z}_2)\\ \nonumber
\dot{z}_6 &= \gamma_6z_6 - \beta z_6|z_6|^2 + \alpha (z_6\overline{z}_4 + z_6\overline{z}_5 +  z_6\overline{z}_3)\, .
\end{aligned}$$ We will assume either one of

1.  $\gamma_2 \approx \gamma_5$, $\gamma_1 \approx \gamma_6$ and $\gamma_3 \approx \gamma_4$, with $\gamma_1 \not\approx \gamma_2$ (and hence $\gamma_1, \gamma_6 \not\approx \gamma_2, \gamma_5$), $\gamma_2 \not\approx \gamma_3$ and $\gamma_1 \not\approx \gamma_3$.

2.  $\gamma_2 \approx \gamma_5$ and $\gamma_i \not\approx \gamma_j$ for all $i,j \in \{1, \dots, 6\}$ with $i \not= j$ and $(i,j) \not= (2,5), (5,2)$.

In each case, we may transform ODE into $$\begin{aligned}
\label{transform2}
\dot{v}_1 &= \gamma_1v_1 - \beta v_1|v_1|^2 - \epsilon\frac{v_1\overline{v}_2v_5}{\overline{\gamma}_2}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_2 &= \gamma_2v_2 - \beta v_2|v_2|^2 - \epsilon\frac{v_2\overline{v}_5v_2}{\overline{\gamma}_5}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_3 &= \gamma_3v_3 - \beta v_3|v_3|^2 - \epsilon\frac{v_3\overline{v}_2v_5}{\overline{\gamma}_2}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_4 &= \gamma_4v_4 - \beta v_4|v_4|^2 - \epsilon\frac{v_4\overline{v}_5v_2}{\overline{\gamma}_5}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_5 &= \gamma_5v_5 - \beta v_5|v_5|^2 - \epsilon\frac{v_5\overline{v}_2v_5}{\overline{\gamma}_2}  + \mathscr{O}(|\epsilon, v|^5)\\ \nonumber
\dot{v}_6 &= \gamma_6v_6 - \beta v_6|v_6|^2 - \epsilon\frac{v_6\overline{v}_5v_2}{\overline{\gamma}_5}  + \mathscr{O}(|\epsilon, v|^5)\, ,
\end{aligned}$$ where $\epsilon = \alpha^2$ leading to the emergent higher order network displayed in Figure b).

# Model recovery and normal form representation

Let $x\in \mathbb{R}^m$ and consider

$$\begin{aligned}
\label{Rx}
\dot x &=& F(x)  
\end{aligned}$$

We assume for simplicity that $F: \mathbb{R}^m \rightarrow \mathbb{R}^m$ is a polynomial map and

$$\begin{aligned}
\label{Rx}
\dot x_i&=& \sum_{j=1}^k a_{i j} p_j(x),
\end{aligned}$$

where $x_i$ is the $i$th coordinate of $x$ and $p_j$’s form a basis of homogeneous polynomials. Notice that in a network context, $x\in \mathbb{R}^m$ would represent the state vector of the network and $F$ would model isolated dynamics and interactions. Once a trajectory $x(t)$ and $\dot x(t)$ are known, we perform a model recovery as follows. Fix a sampling $h$ and introduce

$$V = \left(
\begin{array}{cccc}
\dot x_1(0) & \dot x_2(0) & \dots & \dot x_m(0)\\
\dot x_1(h) & \dot x_2(h) & \dots & \dot x_m(h)\\
\vdots & \vdots& \ddots & \vdots \\
\dot x_1(T) & \dot x_2(T) & \dots & \dot x_m(T)\\
\end{array}
\right) \mbox{~ ~ and ~ ~} 
X = \left(
\begin{array}{cccc}
 x_1 (0) & x_2 (0)& \dots & x_m (0)\\
 x_1 (h) & x_2 (h)& \dots & x_m (h)\\
\vdots & \vdots& \ddots & \vdots \\
x_1 (T) & x_2 (T)& \dots & x_m (T)\\
\end{array}
\right)$$

along with

$$\Phi(X) =
\left(
\begin{array}{cccc}
p_1(x(0))      & p_2(x(0)) & \cdots & p_k(x(0)) \\
p_1(x(h))      & p_2(x(h)) & \cdots & p_k(x(h)) \\
\vdots & \vdots & \ddots & \vdots \\ 
p_1(x(T))      & p_2(x(T)) & \cdots & p_k(x(T)) \\
\end{array}
\right) \nonumber$$

Let $v_i$ be the $i$th column of $V$ and $\xi_i = (a_{i1}, a_{i2}, \dots, a_{ik})^*$. Here, $^*$ denotes the transpose. Then by construction

$$\label{fund}
\Phi (X) \xi_i = v_i$$ and if for large $T$ the operator $\Phi$ is full rank the solution of Eq. () is unique. Solving this equation for all coordinates, we recover the differential equation.

In data, however, due to numerical round-off errors or noise Eq. () is perturbed and one seeks for solutions allowing a small error $\| \Phi (X) \xi_i - v_i \| <\varepsilon_0$ but under a model simplification such as imposing that some coefficients of $\xi_i$ are zero, that is, looking for sparse solutions.

The sparse model recovery of the coefficients $\xi_i$ is the problem

$$\min_{q \in \mathbb{R}^k} \| q \|_0 \mbox{~ ~ subjected to ~ ~} \| \Phi(X) q -  v_i \|\le\lambda$$ for a suitably chosen $\lambda>0$.

Now we are ready to prove the following

<div class="thr">

**Theorem 27**. *Consider Eq. () and the following assumptions*

- *(H0) Eq. () is generic (coefficients $a_{ij}$ are non vanishing)*

- *(H1) Eq () has a normal form $$\begin{aligned}
  \dot y &=& G(y) + R(y)  
  \end{aligned}$$ where $G$ contains no non-resonant terms and $\|R(y)\| = O(y^{d+1})$ for some large $d$. Moreover the coordinates of $y$ have the expansion $$\dot y_i 
  = \sum_{j=1}^k b_{ij} p_j(y) + R_i(y)$$*

- *(H2) The trajectories $\{x(t)\}_{t=0}^T$ as well as $\{\dot x(t)\}_{t=0}^T$ are given with $T$ sufficiently large and stay in a sufficiently small neighbourhood $V_{\varepsilon}$ of the origin such that $$\sup_{t\in[0,T]} \| x(t) \|_{C^1} \le \varepsilon$$ for initial conditions in an open neighbourhood of the origin.*

- *(H3) The operator $\Phi$ is full rank.*

*Then there exist $\lambda = \lambda (\varepsilon,d)>0$ such the solution to the sparse recovery problem $$\min_{q \in \mathbb{R}^k} \| q \|_0 \mbox{~ ~ subjected to ~ ~} \| \Phi(X) q -  v_i \|_2 \le \lambda$$ is the vector of coefficients of $(b_{i1},b_{i2}, \dots, b_{ik})^*$ of the normal form of Eq. ()*

</div>

<div class="proof">

*Proof.* We break the arguments into three steps:

*Step1: Approximations and Uniqueness solutions.* By normal form theory there are functions $Q_1$ and $Q_2$ such that $$\label{Pnf}
x  = y + Q_1(y) \mbox{~~ and ~~} y = x+ Q_2(x)$$ where $\| Q_1(y) \| = O(\|y\|^{2})$ and $\| Q_2(x) \| = O(\|x\|^2)$. Given a trajectory $y(t)$ we construct the matrix $Y$ in the same manner as $X$ and consider $$u_i = \left(
\begin{array}{c}
\dot y_i(0) \\
\dot y_i(h) \\
\vdots \\
\dot y_i (T)
\end{array}
\right) \mbox{~ and ~ }
 \rho_i (Y) = \left(
\begin{array}{c}
 R_i(y(0)) \\
 R_i(y(h)) \\
\vdots \\
 R_i(y(T))
\end{array}
\right)$$ As the basis is formed by homogeneous polynomials, using Eq. () we conclude that there is $L$ such that $$\| \Phi(X) - \Phi(Y)  \|_2 \le L \varepsilon^{2}$$

By $(H3)$ $\Phi(X)$ is full rank and for $\varepsilon^{2}$ small enough, we conclude that $\Phi(Y)$ is also full rank since the rank is lower semicontinuous. Next notice that the equation $$\label{Y}
\Phi(Y) \zeta_i + \rho_i(Y) =  u_i$$ also has a solution $\zeta_i = (b_{i1}, b_{i2}, \dots, b_{ik})^*$ by construction and it is unique since $\Phi(Y)$ is full rank. Furthermore, in $V_{\varepsilon}$ there is a constant $M$ such that $$\| \rho_i(Y)\|_2 \le M \varepsilon^{2} ,\,\,\,\, \forall i \in \{1,\dots, m\}$$

Using Eq. () we obtain $$\begin{aligned}
\label{uv}
v_i =  u_i + z_i
\end{aligned}$$ where $z_i$ corresponds to terms as $DP(y) \dot y$. By $(H2)$ trajectories stay in the neighbourhood $V_{\varepsilon}$, thus, there is a constant $C$ such that $$\| z_i \|_2 \le C \varepsilon^{2},\,\,\,\, \forall i \in \{1,\dots, m\}$$

*Step 2: A sparse solution.* Consider the unique solution $\zeta_i$ of Eq. () and let $\sigma_i = \|\zeta_i \|_0$. Consider the set $$B_{\lambda, \sigma_i} = \{ q \in \mathbb{R}^k: \| q\|_0 \le \sigma_i \mbox{~and ~} 
\| \Phi(X)q - v_i \|_2 \le \lambda \}$$ Now we claim that if $\lambda:= (L \| \zeta_i\|_2 + C+ M) \varepsilon^{d}$ then $\zeta_i \in B_{\lambda, \sigma_i}$. Indeed, consider $$\begin{aligned}
\| \Phi(X) \zeta_i - v_i \|_2 &=& \| \Phi(X) \zeta_i + \Phi(Y) \zeta_i - \Phi(Y) \zeta_i- v_i \|_2 \nonumber \\
&=& \| [ \Phi(X) - \Phi(Y) ] \zeta_i + \Phi(Y) \zeta_i- u_i - z_i +\rho_i - \rho_i \|_2 \nonumber \\
&=& \| [ \Phi(X) - \Phi(Y) ] \zeta_i- z_i - \rho_i \|_2 \nonumber \\
&\le & \| \Phi(X) - \Phi(Y) \|_2 \| \zeta_i \|_2 +  \|z_i\|_2 +  \|\rho_i \|_2 \nonumber \\
&\le& (L  \| \zeta_i \|_2 + M + C) \varepsilon^2 \nonumber
\end{aligned}$$

*Step 3: Uniqueness.* Assume that there is $\eta \in B_{\lambda, \sigma_i}$ with $\| \eta\|_0 < \sigma_i$. Since $\Phi(X)$ is full rank, this implies that there is $\hat R$ such that $\| \hat R(x) \|_2 \le K \| x\|_2^{d+1}$ for some $K$ and $\dot x = \hat G(x) + \hat R(x)$. Thus, $\hat G$ has fewer coefficients than $G$, implying that either $G$ must have a non-resonant term or $(H0)$ was violated. This contracts $(H1)$ and completes the proof.  
 ◻

</div>

<div class="remk">

*Remark 28*. Assumption $H2$ is natural in our context. Notice since the isolated system has a limit cycle near the origin. Thus, an open set of initial conditions is attracted to the cycles and stays for all times near the origin where we control the norm of solutions . When coupling such dynamics to a network this behaviour persists.  

</div>

<div class="remk">

*Remark 29*. Assumption $H3$ is in general not restrictive. If solutions of $\dot x=F(x)$ are not degenerated such as all solutions converge to fixed points, then typically $\Phi(X)$ is full rank. In fact, if solutions converge to an attractor, we can adapt the basis to the dynamics such that in the adapted basis $\Phi^*(X) \Phi(X)$ is close to identity for large $T$ . This implies that $\Phi(X)$ is close to orthogonal.  

</div>

<div class="remk">

*Remark 30*. Another interesting case is when $$\dot x = F(x) + U(t,x)$$ and $U$ has fast oscillations. This happens typically in phase dynamics when we subtract the trends of linear frequencies. For example, consider $$\begin{aligned}
\dot \theta &=& 1  + \epsilon \sin(\theta - \phi ) + \epsilon \cos( \theta +\phi) \\
\dot \phi &=& 1+\delta  + \epsilon \sin(\phi-\theta ) + \epsilon \cos( \theta +\phi) 
\end{aligned}$$ where $\delta\ll1$. Subtracting the trend $\vartheta = \theta - t$ and $\varphi = \phi -t$ leads to $$\begin{aligned}
\dot \vartheta &=&  \epsilon \sin(\vartheta - \varphi ) + \epsilon \cos(\vartheta +\varphi - 2t ) \\
\dot \varphi &=& \delta  + \epsilon \sin(\varphi-\vartheta ) + \epsilon \cos(\vartheta +\varphi - 2 t) 
\end{aligned}$$ Since $\dot \varphi$ and $\dot \vartheta$ are $O(\delta)$ by the averaging Theorem, fast oscillating terms containing $\cos$ are averaged out and can be neglected in a time scale as $1/\delta$. Thus, also in this case when performing a model recovery with finite amount of data the function $U$ cannot be recovered. This also happens for our examples in the main text. Thus, sparsity and fast oscillations can contribute to the impossibility of recovering the original model.

</div>

# Emergent hypernetworks in an integrate-and-fire model

**Integrate and fire model.** We used an autocatalytic integrate-and-fire model to simulate the behavior of four oscillators in a ring configuration with state variable $v_k$, and a parameter for each oscillator $p_k$ that determines whether the variable is increasing or decreasing. In the model, we introduce nonlinear time-delayed coupling, and the oscillators are governed by the equations

$$\label{IF-equ}
\frac{dv_k}{dt} = \frac{p_{k}v_{k} - (1-p_{k})v_{k}B}{F_{k}} +p_{k}K \sum_{\l=1}^4 A_{k,l}(\tilde{v}_k+\tilde{v}_k^2)\tilde{v}_l(t-\tau)$$ where $F_k$ is a rescaling factor that affects the natural frequency of $k$th oscillator, $K$ is the coupling strength, $\tilde{v}_k$ is the signal corrected for offset ($\tilde{v}_k=v_k-0.626$), $A_{k,l}$ is the adjacency matrix, and $\tau$ is the time delay.

When the variable $v_k$ reaches 1 from below, then $p_k$ is smoothly set to 0, and $v_k$ decreases. Similarly, when the variable $v_k$ reaches from above $A$, $p_k$ is set to 1, and the variable starts to increase. We selected the threshold parameter $A=0.36$ and the timescale parameter $B=3.333$ so that only the one-cluster is stable with positive coupling. Then we adjusted the parameter $F_k$ ($F_1$=4.950, $F_2$=1.955, $F_3$=3.177, $F_4$=1.970) of each oscillator to have a frequency ratio with respect oscillator 1 as $\omega_2/\omega_1 \approx 2.5$, $\omega_3/\omega_1 \approx 1.5$ and $\omega_4/\omega_1$$\approx 2.5$. Note that $F_k$ only affects the local dynamics of oscillator $k$ and not the coupling term. Figure   (a) shows the time series of the variable $v_k$ for $K$=0.234 and $\tau$=1.65 s.  

<figure id="fig:sim_iaf">
<span class="image placeholder" data-original-image-src="Slide3_v1.png" data-original-image-title="" width="1\columnwidth"></span>
<figcaption><span><strong>Simulations and network reconstruction with the integrate-and-fire model</strong></span> a) Time series of the <span class="math inline">\(v_k\)</span> variable. The blue, orange, yellow, and green lines correspond to oscillators one to four. b) Time series of the slow phases, <span class="math inline">\(\phi_1\)</span> (blue) and <span class="math inline">\(\phi_2\)</span> (green) with coupling and delay. c) The instantaneous frequency and the phase model fitted values (red) for oscillators 1 to 4 (corresponding from top to bottom). d) Coupling amplitudes for the four oscillators (<span class="math inline">\(k\)</span>) from hypernetworks one (blue) and 2 (red).</figcaption>
</figure>

**Fitting of phase dynamics.** Similar to the experiments, we extract the phase of each oscillator using the peak-finding approach from the time series of the variable $v_k$. When there is coupling and delay, the triplet phase differences, $\phi_j$, $j$=1, 2, show a phase slip behavior Supplementary Fig.  (b). As described in the main text we used LASSO to fit the $\dot{\theta}_k$ values accoriding to equation  () with drifting in the natural frequencies. The time series of the $v_k$ variable (see Supplementary Fig.   (a)) showed a more nonlinear wave form, and we fitted the amplitudes of sin and cos until the seond order harmonics ($C_{j,2}^k$ and $D_{j, 2}^k$). The $\dot{\theta}_k$ was filtered by a first order Savitzky-Golay filter for 125 s. Supplementary Fig.   (c) shows the corresponding fits for oscillator 1 to 4. (In the LASSO fit, we used a regularization parameter that represented an error 40% higher than the best fit). The fitted parameters are shown in Supplementary Fig. .

<figure id="fig:coeff_tab">
<span class="image placeholder" data-original-image-src="Slide4_v1.png" data-original-image-title="" width="0.6\columnwidth"></span>
<figcaption><span><strong>Hypernetwork fitting coefficients for phase dynamics of the integrate-and-fire model.</strong> </span> </figcaption>
</figure>

The strength of the triplet interactions on oscillator $k$ is given by the amplitudes of the first and second harmonics ($H_j^k$); the amplitudes are shown in Supplementary Fig. d. In agreement with the experiments, the dynamics of oscillators 1 and 3 are impacted by both triplet interactions $\phi_1$ and $\phi_2$. For oscillator 1, the amplitudes are 1.7 $\times 10^{-3}$ and 1.0 $\times 10^{-3}$, and for oscillators 3 the amplitudes are 5.6 $\times 10^{-4}$ and 7.4 $\times 10^{-4}$ respectively. However, the dynamics of oscillator 2 and 4 are only impacted by $\phi_1$ (2.1 $\times 10^{-3}$) and $\phi_2$ (1.1 $\times 10^{-3}$).

We conclude that in an integrate-and-fire model, the phase dynamics of the oscillators coupled in a ring can be described by an emergent hypernetwork.

# Mean field interaction

We consider the system $$\begin{aligned}
\label{theODE00pluslinsasd}
\dot{z}_k &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha \sum_{\ell =1}^n A_{k\ell}(z_{\ell} + \bar{z}_{\ell}z_k^2)\, ,
\end{aligned}$$ where $A$ is the 4-ring network, with nodes labelled $1$ through $4$ along the ring. These frequencies satisfy the resonance conditions $\omega_1 + \omega_3 \approx 2\omega_2$ and $\omega_2 + \omega_4 \approx 2\omega_1$. A priori, it is unclear what the behavior of the system will look like. To elucidate this, we conjugate the system by a transformation designed to get rid of the third order coupling terms in $\alpha$. To this end, we define new coordinates $$w_k = z_k - \alpha \sum_{\ell =1}^n \frac{A_{k\ell}}{\gamma_k + \bar{\gamma}_{\ell}}z_k^2\bar{z}_{\ell} \, .$$ This causes new terms in $\alpha$ to appear, related to the $\beta_k z_k|z_k|^2$ terms in Equation . We therefore perform another coordinate transformation $$u_k = w_k - \alpha Q_k(w) \, ,$$ for some suitably chosen polynomials $Q_k$. We get equations for $\dot{u}_k$, which involve, among others, combinations of the linear and non-linear terms in the coupling $$\alpha \sum_{\ell =1}^n A_{k \ell}(z_{\ell} + \bar{z}_{\ell}z_k^2)\, .$$ We then discard non-resonant terms in $\alpha^2$, which leaves the equations $$\begin{aligned}
\label{RedZ}
\dot{u}_1 &= \gamma_1u_1 - \beta_1 u_1|u_1|^2 + \alpha(u_2 + u_4) + \alpha^2\frac{u_{2}^2\bar{u}_{3}}{\gamma_{2} + \bar{\gamma}_3} + \text{h.o.t.}\\ \nonumber
\dot{u}_2 &= \gamma_2u_2 - \beta_2 u_2|u_2|^2 + \alpha(u_1 + u_3) + \alpha^2\frac{u_{1}^2\bar{u}_{4}}{\gamma_{1} + \bar{\gamma}_4} + \text{h.o.t.}\\ \nonumber
\dot{u}_3 &= \gamma_3u_3 - \beta_3 u_3|u_3|^2 + \alpha(u_2 + u_4) + \alpha^2\frac{u_{2}^2\bar{u}_{1}}{\gamma_{2} + \bar{\gamma}_1} + \text{h.o.t.}\\ \nonumber
\dot{u}_4 &= \gamma_4u_4 - \beta_4 u_4|u_4|^2 + \alpha(u_1 + u_3) + \alpha^2\frac{u_{1}^2\bar{u}_{2}}{\gamma_{1} + \bar{\gamma}_2}+ \text{h.o.t.}\, .
\end{aligned}$$ See Section for more details on these normal form calculations. If we ignore the (non-resonant) terms $\alpha(u_2 + u_4)$ and $\alpha(u_1 + u_3)$ in Equation , then averaging yields the emergent phase dynamics. To this end, we set $\varphi_1 := \phi_1-2\phi_2+\phi_3$ and $\varphi_2 := \phi_2-2\phi_1+\phi_4$ for the slow phases. The different monomials in Equation then yield terms in the phase equations according to:

- for node 1, $\frac{u_{2}^2\bar{u}_{3}}{\gamma_{2} + \bar{\gamma}_3}$ gives terms involving sin/cos of $\varphi_1$;

- for node 2, $\frac{u_{1}^2\bar{u}_{4}}{\gamma_{1} + \bar{\gamma}_4}$ gives terms involving sin/cos of $\varphi_2$;

- for node 3, $\frac{u_{2}^2\bar{u}_{1}}{\gamma_{2} + \bar{\gamma}_1}$ gives terms involving sin/cos of $\varphi_1$;

- for node 4, $\frac{u_{1}^2\bar{u}_{2}}{\gamma_{1} + \bar{\gamma}_2}$ gives terms involving sin/cos of $\varphi_2$.

## Frequency shifts

The linear terms $\alpha(u_2 + u_4)$ and $\alpha(u_1 + u_3)$ nevertheless have an effect on the emergent dynamics, in the following way. Whereas the natural frequencies of the uncoupled system (i.e. for $\alpha = 0$) are given by $\omega_1, \dots, \omega_4$, they are in general given by the imaginary part of the eigenvalues of the perturbed matrix $$U = \lambda I + i\Omega + \alpha A$$ where, $\Omega$ is the diagonal matrix with entries $\omega_1, \dots, \omega_4$, and $A$ is the adjacency matrix of the network. Eigenvalue perturbation then gives augmented frequencies of the form $\omega_k + O(\alpha^2)$. Note that the frequency perturbation is again of order $\alpha^2$. This can be explained by a linear transformation bringing the perturbed system $\lambda I + i\Omega + \alpha A$ to that of the form $\lambda I + i\Omega + \alpha^2 B$, similar to our techniques for non-linear terms.

Therefore, whenever $\alpha>0$ the frequencies will shift providing a frequency mismatch between the slow phases $$\begin{aligned}
\varphi_1 = \theta_1 -2 \theta_2  +\theta_3\\
\varphi_2 = \theta_2 -2 \theta_1 + \theta_4
\end{aligned}$$ namely, they will be modelled as $$\begin{aligned}
\label{eq:mf_fitting}
\dot{\varphi}_{1,2} = \varepsilon_{1,2} + G_{1,2}(\varphi_1) +H_{1,2}(\varphi_2).
\end{aligned}$$ where $\varepsilon_{1,2}=O(\alpha^2)$.

## Model Recovery

We integrate Eq. () with $\Omega_1 = 2, \Omega_2 = 3, \Omega_3 = 4$ and $\Omega_4 = 1$, by employing a wrapper of ODEPACK routine. Numerical integration was performed for 25000s with 0.01 time step. We discard the first 5000s points as transient.

We apply sparse regression using PySINDy Python package with the Lasso optimizer on the phases $\theta_i$ considering the slow phases $\varphi_{1,2}$ with a penalty term $\lambda = 5\times10^{-3}$, we obtain

$$\begin{aligned}
\dot{\theta}_1 &=2.001 + 0.018 \cos(\varphi_1) \\
\dot{\theta}_2 &=2.999 - 0.015 \cos(\varphi_2) \\
\dot{\theta}_3 &=3.992 - 0.011 \cos(\varphi_1) \\
\dot{\theta}_4 &=1.008 + 0.011 \cos(\varphi_2). 
\end{aligned}$$

To recover the slow phase dynamics of $\varphi_1$ and $\varphi_2$ we apply the Lasso method with a penalty term $\lambda = 10^{-5}$ after applying a rolling window averaging process using window size of 100s to smooth the fast oscillations to have better fit on slow phases. The obtained equation after the Lasso approach reads as $$\begin{aligned}
\label{eq:3nodes_recon}
\dot{\varphi_1} &= -0.008 + 0.002 \sin(\varphi_1) + 0.001 \cos(\varphi_2) \\ 
\dot{\varphi_2} &= \,\,\,\,\, 0.008 - 0.001 \cos(\varphi_1) + 0.002 \sin(\varphi_2). 
\end{aligned}$$ The theory and the fitting are also in a perfect agreement for this mean-field case.

## Normal Form Calculations

Here we consider the case where we have both (non-resonant) linear coupling terms as well as higher order ones. More precisely, we consider the system $$\begin{aligned}
\label{theODE00pluslin}
\dot{z}_k &= \gamma_kz_k - \beta_k z_k|z_k|^2 + \alpha \sum_{\ell =1}^n c_{k,\ell}z_{\ell} + \alpha H_k(z) \, ,
\end{aligned}$$ where $H_k$ has only terms of degree $3$ and higher. Later, we will set $H_k(z) =  \sum_{\ell =1}^n c_{k,\ell}z_k^2\bar{z_{\ell}}$. We assume that corresponding functions $P_k$ exist that solve $$\begin{aligned}
\label{theODE00pluslin1}
\Gamma P_k - \gamma_k P_k = H_k\, .
\end{aligned}$$ In particular, when $H_k(z) =  \sum_{\ell =1}^n c_{k,\ell}z_k^2\bar{z_{\ell}}$ we assume that $\omega_k \not= \omega_{\ell}$ whenever $c_{k,\ell} \not= 0$, so that we may define $$\begin{aligned}
\label{theODE00pluslin2}
P_k(z) = \sum_{\ell =1}^n \frac{c_{k,\ell}}{\gamma_k + \bar{\gamma}_{\ell}}z_k^2\bar{z}_{\ell} \, .
\end{aligned}$$ With slight abuse of notation, the sum in Equation is taken over all $\ell$ such that $c_{k,\ell} \not= 0$. As before, we consider the coordinate transformation $w_k = z_k - \alpha P_k(z)$, which gives $$\label{expresssss122}
z_k = w_k + \alpha P_k(w) + \alpha^2 [P_k||P](w) + \mathscr{O}(|\alpha|^3|w|^7)\, ,$$ by lemmas and . A calculation as before reveals that $$\begin{aligned}
\dot{w}_k &= \gamma_kw_k - \beta_k w_k|w_k|^2 + \alpha \sum_{\ell =1}^n c_{k,\ell}w_{\ell} + \alpha (\gamma_kP_k(w) - \Gamma P_k(w) + H_k(w)) \\ \nonumber
&+  \alpha(L^1_k(w) - L^2_k(w)) + \alpha^2[\gamma_kP_k - \Gamma P_k + H_k || P](w) \\ \nonumber
&+\alpha^2\sum_{\ell =1}^n c_{k,\ell}P_{\ell}(w) - \alpha^2[P_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}w_{\ell}, \dots )](w) - \alpha^2[P_k || H](w) \\ \nonumber
&+ \mathscr{O}(|\alpha|^2|w|^7 + |\alpha|^3|w|^5) \\ \nonumber
&= \gamma_kw_k - \beta_k w_k|w_k|^2 + \alpha \sum_{\ell =1}^n c_{k,\ell}w_{\ell} +  \alpha(L^1_k(w) - L^2_k(w))  \\ \nonumber
&+\alpha^2\sum_{\ell =1}^n c_{k,\ell}P_{\ell}(w) - \alpha^2[P_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}w_{\ell}, \dots )](w) - \alpha^2[P_k || H](w) \\ \nonumber
&+ \mathscr{O}(|\alpha|^2|w|^7 + |\alpha|^3|w|^5) 
\end{aligned}$$ where in the last step we have used Equation , and where we again set $$\begin{aligned}
L^1_k(w) &:=  [P_k|| (\dots, \beta w_j|w_j|^2, \dots)](w) \text{ and }\\ \nonumber
L^2_k(w) &:=  [\beta_k w_k |w_k|^2|| P](w)\, .
\end{aligned}$$ Next, we perform a second transformation $u_k = w_k - \alpha Q_k(w)$, where $Q_k$ solves $$\begin{aligned}
\label{theODE00pluslin12w}
\Gamma Q_k - \gamma_k Q_k = L^1_k - L^2_k\, ,
\end{aligned}$$ and where $$\label{invssofw}
    w_k = u_k + \alpha Q_k(u) + \mathscr{O}(|\alpha|^2|u|^9)\, .$$ This gives $$\begin{aligned}
\dot{u}_k &= \gamma_ku_k - \beta_k u_k|u_k|^2 + \alpha \sum_{\ell =1}^n c_{k,\ell}u_{\ell} + \alpha (\gamma_kQ_k(u) - \Gamma Q_k(u) + L^1_k(u) - L^2_k(u)) \\ \nonumber
&+  \alpha^2 \sum_{\ell =1}^n c_{k,\ell}Q_{\ell}(u) - \alpha^2[Q_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}u_{\ell}, \dots )](u)\\ \nonumber
&+\alpha^2\sum_{\ell =1}^n c_{k,\ell}P_{\ell}(u) - \alpha^2[P_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}w_{\ell}, \dots )](u) - \alpha^2[P_k || H](u) \\ \nonumber
&+ \mathscr{O}(|\alpha||u|^7 + |\alpha|^3|u|^5) \, .
\end{aligned}$$ By Equation we therefore get $$\begin{aligned}
\label{lastofabstra}
\dot{u}_k &= \gamma_ku_k - \beta_k u_k|u_k|^2 + \alpha \sum_{\ell =1}^n c_{k,\ell}u_{\ell}  \\ \nonumber
&+  \alpha^2 \sum_{\ell =1}^n c_{k,\ell}Q_{\ell}(u) - \alpha^2[Q_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}u_{\ell}, \dots )](u)\\ \nonumber
&+\alpha^2\sum_{\ell =1}^n c_{k,\ell}P_{\ell}(u) - \alpha^2[P_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}w_{\ell}, \dots )](u) - \alpha^2[P_k || H](u) \\ \nonumber
&+ \mathscr{O}(|\alpha||u|^7 + |\alpha|^3|u|^5) \, .
\end{aligned}$$ We now return to the special case of $H_k(z) =  \sum_{\ell =1}^n c_{k,\ell}z_k^2\bar{z_{\ell}}$. By assumption, the terms in $\alpha$ are resonant. Of the terms in $\alpha^2$, only $$\begin{aligned}
\label{lastofabstra2}
\alpha^2\sum_{\ell =1}^n c_{k,\ell}P_{\ell}(u) - \alpha^2[P_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}w_{\ell}, \dots )](u)
\end{aligned}$$ is third order in $u$ (as opposed to fifth order). A direct calculation shows that $$\begin{aligned}
\label{lastofabstra3}
&\sum_{\ell =1}^n c_{k,\ell}P_{\ell}(u) - [P_k|| (\dots, \sum_{\ell =1}^n c_{j,\ell}w_{\ell}, \dots )](u) \\ \nonumber
&= \sum_{\ell =1}^n \sum_{p =1}^n \frac{c_{k,\ell} c_{\ell,p}}{\gamma_{\ell} + \bar{\gamma}_p}u_{\ell}^2\bar{u}_{p} - \sum_{\ell =1}^n \sum_{p =1}^n \frac{c_{k,\ell} c_{\ell,p}}{\gamma_{k} + \bar{\gamma}_{\ell}}u_{k}^2\bar{u}_{p} - 2\sum_{\ell =1}^n \sum_{p =1}^n \frac{c_{k,\ell} c_{k,p}}{\gamma_{k} + \bar{\gamma}_{\ell}}u_{k}\bar{u}_{\ell}u_{p}  \, .
\end{aligned}$$ From these the resonant terms can be selected, which leads to a hypernetwork description of the dynamics.
