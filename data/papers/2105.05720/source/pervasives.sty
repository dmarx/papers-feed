\usepackage[normalem]{ulem}
\usepackage{xspace}
\usepackage{color}
\usepackage{listings}
\usepackage{tikz}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{mathpartir}
\usepackage{float}
\usepackage{textcomp}
\usepackage{pythonhighlight}
\usepackage{algorithm}
\usepackage{tabularx}
\usepackage{algpseudocode}% http://ctan.org/pkg/
\usepackage{float}

\newcommand{\DSL}{DSL\xspace}
\newcommand{\allgather}{AllGather\xspace}
\newcommand{\reducescatter}{ReduceScatter\xspace}
\newcommand{\allreduce}{AllReduce\xspace}
\newcommand{\send}{Send\xspace}
\newcommand{\recv}{Recv\xspace}
\newcommand{\reduce}{Reduce\xspace}
\newcommand{\scatter}{Scatter\xspace}
\newcommand{\broadcast}{Broadcast\xspace}
\newcommand{\alltoall}{Alltoall\xspace}
\newcommand{\Locs}{R}
\newcommand{\loc}{r}
\newcommand{\tensor}{T}
\newcommand{\type}{t}
\newcommand{\alloc}{a}
\newcommand{\continuous}{\text{Continuous}\xspace}
\newcommand{\convert}[1]{\mathcal{K}[\![#1]\!]}
\newcommand{\Complete}{\text{Complete}\xspace}
\newcommand{\complete}{\text{complete}\xspace}
\newcommand{\Replicated}{\text{Replicated}\xspace}
\newcommand{\replicated}{\text{replicated}\xspace}
\newcommand{\Sliced}{\text{Sliced}\xspace}
\newcommand{\sliced}{\text{sliced}\xspace}
\newcommand{\WORLDMath}{WORLD\xspace}
\newcommand{\WORLD}{\texttt{WORLD}\xspace}
\newcommand{\dgxone}{DGX-1\xspace}
\newcommand{\dgxtwo}{DGX-2\xspace}

\newcommand{\tool}{\textsc{CoCoNet}\xspace}
\newcommand{\toolrt}{\textsc{CoCoNet-RT}\xspace}

\newcommand{\ois}[1]{\ifdraft {\color{green} #1 - Olli}\fi}
\newcommand{\change}[1]{{\color{red} #1}}
\newcommand{\aj}[1]{{\color{red} #1 - Abhinav}}
\newcommand{\mm}[1]{\ifdraft{\color{blue} (Madan:  #1)}\fi}
\newcommand{\tm}[1]{\ifdraft{\color{orange} (Todd:  #1)}\fi}
\newcommand{\sm}[1]{\ifdraft{\color{red} (Saeed:  #1)}\fi}
\newcommand{\ym}[1]{\ifdraft{\color{cyan} #1 -Youshan}\fi}
\newcommand{\spara}[1]{\vspace*{0.05in}\noindent\textbf{#1}}

%\newcommand{\TODO}[1]{{\color{red} {\bf #1}}}
\newcommand{\TODO}[1]{{\color{red} {#1}}}

\definecolor{bluekeywords}{rgb}{0.13,0.13,1}
\definecolor{greencomments}{rgb}{0,0.5,0}
\definecolor{turqusnumbers}{rgb}{0.17,0.57,0.69}
\definecolor{redstrings}{rgb}{0.5,0,0}
\definecolor{greycolor}{RGB}{160,160,160}
\definecolor{pinkred}{RGB}{222,62,150}
\definecolor{darkblue}{RGB}{33,103,155}

\lstdefinelanguage{DSL}
    {keywords={long, int, char, for, if, else, then, Vertex, Edge, Sampler, bool, return, while, true, float, true, false, void,  Complete, Replicated, Local, Float, Sliced, FP32, fuse, split, reorder, fuseComm, overlap, asSlice, dead},
    keywordstyle=\color{darkblue},
    sensitive=true,
    morecomment=[l][\color{greencomments}]{///},
    morecomment=[l][\color{greencomments}]{//},
    morecomment=[s][\color{greencomments}]{{(*}{*)}},
    morestring=[b]",
    stringstyle=\color{pinkred},
    escapeinside={(*}{*)}, % if you want to add comments in code
    escapechar=|, xleftmargin=1em,xrightmargin=1em,framexleftmargin=1em,numbersep=3pt,
    emph={Var, Func, Execute, Stage, Pipeline, Tensor, Scalar, AllReduce, ReduceScatter, AllGather, Reduce, FusedAllReduce, MatMul, Dropout, ARSplitRSAG, AGReorder, Send, Update, Pow, Sqrt, SendFuse},
    emphstyle={\color{pinkred}},
    mathescape=true, numbers=left, numberstyle=\footnotesize\color{greycolor},
    firstnumber=1,
    basicstyle=\ttfamily,
    frame=single,
    rulecolor=\color{greycolor},
    }

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
        \node[shape=circle,draw,inner sep=1pt] (char) {\textsf{\small #1}};}}

\newif\ifdraft

\draftfalse %or \draftfalse