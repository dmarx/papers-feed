% CVPR 2022 Paper Template
% based on the CVPR template provided by Ming-Ming Cheng (https://github.com/MCG-NKU/CVPR_Template)
% modified and extended by Stefan Roth (stefan.roth@NOSPAMtu-darmstadt.de)

\documentclass[10pt,twocolumn,letterpaper]{article}

%%%%%%%%% PAPER TYPE  - PLEASE UPDATE FOR FINAL VERSION
%\usepackage[review]{cvpr}      % To produce the REVIEW version
\usepackage{cvpr}              % To produce the CAMERA-READY version
%\usepackage[pagenumbers]{cvpr} % To force page numbers, e.g. for an arXiv version

% Include other packages here, before hyperref.
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{booktabs}
\makeatletter
\@namedef{ver@everyshi.sty}{}
\makeatother
\usepackage{tikz}


% It is strongly recommended to use hyperref, especially for the review version.
% hyperref with option pagebackref eases the reviewers' job.
% Please disable hyperref *only* if you encounter grave issues, e.g. with the
% file validation for the camera-ready version.
%
% If you comment hyperref and then uncomment it, you should delete
% ReviewTempalte.aux before re-running LaTeX.
% (Or just hit 'q' on the first LaTeX run, let it finish, and you
%  should be clear).
\usepackage[pagebackref,breaklinks,colorlinks]{hyperref}


% Support for easy cross-referencing
\usepackage[capitalize]{cleveref}
\crefname{section}{Sec.}{Secs.}
\Crefname{section}{Section}{Sections}
\Crefname{table}{Table}{Tables}
\crefname{table}{Tab.}{Tabs.}

%%%%%%%%% custom packages 
\usepackage{booktabs}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{color}
\usepackage{caption}
\usepackage{hhline}
\usepackage{pifont}
\usepackage{threeparttable}
\usepackage{makecell}
\usepackage{algorithm} 
\usepackage{listings}
\usepackage{amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{lipsum}
\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}
\usepackage[accsupp]{axessibility}
%%%%%%%%% custom define
\newcommand{\modelname}{PoolFormer}
\newcommand{\rulesep}{\unskip\ \vrule\ }
\newcommand{\tabincell}[2]{\begin{tabular}{@{}#1@{}}#2\end{tabular}}
\newcommand{\mathbi}[1]{\textbf{\textit{#1}}}
\newcommand{\myPara}[1]{\vspace{.05in}\noindent\textbf{#1.}}
\newlength\savedwidth
\newcommand\whline{\noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 0.8pt}\hline\noalign{\global\arrayrulewidth\savedwidth}}
\usepackage{verbatim}

\definecolor{resnet}{rgb}{0.9607843137254902, 0.8705882352941177, 0.7019607843137254}
\definecolor{regnety}{rgb}{0.9764705882352941 , 0.792156862745098 , 0.1411764705882353}
\definecolor{vit}{rgb}{0.9019607843137255 , 0.403921568627451 , 0.403921568627451}
\definecolor{deit}{rgb}{1.0 , 0.7137254901960784 , 0.7568627450980392}
\definecolor{pvt}{rgb}{0.7686274509803922 , 0.27058823529411763 , 0.4117647058823529}
\definecolor{mlpmixer}{rgb}{0.0 , 0.5803921568627451 , 0.19607843137254902}
\definecolor{resmlp}{rgb}{0.25098039215686274 , 0.8784313725490196 , 0.8156862745098039}
\definecolor{swinmixer}{rgb}{0.2196078431372549 , 0.403921568627451 , 0.8392156862745098}
\definecolor{gmlp}{rgb}{0.0 , 0.7215686274509804 , 0.5803921568627451}
\definecolor{poolformer}{rgb}{0.8666666666666667 , 0.6274509803921569 , 0.8666666666666667}
\definecolor{resnetimproved}{rgb}{1.0 , 0.54902 , 0.0}

\newcommand{\resnetdot}{\raisebox{0.5pt}{\tikz\fill[resnet] (0,0) (0ex,-1ex)--(-0.866ex,0.5ex)--(0.866ex, 0.5ex)--cycle;}}
\newcommand{\regnetydot}{\raisebox{0.5pt}{\tikz\fill[regnety] (0,0) (0ex,-1ex)--(-0.866ex,0.5ex)--(0.866ex, 0.5ex)--cycle;}}
\newcommand{\vitdot}{\raisebox{0.5pt}{\tikz\fill[vit] (0,0) (0ex,1ex)--(-0.866ex,-0.5ex)--(0.866ex, -0.5ex)--cycle;}}
\newcommand{\deitdot}{\raisebox{0.5pt}{\tikz\fill[deit] (0,0) (0ex,1ex)--(-0.866ex,-0.5ex)--(0.866ex, -0.5ex)--cycle;}}
\newcommand{\pvtdot}{\raisebox{0.5pt}{\tikz\fill[pvt] (0,0) (0ex,1ex)--(-0.866ex,-0.5ex)--(0.866ex, -0.5ex)--cycle;}}
\newcommand{\mlpmixerdot}{\raisebox{0.5pt}{\tikz\fill[mlpmixer] (0,0) (1ex,0ex)--(-0.5ex,0.866ex)--(-0.5ex, -0.866ex)--cycle;}}
\newcommand{\resmlp}{\raisebox{0.5pt}{\tikz\fill[resmlp] (0,0) (1ex,0ex)--(-0.5ex,0.866ex)--(-0.5ex, -0.866ex)--cycle;}}
\newcommand{\swinmixer}{\raisebox{0.5pt}{\tikz\fill[swinmixer] (0,0) (1ex,0ex)--(-0.5ex,0.866ex)--(-0.5ex, -0.866ex)--cycle;}}
\newcommand{\gmlp}{\raisebox{0.5pt}{\tikz\fill[gmlp] (0,0) (1ex,0ex)--(-0.5ex,0.866ex)--(-0.5ex, -0.866ex)--cycle;}}
\newcommand{\poolformer}{\raisebox{0.5pt}{\tikz\fill[poolformer] (0,0) circle (.8ex);}}
\newcommand{\resnetimproved}{\raisebox{0.5pt}{\tikz\fill[resnetimproved] (0,0) circle (.8ex);}}


%%%%%%%%% PAPER ID  - PLEASE UPDATE
\def\cvprPaperID{3733} % *** Enter the CVPR Paper ID here
\def\confName{CVPR}
\def\confYear{2022}

\def\ie{\emph{i.e.}}
\def\eg{\emph{e.g.}}
\def\etc{\emph{etc}}
\def\etal{{\em et al.~}}


\begin{document}

%%%%%%%%% TITLE - PLEASE UPDATE
\title{MetaFormer Is Actually What You Need for Vision}


\author{
Weihao Yu\textsuperscript{1,2*} 
\quad Mi Luo\textsuperscript{1}
\quad Pan Zhou\textsuperscript{1}
\quad Chenyang Si\textsuperscript{1}
\quad Yichen Zhou\textsuperscript{1,2}
\\
\quad Xinchao Wang\textsuperscript{2}
\quad Jiashi Feng\textsuperscript{1}
\quad Shuicheng Yan\textsuperscript{1}
\\
\textsuperscript{1}{Sea AI Lab}
\quad \textsuperscript{2}{National University of Singapore}
\\
\small{\texttt{weihaoyu6@gmail.com} \quad \texttt{\{luomi,zhoupan,sicy,zhouyc,fengjs,yansc\}@sea.com} \quad \texttt{xinchao@nus.edu.sg}}
\\
\small{Code: \url{https://github.com/sail-sg/poolformer}}
}


%%%%%%%%% Figure: Fist figure
\twocolumn[{
\maketitle
\vspace{-40pt}
\begin{figure}[H]
\hsize=\textwidth
\centering
% \hspace{-0.2in}
\begin{subfigure}[b]{0.51\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{figures/MetaFormer.pdf}
    \caption{}
\end{subfigure}    
\hspace{0.1in}
\begin{subfigure}[b]{0.42\textwidth}
     \centering
     \includegraphics[width=1\textwidth]{figures/MetaFormer_plot.pdf}
     \caption{}
\end{subfigure}
\vspace{-2.6mm}
\caption{
\textbf{MetaFormer and performance of MetaFormer-based models on ImageNet-1K validation set.} As shown in (a),  we present \textit{MetaFormer} as a general architecture abstracted from Transformers~\cite{transformer} by not specifying the token mixer. When using attention/spatial MLP as the token mixer, MetaFormer is instantiated as Transformer/MLP-like models. We argue that the competence of Transformer/MLP-like models primarily stems from the general architecture MetaFormer instead of the equipped specific token mixers. To demonstrate this, we exploit an embarrassingly simple non-parametric operator, \textit{pooling}, to conduct extremely basic token mixing. Surprisingly, the resulted model \textit{PoolFormer} consistently outperforms the well-tuned vision Transformer \cite{vit} baseline (DeiT \cite{deit}) and MLP-like \cite{mlp-mixer} baseline (ResMLP \cite{resmlp}) as shown in (b), which well supports that MetaFormer is actually what we need to achieve competitive performance. RSB-ResNet in (b) means the results are from ``ResNet Strikes Back" \cite{resnet_improved} where ResNet \cite{resnet} are trained with improved training procedure for 300 epochs.
}
\label{fig:first_figure}
\vspace{-3mm}
\end{figure}
}]

%%%%%%%%% ABSTRACT

\input{0_abstract}

%%%%%%%%% BODY TEXT
\input{1_introduction}
\input{2_related_work}
\input{3_method}
\input{4_experiments}
\input{5_conclusion}

\section*{Acknowledgement}
The authors would like to thank Quanhong Fu at Sea AI Lab for the help to improve the technical writing aspect of this paper. Weihao Yu would like to thank TPU Research Cloud (TRC) program and Google Cloud research credits for the support of partial computational resources.
This project is in part supported by NUS Faculty Research Committee Grant~(WBS: A-0009440-00-00). Shuicheng Yan and Xinchao Wang are the corresponding authors.

%%%%%%%%% REFERENCES
{\small
\bibliographystyle{ieee_fullname}
\bibliography{6_references}
}

\newpage
\appendix
\input{7_apendix}

\end{document}
