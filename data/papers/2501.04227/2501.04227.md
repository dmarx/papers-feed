---
abstract: |
  Historically, scientific discovery has been a lengthy and costly process, demanding substantial time and resources from initial conception to final results. To accelerate scientific discovery, reduce research costs, and improve research quality, we introduce `Agent Laboratory`, an autonomous LLM-based framework capable of completing the entire research process. This framework accepts a human-provided research idea and progresses through three stages—literature review, experimentation, and report writing to produce comprehensive research outputs, including a code repository and a research report, while enabling users to provide feedback and guidance at each stage. We deploy `Agent Laboratory` with various state-of-the-art LLMs and invite multiple researchers to assess its quality by participating in a survey, providing human feedback to guide the research process, and then evaluate the final paper. We found that: (1) `Agent Laboratory` driven by o1-preview generates the best research outcomes; (2) The generated machine learning code is able to achieve state-of-the-art performance compared to existing methods; (3) Human involvement, providing feedback at each stage, significantly improves the overall quality of research; (4) `Agent Laboratory` significantly reduces research expenses, achieving an 84% decrease compared to previous autonomous research methods. We hope `Agent Laboratory` enables researchers to allocate more effort toward creative ideation rather than low-level coding and writing, ultimately accelerating scientific discovery.
author:
- Samuel Schmidgall
- Yusheng Su
- Ze Wang
- Ximeng Sun
- Jialian Wu
- Xiaodong Yu
- Jiang Liu
- Zicheng Liu
- Emad Barsoum
bibliography:
- iclr2021_conference.bib
citation-style: ieee
header-includes:
- 
- 
link-citations: true
reference-section-title: References
title: "Agent Laboratory: Using LLM Agents as Research Assistants"
---





<div class="center">

[`https://AgentLaboratory.github.io`](https://AgentLaboratory.github.io/)

</div>

<figure id="fig:AgentLab">
<span class="image placeholder" data-original-image-src="images/jpgs/Agent-Laboratory.jpg" data-original-image-title="" width="0.93\linewidth"></span>
<figcaption> <code>Agent Laboratory</code> takes as input a human research idea and a set of notes, provides this to a pipeline of specialized LLM-driven agents, and produces a research report and code repository.</figcaption>
</figure>

# Introduction

Scientists frequently face constraints that limit the number of research ideas they can explore at any given time, resulting in ideas being prioritized based on predicted impact. While this process helps determine which concepts are worth investing time in and how best to allocate limited resources effectively, many high quality ideas remain unexplored. If the process of exploring ideas had less limitations, researchers would be able to investigate multiple concepts simultaneously, increasing the likelihood of scientific discovery.

In an effort to achieve this, recent work has explored the capability of LLMs to perform research ideation and automated paper generation, where LLM agents perform the role of human scientists (). The work of introduces ResearchAgent, which automatically generates research ideas, methods, and experiment designs, iteratively refining them through feedback from multiple reviewing agents that mirror peer discussions and leverage human-aligned evaluation criteria to improve the outputs. explores fully automated paper generation, where The AI Scientist framework generates novel research ideas, writes code, conducts experiments, and creates a full scientific paper with an automated peer-review system to evaluate the work. Even though these works demonstrate that current LLMs can generate ideas judged to be more novel than those produced by human experts, indicates that LLMs still exhibit weaknesses in feasibility and implementation details, suggesting a complementary rather than replacement role for LLMs in research. Therefore, we aim to design an autonomous agent pipeline that can assist humans toward implementing their own research ideas.

In this work, we introduce `Agent Laboratory`, an autonomous pipeline for accelerating the individual’s ability to perform machine learning research. Unlike previous approaches, where agents participate in their own research ideation independent of human input (), `Agent Laboratory` is designed to assist human scientists in executing their own research ideas using language agents. `Agent Laboratory` takes as input a human research idea and outputs a research report and code repository produced by autonomous language agents, allowing various levels of human involvement, where feedback can be provided at a frequency based on user preference. A detailed list of our contributions are provided below:

1.  We introduce `Agent Laboratory`, an open-source LLM agent framework for accelerating the individual’s ability to perform research in machine learning. In order to accommodate all users, `Agent Laboratory` is compute flexible, where various levels of compute can be allocated based on the individual’s access to compute resource (e.g., CPU, GPU, memory) and model inference budget.

2.  Human evaluators rated papers generated using `Agent Laboratory` across experimental quality, report quality, and usefulness, showing that while the o1-preview backend was perceived as the most useful, o1-mini achieved the highest experimental quality scores, and gpt-4o was behind in all metrics.

3.  NeurIPS-style evaluations showed that o1-preview performed best among backends, particularly in clarity and soundness, according to human reviewers. However, a clear gap emerged between human and automated evaluations, with automated scores significantly overestimating quality (6.1/10 vs. 3.8/10 overall). Similar discrepancies were seen across clarity and contribution metrics, suggesting the need for human feedback to complement automated evaluations for more accurate assessments of research quality.

4.  Co-pilot mode in Agent Laboratory was evaluated on custom and preselected topics, showing higher overall scores compared to autonomous mode. Co-pilot papers also saw trade-offs in experimental quality and usefulness, reflecting challenges in aligning agent outputs with researcher intent.

5.  The co-pilot feature in `Agent Laboratory` is overall found to have high utility and usability when rated by human users, with most participants deciding to continue usage after their experience

6.  Detailed cost and inference time statistics, as well as the breakdown of cost per paper phase, are presented for different model back-ends, demonstrating that `Agent Laboratory` offers automatic research at a greatly reduced price compared with other works (only \$2.33 USD per paper with a gpt-4o backend).

7.  State-of-the-art performance on a subset of MLE-Bench challenges using the proposed `mle-solver`, achieving higher consistency and scoring compared to other solvers, and earning more medals, including gold and silver, than MLAB, OpenHands, and AIDE.

We hope that this work takes a step toward accelerating scientific discovery in machine learning, allowing researchers to allocate more effort toward creative ideation and experiment design rather than low-level coding and writing.

# Background & Related Work

#### Large language models

The research agents in this paper are built on autoregressive large language models (LLMs), which are trained on extensive text corpora to predict conditional probabilities of token sequences, $p(x_t | x_{<t}; \theta)$, and generate text completions through sampling, where $x_t \sim \text{softmax}(W \cdot h_t)$, with $h_t$ as the hidden state and $W$ as the learned weight matrix mapping to token probabilities. LLMs utilize transformer architectures () to capture long-range dependencies in text. These models, such as Claude (), Llama (), and ChatGPT (), leverage vast datasets and scaling techniques, thus enabling them to perform a wide array of language-based tasks, such as translation, summarization, and reasoning, by generalizing patterns learned during pretraining to novel inputs .

#### LLM Agents

While LLMs demonstrate strong understanding and reasoning abilities, they face challenges when executing tasks in real-world scenarios. To overcome these limitations, their capabilities are extended through structured frameworks, enabling them to autonomously and semi-autonomously perform task execution and semi-autonomously perform task execution (). These systems, referred to as agents, utilize techniques such as chain-of-thought prompting (), iterative refinement (), self-improvement (), and external tool integration to execute complex workflows (). LLM agents have made remarkable progress in solving tasks of real-world significance, such as software engineering ), cybersecurity (), and medical diagnosis (). There has also been progress in applying LLMs agents to embodied problems such as autonomous robotics (), web tasks (), and game playing (). For a broader overview of LLM agents, refer to .

#### Automated machine learning

Automated machine learning is an area of active research, with many approaches focused on using Kaggle, an online platform for machine learning competitions, as a benchmark for evaluating agent performance. Notable efforts include MLE-Bench (), DS-bench (), and MLAgentBench () which propose using 75, 74, and 6 Kaggle challenges respectively as benchmarks to measure the abilities of ML agents in tasks such as data preparation, model development, and submission. Several ML "solvers" which can solve ML challenges have been introduced, such as AIDE (), CodeActAgent (referred to as “OpenHands") (), and ResearchAgent (referred to as “MLAB") from MLAgentBench () which automate feature implementation, bug fixing, and code refactoring with a high success rate. Agent K () demonstrates the ability to solve Kaggle challenges at the human-level with a challenge URL provided as input.

#### AI in Scientific Discovery

AI has been used to support scientific discovery across numerous disciplines for decades. For instance, AI has been used for discovery in mathematics (), material science (), chemistry (), algorithm discovery (), and computational biology (). These approaches position AI as a tool rather than an agent performing research in autonomous research.

#### LLMs for research related tasks

LLMs have demonstrated strong capabilities in diverse research-related tasks, such as code generation (), end-to-end software development (), code generation for discovery (), research question-answering (), research ideation (), automated paper reviewing (), literature search (), and predicting the outcome of experiments (). Although LLMs have made notable progress in solving the aforementioned tasks, ideation has struggled to progress, with some work showing that LLM ideation leads to greater novelty than humans (), while others show reduced creativity () and greater homogeneous effects () that may limit creative discovery without human guidance.

Additionally, research on human-AI collaboration has reached mixed conclusions about the idea novelty (). These findings suggest that, with the current LLMs, the strongest research systems would combine human-guided ideation with LLM-based workflows.

#### LLMs for autonomous research

Recent advancements in automated scientific workflows have focused on leveraging LLMs to emulate the process of research. introduces a team of LLM agents working as scientists alongside a human researcher who provides high-level feedback, with the end result being novel nanobody binders aimed at addressing recent variants of SARS-CoV-2. ChemCrow () and Coscientist () demonstrate the ability for autonomous ideation and experimentation in chemistry. ResearchAgent () automates research idea generation, experiment design, and iterative refinement using feedback from reviewing agents aligned with human evaluation criterion. The AI Scientist () extends this automation to encompass end-to-end scientific discovery, including coding, experiment execution, and automated peer review for manuscript generation. Despite these advancements, studies like highlight limitations in the feasibility and implementation details of LLM ideation, indicating a complementary rather than replacement role for LLMs in autonomous research.

# Agent Laboratory

#### Overview.

`Agent Laboratory` begins with the independent collection and analysis of relevant research papers, progresses through collaborative planning and data preparation, and results in automated experimentation and comprehensive report generation. As shown in Figure , the overall workflow consists of three primary phases: (1) Literature Review, (2) Experimentation, and (3) Report Writing. In this section, we will introduce these phases in detail along with the corresponding involved agents. Furthermore, in Section , we will conduct qualitative and quantitative analyses to demonstrate the strengths of `Agent Laboratory` and its ability to generate

<figure id="fig:AgentWorkflow">
<span class="image placeholder" data-original-image-src="images/jpgs/Agent-Lab-Workflow.jpg" data-original-image-title="" width="0.99\linewidth"></span>
<figcaption><code>Agent Laboratory</code> Workflow. This image illustrates the three primary phases of Agent Laboratory: Literature Review, Experimentation, and Report Writing, each featuring distinct tasks, tools, and human-agent roles. The pipeline integrates human input with LLM-driven agents, such as the PhD and Postdoc agents, which handle literature reviews, experimental planning, data preparation, and result interpretation. Specialized tools like mle-solver for experimentation and paper-solver for report generation automate tedious research tasks, enabling collaboration between human researchers and AI to produce high-quality research outputs.</figcaption>
</figure>

## Literature Review

#### Literature Review.

The literature review phase involves gathering and curating relevant research papers for the given research idea to provide references for subsequent stages. During this process, the PhD agent utilizes the arXiv API to retrieve related papers and performs three main actions: `summary`, `full text`, and `add paper`. The `summary` action retrieves abstracts of the top 20 papers relevant to the initial query produced by the agent. The `full text` action extracts the complete content of specific papers, and the `add paper` action incorporates selected summaries or full texts into the curated review. This process is iterative rather than a single-step operation, as the agent performs multiple queries, evaluates the relevance of each paper based on its content, and refines the selection to build a comprehensive review. Once the specified number of relevant texts (N=max) is reached via the `add paper` command, the curated review is finalized for use in subsequent phases.

## Experimentation

#### Plan Formulation

The plan formulation phase focuses on creating a detailed, actionable research plan based on the literature review and research goal. During this phase, the PhD and Postdoc agents collaborate through dialogue to specify how to achieve the research objective, detailing experimental components needed to complete the specified research idea such as which machine learning models to implement, which datasets to use, and the high-level steps of the experiment. Once a consensus is reached, the Postdoc agent submits this plan using the `plan` command, which serves as a set of instructions for subsequent subtasks.

#### Data Preparation.

The goal of the data preparation phase is to write code that prepares data for running experiments, using the instructions from the plan formulation stage as a guideline. The ML Engineer agent executes code using `Python` command command and observes any printed output. The ML Engineer has access to HuggingFace datasets, searchable via the `search HF` command. After agreeing on the finalized data preparation code, the SW Engineer agent submits it using the `submit code` command. Before the final submission proceeds, the code is first passed through a Python compiler to ensure that there are no compilation issues. This process will be iteratively executed until the code is bug-free.

#### Running Experiments.

In the running experiments phase, the ML Engineer agent focuses on implementing and executing the experimental plan formulated prior. This is facilitated by `mle-solver`, a specialized module designed to generate, test, and refine machine learning code autonomously. `mle-solver` begins by producing initial code based on the research plan and insights from the literature review. For the first `mle-solver` step, the program is empty and must generate a file from scratch, which is used as the *top scoring program*. The following processes describe the workflow of the `mle-solver`:

<figure id="fig:mle-solver">
<span class="image placeholder" data-original-image-src="images/jpgs/mle-solver.jpg" data-original-image-title="" width="0.90\linewidth"></span>
<figcaption>Overview of the <code>mle-solver</code> workflow. This diagram details the iterative process used by the MLE-Solver to autonomously generate machine learning code. Beginning with external resources, the workflow integrates command execution (A), where new code is generated, followed by code execution (B) to compile and repair issues if needed. Program scoring (C) evaluates the generated code using a reward function, while self-reflection (D) helps refine future iterations based on results. Performance stabilization (E) ensures consistent outcomes by maintaining a pool of top-performing programs and iterative optimization.</figcaption>
</figure>

1.  **Command Execution.** During the command execution phase, an initial program is sampled from a maintained set of top-performing programs, which is represented by a single file during initialization. The `mle-solver` iteratively refines this program through two operations, `REPLACE` and `EDIT`, to better align the output with experimental objectives. The `EDIT` operation identifies a range of lines, substituting the code between the specified line numbers with newly generated code. In contrast, the `REPLACE` operation generates a completely new Python file.

2.  **Code Execution.** After a code command is executed, the new program is passed through a compiler to check for runtime errors. If it successfully compiles, a score is returned and the list of top programs is updated if the score is higher than the existing programs. If the code does not compile, the agent attempts to repair the code for $N_{rep}$ tries ($N_{rep}$=3 in our experiments) before returning an error and moving on to a new code replacement.

3.  **Program Scoring.** If a code succeeds in compilation, it is sent to a scoring function which determines if it is better than previously implemented experiment code. In order to obtain a program score, we implement a scoring function that uses an LLM reward model to assess the effectiveness of the ML code generated by `mle-solver`. The reward model, invoked as an LM, scores the program on a scale from 0 to 1 considering the outlined research plan, the produced code, and the observed output to determine how accurately the program adheres to the initial goals. A score of 1 is provided for results with high alignment and everything below on a spectrum of how closely the output and code matches the planning goals. This process is similar to existing methods for LLM reasoning tree search (), where instead of a series of reasoning steps being traversed using self-evaluated LLM scoring, the set of possible programs are being traversed (via `EDIT` and `REPLACE` commands) and the resulting program outcome is self-evaluated to determine if a program is worth building on. This is similar to the Solution Space Search of AIDE (), however their method was specifically designed for the Kaggle competitions and is simply extracting the accuracy rather than scoring the research code and outcomes.

4.  **Self Reflection.** Whether the code succeeds or fails, a self-reflection is produced based on the experimental results or the encountered error signal (). Here, the `mle-solver` is prompted to reflect on the outcome of its actions. If the program failed to compile, the solver reflects on how to fix this issue in next iterations. If it successfuly compiles and returns a score, the solver will reflect on how to increase this score. These reflections are generated to improve future performance, ensuring that the system learns from errors, improving the quality and robustness of the generated code over iterative cycles.

5.  **Performance Stabilization** To prevent performance drift, two mechanisms are implemented: top program sampling and batch-parallelization. In top program sampling, a collection of the highest-scoring programs is maintained, and one program is randomly sampled before executing a command, ensuring diversity while retaining quality. For batch-parallelization, each solver step involves making N modifications simultaneously, with the top modification selected to replace the lowest-scoring program in the top collection. These strategies use high-entropy sampling to modify the code, resulting in a balance between exploration of new solutions and refinement of existing ones in order to maintain stable code modifications.

#### Results Interpretation.

The goal of the results interpretation phase is to derive meaningful insights from experimental outcomes to inform the final report. The PhD and Postdoc agents discuss their understanding of the experimental results produced by `mle-solver`. Once they agree on a meaningful interpretation that could contribute to a compelling academic paper, the Postdoc agent submits it using the `interpretation` command, forming the basis for the report writing phase.

## Report Writing

#### Report Writing.

In the report writing phase, the PhD and Professor agent synthesize the research findings into a comprehensive academic report. This process is facilitated by a specialized module called `paper-solver`, which iteratively generates and refines the report. The `paper-solver` aims to act as a report generator, positioning the work that has been produced by previous stages of `Agent Laboratory`. `paper-solver` does not aim to entirely replace the academic paper-writing process, but rather to summarize the research that has been produced in a human-readable format so that the researcher *using* `Agent Laboratory` understands what has been accomplished. The output follows the standard structure of an academic paper, ensuring it meets conference submission requirements (for the paper scoring phase) while being clear and methodical. The following processes describe the workflow of `paper-solver`:

<figure id="fig:PaperSolver">
<span class="image placeholder" data-original-image-src="images/jpgs/paper_workflow.jpg" data-original-image-title="" width="0.99\linewidth"></span>
<figcaption>Graphical outline of <code>paper-solver</code>. This diagram showcases the step-by-step process of generating and refining academic research reports using the Paper-Solver tool. The workflow starts with the creation of an initial report scaffold (A) by iteratively generating LaTeX-based sections, followed by updates to ensure structural completeness. (B) Research is performed through an Arxiv tool during relevant sections. In the Report Editing phase (C), the language model applies targeted edits to improve the document, with LaTeX compilation verifying the integrity of changes. Finally, the completed report undergoes a reward-based evaluation during the Paper Review phase (D), ensuring alignment with academic standards and research goals.</figcaption>
</figure>

1.  **Initial Report Scaffold.** The first task of the `paper-solver` is to generate an initial scaffold for the research paper. This scaffold outlines the document structure, dividing it into eight standardized sections: Abstract, Introduction, Background, Related Work, Methods, Experimental Setup, Results, and Discussion. During scaffold creation, placeholders are inserted for each section to categorize future content. This process establishes the framework for subsequent detailed text generation. The scaffold includes necessary formatting for LaTeX compilation, allowing the generated paper to be directly reviewed and refined. Special care is taken to ensure the scaffold aligns with academic conventions, such as appropriate section titles and placeholders that guide content development.

2.  **Arxiv Research.** During the scaffold building phase, we allow the `paper-solver` access to arXiv which is accessible through the same interface as the earlier literature review phase. ArXiv is enabled to allow the solver to explore related literature on the subject it is writing on as well as finding papers to refer to, although it is not enforced. We note that the agent still has access to the original literature search, but has the opportunity to expand based on literature needed to write a particular paper section.

3.  **Report Editing.** One the scaffold is built, the `paper-solver` uses specialized commands to iteratively refine the generated paper. The primary command are available for this stage is the `EDIT` command, which allows precise line-by-line modifications to the LaTeX code. This command enable dynamic adjustments to the content, ensuring alignment with the research plan, the clarity of arguments, and compliance with formatting standards. Before integrating edits, the system compiles the LaTeX to verify error-free functionality, thereby maintaining document integrity. Through iterative editing, the solver ensures the paper achieves the desired level of quality, cohesiveness, and depth required for academic acceptance.

4.  **Paper Review.** For obtaining scores for papers during the `paper-solver` iterations, we leverage an adapted version of the automated review system developed in . This system works by using an LLM-based agent to simulate the scientific paper review process following the NeurIPS conference guidelines. When evaluated on 500 ICLR 2022 papers from the OpenReview dataset, the automated reviewer achieved human-level accuracy (65% compared to 66% for human reviewers) and surpassed human performance in F1 score (0.57 vs. 0.49) after calibration. An example review from one of our papers by o1-mini is provided below.

#### Paper Refinement.

In the paper refinement phase, the PhD agent makes a decision on whether to make paper revisions or to determine that the paper is complete. The process begins with a set of three reviewer agents generating reviews that mimic feedback from NeurIPS peer reviewers, evaluating the report based on criteria such as originality, quality, clarity, and significance. Based on these scores, the PhD agent then decides whether to finalize the project or revisit earlier subtasks—such as planning, experimentation, or results interpretation—to address the feedback. This allows the agents to refine the research report until it meets sufficiently high standards, effectively simulating the real-world academic revision process.

### Autonomous versus Co-Pilot Mode:

There are two ways in which `Agent Laboratory` can be operated: autonomous and co-pilot modes. In autonomous mode, there is no human involvement other than providing the initial research idea for agents to produce research for. Each subtask moves on to the next subtask sequentially upon completion. In co-pilot mode, in addition to providing the research idea, there is also a checkpoint at the end of each subtask, where a human is involved in reviewing the work produced by agents in that phase (e.g., the literature review summary or generated report). The human reviewer can either decide to proceed to the next subtask, or ask the agent to repeat the subtask while providing high level notes for the agent to improve its performance during the next attempt. For example, if the literature review phase did not include a specific paper or the experiments did not include a desired technique, the human reviewer would instruct the agent to include this.

# Results

In this section, we present our main findings on the efficacy of `Agent Laboratory` to produce research. We begin our results by asking how human evaluators perceive papers generated by `Agent Laboratory` running in end-to-end autonomous mode across five topics. Next, we examine human evaluation when using `Agent Laboratory` in collaborative co-pilot mode from both allowing the researcher to choose any topic they want and from our set of preselected topics. We then provide a detailed runtime analysis including cost, average time, and success rate by various models. Finally, we conclude with an evaluation of the `mle-solver` in isolation on MLE-Bench, a set of real-world Kaggle challenges. The details of all surveys are provided in Appendix .

## Evaluation of quality by language model

<figure id="fig:PaperScores">
<span class="image placeholder" data-original-image-src="images/pngs/papers.png" data-original-image-title="" width="0.99\linewidth"></span>
<figcaption>The average human evaluated scores of papers generated by <code>Agent Laboratory</code> in an autonomous mode based on a research question (left column) and LLM backend (top row). The bottom row shows the average score across all topics by LLM backend.</figcaption>
</figure>

Our first experiment aims to evaluate how human-evaluated quality varies across three axes: experiment quality, report quality, and usefulness. This evaluation was conducted by human participants using three different LLM backends: gpt-4o (), o1-mini, and o1-preview (). Research questions were selected from a set of 5 templates:

1.  Do language models exhibit cognitive biases, such as confirmation bias or anchoring bias?

2.  Are image transformers more or less sensitive to pixel noise than convolutional networks?

3.  Do language models improve accuracy on MedQA when asked to perform differential diagnosis?

4.  Are language models sensitive to word order in multiple choice benchmarks?

5.  Does gender role play affect the accuracy on of language models on answering math questions?

These 5 questions across 3 LLM backends resulted in a total of 15 papers being written autonomously by `Agent Laboratory` without any human involvement. We then recruited 10 volunteer PhD students to review 3 randomly assigned papers each. These researchers rated the experimental quality, report quality, and usefulness of the generated outputs on a scale of 1 to 5. The goal of this evaluation is to understand the differences in quality of produced research based on the three distinct LLM backbones, and to understand the usefulness of `Agent Laboratory` in autonomous mode. The details of the evaluation questions are provided here:

- **Experimental Quality:** What is your perception of the quality of the experimental results presented in this report?

- **Report Quality:** What is your perception of the quality of the research report writing quality presented in this report?

- **Usefulness:** What is your perception of the usefulness of an AI assistant tool that can generate the presented report autonomously?

The results of this evaluation indicate variability in performance across different `Agent Laboratory` LLM backends (Figure ). gpt-4o consistently achieved lower scores, with an average experimental quality rating of 2.6/5, a report quality rating of 3.0/5, and a usefulness rating of 4.0/5. In contrast, o1-mini generally outperformed gpt-4o in experimental quality, with an average score of 3.2/5 (<span style="color: ForestGreen">+0.6</span>), while maintaining similar levels of report quality and usefulness at 3.2/5 (<span style="color: ForestGreen">+0.2</span>) and 4.3/5 (<span style="color: ForestGreen">+0.3</span>), respectively. o1-preview demonstrated the highest usefulness and report quality, averaging 4.4/5 (<span style="color: ForestGreen">+0.4</span> from gpt-4o and <span style="color: ForestGreen">+0.1</span> from o1-mini) and 3.4/5 (<span style="color: ForestGreen">+0.4</span> from gpt-4o and <span style="color: ForestGreen">+0.2</span> from o1-mini) respectively, though its experimental ratings were slightly lower than o1-mini at 2.9/5 (<span style="color: ForestGreen">+0.3</span> from gpt-4o and <span style="color: Magenta">-0.3</span> from o1-mini). While all backends perform comparably in terms of report and experimental quality, the o1-preview model was as the most useful for research assistance, suggesting that its outputs were better aligned with the expectations and needs of researchers.

From our results, the quality is demonstrated to vary based on the selected topic. We find that the overall highest average report quality to be 3.8/5 and usefulness to be 4.5/5 for the *word order* topic and the highest average experiment quality to be 3.2/5 for the *cognitive bias* topic. Interestingly, we also find that *word order* has the lowest experiment quality at 2.7/5 along with the *image noise* topic. The *image noise* topic was demonstrated to have high variance based on the LLM backend, with an experiment quality score of 1.5/5 for gpt-4o and a 4.0/5 with o1-mini (<span style="color: ForestGreen">+2.5</span> point difference) and a usefulness score of 2.5/5 for gpt-4o and a 4.5/5 with o1-mini (<span style="color: ForestGreen">+2.0</span> point difference).

In summary, the evaluation of quality across LLM backends demonstrates clear differences in experimental quality, report quality, and usefulness. While o1-preview is consistently rated as the most useful for research assistance, o1-mini achieves the highest experimental quality scores, and gpt-4o is generally being outperformed in all areas. Topic-specific trends suggest there may exist variability in the performance of `Agent Laboratory` across difference areas of machine learning research and across backend models.

### Human reviewer scores by language model

In addition to evaluating paper quality, we also asked human reviewers to assess papers generated by `Agent Laboratory` according to NeurIPS-style criteria, including quality, significance, clarity, soundness, presentation, and contribution as shown in Figure . We evaluated the same papers analyzed in Section using the aforementioned metrics and conducted the comparison. We found that the average human scores for the three backends revealed differences in performance, with average overall ratings ranging from 3.5/10 with gpt-4o, 3.8/10 with o1-mini, and 4.0/10 with o1-preview.

First, when evaluating quality we find that reviewers rated gpt-4o the lowest at 1.8/4, while o1-mini achieved the highest score of 2.3/4, demonstrating relatively better technical soundness. In terms of significance, all three backends received similar scores between 2.2–2.5/4, indicating a modest contribution to advancing research goals. Clarity scores showed slight variability, with gpt-4o receiving 2.6/4 and o1-mini falling slightly lower at 2.1/4 (<span style="color: Magenta">-0.5</span>), reflecting differences in how well the papers were written. The soundness of the generated outputs, which assesses the robustness of claims, was rated highest for o1-preview at 2.2/4, with o1-mini and gpt-4o at 1.8 (<span style="color: Magenta">-0.4</span>) and 1.7. Presentation and contribution ratings followed similar trends, with the overall contribution score averaging 2.1/4 across models, highlighting a need for improvement in the originality of the outputs.

These scores show a general trend where human reviewers identified o1-preview as producing slightly better-rounded outputs compared to other backends, though significant gaps remain in technical and methodological aspects across all models. We note that the average score of an accepted paper at NeurIPS is 5.9. In this regard, on average, papers produced in autonomous mode are below the acceptance threshold for top ML conferences. These results demonstrate that, in autonomous mode, there is a need for refinement of `Agent Laboratory` to meet human expectations for high-quality, impactful research papers.

<figure id="fig:humanscores">
<span class="image placeholder" data-original-image-src="images/pngs/scores.png" data-original-image-title="" width="0.99\linewidth"></span>
<figcaption>Scores from NeurIPs-style evaluation of generated papers, including the criterion: quality, significance, clarity, soundness, presentation, and contribution. (top) Split-violin plot comparing the overall score distribution of automated reviewers (LLM scores, left half of violin) and human reviewers (right half of violin). Human scores are not predictive of automated reviewer scores, demonstrating an average of <span style="color: Magenta">-2.3</span> points lower. (middle) Automated reviewer scores across NeurIPs-style criterion. (bottom) Human reviewer scores across NeurIPs-style criterion.</figcaption>
</figure>

#### Automated Reviews versus Human Reviews.

We also explore to what extent the automated reviewer scores align with those of human reviewers. The alignment is graphically illustrated using both tabular data (for all scores) and violin plots (for overall scores) in Figure . Our findings suggest that automated reviewers demonstrate notable discrepancies across all metrics compared with human evaluators, with a tendency to highly over-estimate the contribution of self-evaluated work. While the automated reviewers gave an average overall above average NeurIPS paper score of 6.1/10, human reviewers provided a much lower average of 3.8/10 (<span style="color: Magenta">-2.3</span> points). Similar gaps are observed for all specific criteria, such as clarity and contribution, where automated reviewers rated clarity at 3.6/4 on average compared to 2.4/4 by human evaluators. This pattern holds for all criterion. Previous work demonstrates high alignment with automated reviewers () and ICLR scores from OpenReview. However, with actual humans rating the generated papers, we find that automated reviews do not align closely with human reviews and are far from an average accepted paper at NeurIPS 2024, which stands at 5.85[^1] (our scores were <span style="color: Magenta">-2.05</span> points lower on average). Our results demonstrate that it is important for human evaluations to be provided alongside automated reviewer scores in future works in order to obtain a better understanding of the quality of generated papers.

## Evaluation of co-pilot quality

We next evaluate the use of `Agent Laboratory` in co-pilot mode, where a human researcher is providing feedback at the end of each subtask (see Section for more details). We evaluate performance across two measures: (1) the quality of `Agent Laboratory` as a tool for assisting their research and (2) the quality of generated papers. We first ask researchers to co-pilot `Agent Laboratory` on a topic of their choice without limitations. We then ask researchers to select a topic from the 5 topics introduced in Section , resulting in a total of 2 papers per researcher which we refer to as **custom** and **preselected** papers respectively. After their papers are generated, we ask researchers to rate their experience using `Agent Laboratory` during the process of generating custom and preselected papers. We then ask them to self-evaluate the generated papers according to NeurIPS-style criterion. Finally, we ask external researchers to evaluate their paper comparing performance with `Agent Laboratory` in autonomous mode. All experiments used an o1-mini backbone for all phases except the literature review.

### Quality as a tool

The evaluation of `Agent Laboratory` as a research tool focuses on understanding its effectiveness in assisting researchers during the co-pilot mode. After generating their papers, participants were asked to reflect on their experiences and assess the tool’s utility, usability, and overall satisfaction. We begin our evaluation by asking the following questions:

- **Utility:** How useful is `Agent Laboratory` for assisting your research?

- **Continuation:** How likely are you to continue using Agent Laboratory for research?

- **Satisfaction:** How much did you enjoy using Agent Laboratory?

- **Usability:** How easy was it for you to build a project using Agent Laboratory?

The result of answering each question is a score from 1-5, where 1 indicates the lowest agreement and 5 indicates the highest. We find that the overall scores across all experiments are 3.5/5 for utility, 3.75/5 for continuation, 3.63/5 for satisfaction, and 4.0/5 for usability (Figure ). We also delineate average scores based on custom and preselected topics. For custom experiments, we find overall scores of 3.75/5 for utility, 4.0/5 for continuation, 3.75/5 for satisfaction, and 3.75/5 for usability. For preselected topics, we find overall scores of 3.25/5 for utility, 3.5/5 for continuation, 3.5/5 for satisfaction, and 4.25 for usability. Ratings for preselected topics are lower across all measures compared with custom, except for usability which was <span style="color: Magenta">-0.5</span> points lower. From preselected to custom, utility and continuation increased by <span style="color: ForestGreen">+0.5</span> points and satisfaction increased by <span style="color: ForestGreen">+0.25</span> points.

We also evaluated across the same questions reported in Section . We report an average experimental quality rating of 2.38/5, a report quality rating of 3.13/5, and a usefulness rating of 3.75/5. We find higher scores for custom topics across report quality with a rating of 3.5/5 (<span style="color: ForestGreen">+0.75</span>) and a usefulness rating of 4.0/5 (<span style="color: ForestGreen">+0.5</span>). For experiment quality, we find that preselected has <span style="color: ForestGreen">+0.25</span> points higher with a score of 2.5/5. Scores across all metrics rated lower when compared with the corresponding o1-mini autonomous evaluation results. While report quality was only rated <span style="color: Magenta">-0.07</span> points lower, usefulness was rated <span style="color: Magenta">-0.55</span> points lower and experiment quality was <span style="color: Magenta">-0.82</span> points lower.

Finally, we opened an optional question for participants to provide feedback, which asks the following question: "How could `Agent Laboratory` be improved for your research?" For both custom and preselected topics we received a 75% response rate. From this feedback, there were suggestions for improving the `Agent Laboratory` interface (e.g., adding a GUI, better inspection of intermediate results), adding the option to incorporate more figures for the paper, and improving the literature review phase. We find that when compared to reviews of `Agent Laboratory` in autonomous mode from Section , human co-pilots rated report quality, usefulness, and experiment quality lower. From feedback provided by researchers, we find the reduction in scores is due to difficulty guiding the agents to execute their exact vision for the project. We discuss these limitations in greater detail in Section .

<figure id="fig:copilot_fig">
<span class="image placeholder" data-original-image-src="images/pngs/copilot_evals.png" data-original-image-title="" width="0.99\linewidth"></span>
<figcaption>Co-pilot evaluation.</figcaption>
</figure>

### Evaluation of co-pilot generated papers

To assess the quality of papers generated by `Agent Laboratory` in co-pilot mode, we conduct evaluations using two approaches: (1) researchers self-assessed their generated papers based on NeurIPS-style criteria, and (2) external researchers provided evaluations of the same papers. This section aims to understand differences in scores from self-assessment and external assessment, as well as how assessments compare to `Agent Laboratory` in fully autonomous mode. We use the same NeurIPS criterion introduced in Section .

#### Self-evaluation.

From the results of the self-evaluation (Figure ), we found that the average overall score *increased* from evaluations provided to papers generated in autonomous mode, with autonomous papers having an overall average of 3.8/10 and co-pilot papers at 4.13/10 (<span style="color: ForestGreen">+0.33</span>). These scores even improved across the best autonomous backend, o1-preview, which averaged 4.0/10. Across individual criterion, scores increased for quality (<span style="color: ForestGreen">+0.13</span>), clarity (<span style="color: ForestGreen">+0.48</span>), soundness (<span style="color: ForestGreen">+0.35</span>), and presentation (<span style="color: ForestGreen">+0.33</span>), but decreased for significance and contribution. The scores that decreased were significance (<span style="color: Magenta">-0.3</span>) and contribution (<span style="color: Magenta">-0.1</span>).

#### External evaluation.

We compare scores provided through self-evaluation with those provided by a set of external evaluators on the same papers (Figure ). We find that average scores across most criteria, including quality, significance, clarity, soundness, presentation, and contribution, show an improvement in the external assessments, with an overall average of 4.38/10, up from 4.13/10 in self-evaluations. The most significant improvements were observed in quality (<span style="color: ForestGreen">+0.62</span>), significance (<span style="color: ForestGreen">+0.25</span>), and overall (<span style="color: ForestGreen">+0.25</span>) scores, suggesting that external reviewers perceived the generated papers to be higher quality and more significant than the researchers who produced them. However, clarity scores decreased (<span style="color: Magenta">-0.25</span>), indicating potential issues in the articulation of ideas that might have been overlooked during self-assessment. While presentation scores did not improve (<span style="color: Gray">+0.0</span>), soundness (<span style="color: ForestGreen">+0.13</span>) and contribution (<span style="color: ForestGreen">+0.13</span>) only increased slightly.

Notably, the external evaluations also reinforce differences between scores preselected and custom topics. Unlike with the self-evaluated papers, papers on preselected topics were rated slightly higher overall, with improvements observed across several metrics, particularly in quality (<span style="color: ForestGreen">+0.5</span>) and significance (<span style="color: ForestGreen">+0.5</span>). These findings suggest that self-evaluated reviewers perceive the work produced on their custom topic as higher quality compared to the work produced on preselected topics, whereas external evaluators find the opposite to be true.

#### Comparison with autonomous mode

Comparing scores by external evaluators on autonomous and co-pilot papers (Figure ), we find that the largest improvements were seen for quality, which increased by <span style="color: ForestGreen">+0.75</span>, soundness, which improved by <span style="color: ForestGreen">+0.48</span>, and the overall score, which improved by <span style="color: ForestGreen">+0.58</span>. Moderate gains were also observed in clarity (<span style="color: ForestGreen">+0.23</span>) and presentation (<span style="color: ForestGreen">+0.33</span>). In contrast, some metrics showed minimal or no improvement. Significance declined slightly (<span style="color: Magenta">-0.05</span>), and contribution increased only marginally (<span style="color: ForestGreen">+0.03</span>). Our results suggest that papers generated with human involvement overall are evaluated more highly than autonomously generated paper, with much of the focus of human involvement going toward making the paper more presentable (presentation and clarity) while there was less emphasis on improving experimental results (significance and contribution). Finally, we note that co-pilot overall scores, which average at 4.38, are still <span style="color: Magenta">-1.45</span> points below the average score of 5.85 for an accepted paper at NeurIPS 2024. Increasing the overall score to match conference standards will likely result by improving the contribution and significance of the paper results, which is consistently lower than other evaluation metrics.

## Runtime statistics

Runtime statistics for `Agent Laboratory` are detailed to provide insight into the computational efficiency and monetary costs associated with different phases of its workflow. In this evaluation, both the time required per phase (measured in seconds) and the costs incurred (calculated in USD) were analyzed to better understand the performance of three model backends: gpt-4o, o1-mini, and o1-preview. These measurements were recorded for each subtask, including Literature Review, Plan Formulation, Data Preparation, Running Experiments, Results Interpretation, Report Writing, and Report Refinement.

#### Inference time

Across all models, gpt-4o exhibited the fastest execution times, completing the entire workflow in 1165.4 seconds, approximately 3.2x faster than o1-mini and 5.3x faster than o1-preview, which required 3616.8 seconds and 6201.3 seconds, respectively. In most subtasks, gpt-4o demonstrated superior speed, particularly in Running Experiments and Report Writing phases, where its times were significantly shorter than those of o1-mini and o1-preview. For instance, in Running Experiments, gpt-4o averaged 417.8 seconds, while o1-mini and o1-preview took 2082.5 seconds and 4036.2 seconds, respectively. Similarly, for Report Writing, gpt-4o completed the task in 572.5 seconds, compared to 827.7 seconds for o1-mini and 1854.2 seconds for o1-preview.

#### Inference cost

Monetary costs per workflow were also substantially lower for gpt-4o, which averaged just \$2.33 for the entire process. This is significantly more cost effective than previous autonomous research workflows (), which cost around $\sim$\$15 (6.4x more expensive) to complete using gpt-4o. Other models in our workflow has a lower cost efficiency, such as o1-mini at \$7.51, and o1-preview at \$13.10, the latter being over 5.6x more expensive than gpt-4o. Among the individual subtasks, gpt-4o consistently had the lowest costs. For example, its costs for Data Preparation and Report Writing were \$0.09 and \$1.73, respectively, compared to \$3.03 and \$2.58 for o1-mini, and \$0.30 and \$9.58 for o1-preview.

<figure id="fig:stats">
<span class="image placeholder" data-original-image-src="images/pngs/stats.png" data-original-image-title="" width="0.99\linewidth"></span>
<figcaption>Performance and Cost Evaluation. This table summarizes the runtime statistics, cost, and success rates of Agent Laboratory across its workflow phases using three different model backends: gpt-4o, o1-mini, and o1-preview. The metrics include average cost per phase (in USD), average time per phase (in seconds), and success rates for each phase.</figcaption>
</figure>

#### Phase-level Observations

From our observations at the phase-level, Literature Review was notably efficient for all models in terms of time and cost, with gpt-4o completing it in 92.9 seconds at a cost of \$0.12. Meanwhile, o1-mini completed this phase faster (56.8 seconds) but at a slightly higher cost (\$0.16). For Plan Formulation, gpt-4o was both the fastest (23.3 seconds) and the cheapest (\$0.03), followed closely by o1-preview in cost (\$0.04) but not in speed (33.1 seconds). The most expensive phase across models was Report Writing, where costs were driven by the increased computational resources required for writing a long document. o1-preview incurred particularly high costs in this phase (\$9.58) despite producing comparable outputs in terms of task success rates.

#### Success Rates

Overall, every model exhibits reasonably high reliability, with o1-preview achieving the highest average subtask success rate (95.7%) for the entire workflow. Both gpt-4o and o1-mini followed closely at 94.3% and 92.8%. While most tasks had 100% success rate for each model, the literature review phase had a high rate of failure, at 60%, 70%, and 80% for gpt-4o, o1-mini, and o1-preview respectively. The Data Preparation phase showed minor challenges, with o1-mini recording an 80% success rate in Data Preparation, compared to gpt-4o’s 100% success rate and o1-preview at a 90% success rate.

## Evaluating mle-solver on MLE-Bench

<figure id="fig:mle-bench-eval">
<span class="image placeholder" data-original-image-src="images/pngs/mlebench_graph.png" data-original-image-title="" width="0.99\linewidth"></span>
<figcaption>Average score of four methods (MLAB, OpenHands, AIDE, and mle-solver) on a subset of MLE-Bench.</figcaption>
</figure>

Evaluating the entire `Agent Laboratory` workflow does not contain much information about the ability of `mle-solver` specifically to solve individual ML problems. In order to evaluate `mle-solver` more objectively, we use a subset of 10 ML challenges from MLE-Bench (). MLE-Bench is a benchmark designed to assess the capability of agents in handling real-world ML tasks on Kaggle competitions. This benchmark compares agent performances with human baselines, scoring agents with Kaggle’s medal system, and incorporating mechanisms to mitigate contamination and plagiarism risks. We include all challenges focusing on text and tabular data from the low complexity category of MLE-Bench. We provide as input to `mle-solver` the following: Kaggle dataset description, distilled knowledge from Kaggle notebooks, as well as an accessible train and dev set. Instead of using an LLM scoring function, the `mle-solver` score is evaluated on the dev set, which is a 20% random sample taken from the original training set, and the training set is represented by the other 80% split. All data (dev, test, train) is placed into arrays using the numpy library instead of providing file locations in order to better emulate the data preparation phase. Once all `mle-solver` steps have concluded, the final code with the highest score is evaluated on the actual Kaggle test set and a benchmark score is recorded.

We compare average scores across several runs from three other methods: MLAB (, gpt-4o backend), OpenHands (, gpt-4o backend), and AIDE (, o1-preview backend). While `mle-solver` submitted valid solutions for all MLE-Bench challenges within two hours, prior methods often failed to submit, complicating scoring. We thus calculated average scores by excluding invalid submissions from other works and averaging valid ones. We find that `Agent Laboratory`’s `mle-solver` is more consistently high scoring than other solvers, with `mle-solver` obtaining four medals (two gold, one silver, and one bronze) compared with OpenHands (gpt-4o) obtaining two medals (two gold), AIDE (o1-preview) obtaining two medals (one gold, one bronze) and MLAB obtaining zero medals. Additionally, `mle-solver` obtained above median human performance on six out of ten benchmarks, with AIDE obtaining five out of ten, OpenHands two out of ten, and MLAB zero out of ten. A detailed overview is provided in Figure .

# Limitations

While our results suggest that `Agent Laboratory` demonstrates strong performance as a research tool, we now turn to a discussion of limitations that could inform future work. While some of these are also limitations of LLMs themselves, others are not, and we nonetheless provide a thorough and critical discussion of our work. We hope that progress in autonomous research will address these limitations.

## Workflow limitations

#### Challenges with self-evaluation

The `paper-solver` is being evaluated for quality by using LLMs emulated NeurIPS reviewers. This has two limitations: (1) while the reviewing agents were shown to have high alignment with real reviewers (), *qualitatively* research reports from `Agent Laboratory` are less satisfying than research papers from The AI Scientist (), with ours having lower quality figures, despite `Agent Laboratory` papers obtaining higher scores overall. (2) The research reports produced by `Agent Laboratory` are not meant to replace the paper writing process done by humans as it was in The AI Scientist, rather it is meant to provide a report for the human to understand what has been accomplished, so that they can scale up the experiment and write their own research report. However, we nonetheless use NeurIPS reviewer scores as the heuristic for the quality of our presented `paper-solver`, which aims to evaluate the reports from the perspective of a complete research paper. Additionally, contrasting with demonstrate that LLMs perform less reliably for self-evaluation compared with human reviewers, with lower agreement scores (53.3% vs. 56.1%). Although LLMs demonstrate reasonable consistency, this may stem from reliance on superficial patterns rather than robust evaluation criteria, resulting in discrepancies between LLM and human rankings. This limits LLMs in subjective tasks like research idea evaluation, which is the foundation of `mle-solver` and `paper-solver`.

#### Challenges with automated structure

There are also some limitations that present themselves due to the structure enforced in the workflow. For example, `paper-solver` is encouraged to a organize the paper into a relatively fixed structure (abstract, introduction, etc), which disallows unique paper organizations and section orders. Another limitation is that `mle-solver` and `paper-solver` are limited to generating only two figures for the paper. This can be solved in future work, by allowing all of the figures generated by the `mle-solver` (without restriction) to be incorporated into `paper-solver` by detecting image files and providing those paths to the solver. `Agent Laboratory` is also not able to manage repository-level code on its own, but rather the appropriate files are provided to it at each necessary step and files are saved based on which phase produced the file. Enabling flexible repository-level file modification and execution is a clear next step for future work.

#### Challenges with hallucination

While uncommon, we also found that in some of the research papers, particularly from lower performing models, such as gpt-4o, there were hallucinations regarding experimental results that did not occur, such as the following example from a gpt-4o paper on the topic of *Are image transformers more or less sensitive to noise than convolutional networks?*: “*Hyperparameter optimization played a crucial role in achieving these results. The learning rate was set at $0.001$, with a batch size of $32$, and the number of reasoning steps $L = \{l_1, l_2, . . . , l_n\}$ varied between $5$ to $10$, depending on the complexity of the query. The model was trained over $50$ epochs, with early stopping criteria applied to prevent overfitting.*" While the issue of hallucination is more generally a problem with LLMs themselves, future work must appropriately address these challenges in order to prevent misinformation from being propagated when using automated research tools.

## Common failure modes

In addition to the limitations outlined in Section , we also outline common failure modes observed during the runtime of `Agent Laboratory`. We report a list of the most common failure modes observed below:

- Many of the more capable models (gpt-4o, o1-mini, o1-preview) struggled with instruction-following during the literature review phase, and had a tendency to repeatedly use the `summarize` command until the maximum phase steps have been reached, leading to a termination.

- Retrieved papers during the literature review phase had been observed to reach the maximum token limit for some models.

- When generating figures for the paper using `mle-solver`, the figure legends, titles, or often

- Experiments run by `mle-solver` sometimes obtain $0\%$ accuracy for all tested methods which is not corrected by the agent by the time `mle-solver` runs out of solving steps.

- `mle-solver` has a tendency to edit line $0$ more than other lines in the code, causing to the `replace` command to more often lead to successful code compiles.

- Printed output from the data preparation or experimental results can lead to the LLMs reaching their token limit.

- `mle-solver` often generated the python `exit()` command, which terminated the entire process. This had to be detected and removed manually.

- `mle-solver` has been observed to run system commands on the host computer using the `subprocess.run()` command. While nothing problematic has been observed, safeguards should be implemented around this.

- `paper-solver` often struggles to search for relevant papers using the arXiv engine. Before a search time-limit was enforced, it could take up to $100$ tries for a successful search query to return *any* papers. A limit of $5$ was place thereafter to prevent this cycle.

## Ethical considerations

`Agent Laboratory` offers potential to accelerate the field of machine learning research by automating time-intensive tasks and enabling researchers to focus on ideation and experimental design. However, its capabilities also bring ethical challenges that require careful consideration. The ability to autonomously generate research code, reports, and experiment plans may inadvertently lower the barriers to producing substandard or misleading scientific outputs. This could overwhelm peer review systems and jeopardize the integrity of academic discourse. Furthermore, the automated processes may reflect or even amplify biases inherent in the underlying datasets or algorithms, leading to skewed outcomes in research findings. Transparent disclosure of AI involvement in research outputs is important in order to mitigate such risks and maintain accountability.

There are additional concerns about potential misuse of `Agent Laboratory` for unethical purposes, such as developing harmful technologies or generating content that bypasses ethical oversight. For instance, the misuse of autonomous research agents in fields like cybersecurity could lead to the automated creation of malware () or in environmental studies, it may generate biased analyses that downplay climate risks or overstate the benefits of certain interventions. Moreover, as the platform matures, the risk of its misuse increases if safeguards are not implemented to ensure alignment with ethical research standards (). Thus, while `Agent Laboratory` demonstrates immense promise for accelerating scientific discovery, there is a need for robust governance mechanisms to ensure that the underlying LLMs produce content that aligns with ethical principles and societal values.

# Discussion

In this paper, we introduce `Agent Laboratory`, an open-source LLM agent framework for accelerating the individual’s ability to perform research in machine learning. Unlike fully automated research pipelines that attempt to conceive their own research directions, `Agent Laboratory` is designed as a co-pilot, enabling a more human-centric mode of scientific exploration. Because of this, we present results from human-centered experiments. Our initial evaluations focused on the quality of generated papers in autonomous mode, assessing human evaluations of experimental and report quality, usefulness, as well as reviewer scores based on standard academic criteria across different language models. We also assessed the effectiveness of `Agent Laboratory` in co-pilot mode, comparing its performance with autonomous mode, receiving positive feedback from researchers.

The findings of this work highlight the variability in performance across LLM backends, with the o1-preview model being rated most useful, while o1-mini demonstrated the highest experimental quality. Autonomous mode outputs, although generally well-received, revealed gaps when evaluated against human expectations for high-quality research papers, particularly in terms of clarity and soundness. We also find that automated reviewer scores do not predict human reviewer scores demonstrating the importance of human evaluations inautomated research. ntegrating human feedback in co-pilot mode overall produced higher-quality outputs than autonomous mode, with higher scores across most metrics. The co-pilot feature in `Agent Laboratory` is overall found to have high utility and usability when rated by human users, with most participants deciding to continue usage after their experience. Finally, runtime and cost analyses demonstrated the efficiency of the framework, with the gpt-4o backend offering the fastest execution and lowest costs. Finally, evaluations of the `mle-solver` on MLE-Bench demonstrates improved ability to solve general ML problems over previous methods.

`Agent Laboratory` builds upon an emerging trend in the use of language agents for science, where previous works have shown the potential of LLMs to generate research ideas (), implement machine learning projects (), and even produce scientific papers (). While many of these prior efforts leverage LLMs as tools to be applied at discrete stages, `Agent Laboratory` integrates these processes into a single, continuous pipeline that can scale and adapt to the researcher’s desired level of interaction and compute availability. This allows human researchers to focus more on conceptual design and critical thinking, allowing `Agent Laboratory` to handle more tedious tasks, such as preprocessing data and coding.

We overcome the limitations of prior work, such as The AI Scientist () which does not have human-computer interaction, Virtual Lab () which does not have access to up-to-date knowledge, does not generate research papers, and was only demonstrated for nanobody design, as well as ChemCrow () and Coscientist () which cannot solve open-ended research problems. However, as was outlined in Limitations (Section ), there are many areas for improvement in our approach which can be addressed in future work.

A valuable direction for future research could involve a longitudinal study comparing researchers’ outcomes when conducting studies with and without `Agent Laboratory`, as the human evaluations in this work provide only a snapshot of its utility. Studies of this kind have been conducted with other workflow automation tools, such as GitHub Copilot (), and have demonstrated promising potential for improving productivity. Such a study would help to better understand the long-term impact of `Agent Laboratory` on research efficiency and its role in improving scientific discovery. It may also be worth exploring automatic agent workflow () and agent generation techniques () to optimize the `Agent Laboratory` workflow.

#### Conclusion

In conclusion, `Agent Laboratory` stands as a promising step toward more efficient, human-centered research workflows that leverage the power of LLMs. By integrating specialized autonomous agents guided by human oversight, our approach can help researchers spend less time on repetitive tasks and more time on the creative, conceptual aspects of their work. We hope that `Agent Laboratory` may ultimately serve as a tool to enable scientific discovery.

# `Agent Laboratory` configuration

## Hyperparameters

| **Category**            | **Hyperparameter**            | **Value** |
|:------------------------|:------------------------------|:----------|
| **Literature Review**   | Number of Paper Summaries     | 5         |
|                         | Full Text History Decay Steps | 3         |
|                         | Agent temperature             | 0.8       |
| **Data Preparation**    | Experiment Timeout            | 120s      |
| **Running Experiments** | mle-solver steps              | 3         |
|                         | Code repair attempts          | 2         |
|                         | Maximum top codes             | 2         |
|                         | Error history length          | 5         |
|                         | Code history length           | 2         |
|                         | Number of comparison trials   | 2         |
|                         | Experiment Timeout            | 600s      |
|                         | Score generation temperature  | 0.6       |
|                         | Repair temperature            | 0.8       |
|                         | Initial code temperature      | 1.0       |
|                         | Solver temperature            | 1.0       |
| **Paper Writing**       | paper-solver steps            | 5         |
|                         | Maximum top papers            | 1         |
|                         | Paper history length          | 10        |
|                         | Number of Reviewers           | 1         |
|                         | Number of comparison trials   | 2         |
|                         | Solver temperature            | 1.0       |
|                         | Initial paper temperature     | 0.8       |
| **Paper Refinement**    | Number of Reviewers           | 3         |
|                         |                               |           |

Hyperparameters for <span class="smallcaps">Agent Laboratory</span>.

## Hardware

All experiments in this paper were run on a 2023 MacBook Pro with an Apple M3 Max processor and 36 GB of memory.

# Prompts

## Base Inference Prompt

#### Complete String

The complete string is typically set to the empty string. However, in the case when the number of steps reaches 70% of the way toward completion, the following is appended to the base prompt to encourage the agent to produce a submission.

## Context Prompts

## Agent Phase Descriptions

### PhD Student phase

## Machine Learning Engineer Phase Descriptions

## Postdoc Phase Descriptions

## Agent Command Description

### PhD Student Command Description

### ML Engineer Agent Command Description

### Postdoc Agent Command Description

## Agent Role Description

### PhD Student Role Description

### Machine Learning Engineer Role Description

### Professor Agent

### Postdoc Agent Role Description

## `mle-solver` Prompts

### Tools

Where the string errs is concatenation of the minimum between five previous errors and the length of all errors (i.e. all errors until the number reaches five, then only five).

## `paper-solver` Prompts

Where {err} is set to "*The following was the previous command generated: {model_resp}. This was the error return {cmd_str}. You should make sure not to repeat this error and to solve the presented problem.*" when an error is present and is otherwise empty.

### Per section tips

The following tips are taken and modified from .

### paper-solver Reviewer prompt

The following reviewer system prompt is taken from .

# Survey questions

[^1]: [https://papercopilot.com/statistics/neurips-statistics/neurips-2024-statistics](https://papercopilot.com/statistics/neurips-statistics/neurips-2024-statistics/)
